<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>The MongoDB\Driver\Cursor class</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mongodb-driver-readconcern.getlevel.html">? MongoDB\Driver\ReadConcern::getLevel</a></li>
      <li style="float: right;"><a href="mongodb-driver-cursor.construct.html">MongoDB\Driver\Cursor::__construct ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.mongodb.html">MongoDB\Driver</a></li>
    <li>The MongoDB\Driver\Cursor class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.mongodb-driver-cursor" class="reference">

 <h1 class="title">The MongoDB\Driver\Cursor class</h1>
 

 <div class="partintro"><p class="verinfo">(mongodb &gt;=1.0.0)</p>


  <div class="section" id="mongodb-driver-cursor.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    The <strong class="classname">MongoDB\Driver\Cursor</strong> class encapsulates
    the results of a MongoDB command or query and may be returned by
    <span class="methodname"><a href="mongodb-driver-manager.executecommand.html" class="methodname">MongoDB\Driver\Manager::executeCommand()</a></span> or
    <span class="methodname"><a href="mongodb-driver-manager.executequery.html" class="methodname">MongoDB\Driver\Manager::executeQuery()</a></span>, respectively.
   </p>
   <p class="para">

   </p>
  </div>


  <div class="section" id="mongodb-driver-cursor.synopsis">
   <h2 class="title">类摘要</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="ooclass">
      <strong class="classname">MongoDB\Driver\Cursor</strong>
     </span>
     
     <span class="oointerface">implements 
      <span class="interfacename"><strong class="interfacename">Traversable</strong></span>
     </span>
     {</div>

    
    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">private</span> <span class="methodname"><a href="mongodb-driver-cursor.construct.html" class="methodname">__construct</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">public</span> <span class="type">MongoDB\Driver\CursorId</span> <span class="methodname"><a href="mongodb-driver-cursor.getid.html" class="methodname">getId</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">public</span> <span class="type">MongoDB\Driver\Server</span> <span class="methodname"><a href="mongodb-driver-cursor.getserver.html" class="methodname">getServer</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="mongodb-driver-cursor.isdead.html" class="methodname">isDead</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">public</span> <span class="type">void</span> <span class="methodname"><a href="mongodb-driver-cursor.settypemap.html" class="methodname">setTypeMap</a></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter">$typemap</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">final</span> <span class="modifier">public</span> <span class="type">array</span> <span class="methodname"><a href="mongodb-driver-cursor.toarray.html" class="methodname">toArray</a></span>
    ( <span class="methodparam">void</span>
   )</div>

   }</div>


  </div>

 </div>

 
 






 






 






 






 






 







<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="mongodb-driver-cursor.construct.html">MongoDB\Driver\Cursor::__construct</a> &mdash; Create a new Cursor (not used)</li><li><a href="mongodb-driver-cursor.getid.html">MongoDB\Driver\Cursor::getId</a> &mdash; Returns the ID for this cursor</li><li><a href="mongodb-driver-cursor.getserver.html">MongoDB\Driver\Cursor::getServer</a> &mdash; Returns the server associated with this cursor</li><li><a href="mongodb-driver-cursor.isdead.html">MongoDB\Driver\Cursor::isDead</a> &mdash; Checks if the cursor is still open on the server</li><li><a href="mongodb-driver-cursor.settypemap.html">MongoDB\Driver\Cursor::setTypeMap</a> &mdash; Sets a type map to use for BSON unserialization</li><li><a href="mongodb-driver-cursor.toarray.html">MongoDB\Driver\Cursor::toArray</a> &mdash; Returns an array containing all results for this cursor</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119606""></a>
  <div class="note">
   <strong class="user">tdrpic</strong>
   <a href="#119606" class="date">15-Jul-2016 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you find that it would be easier to use arrays (instead of objects) for the returned documents, add the following after executing your query:<br />
<br />
$cursor-&gt;setTypeMap(['root' =&gt; 'array', 'document' =&gt; 'array', 'array' =&gt; 'array']);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118856""></a>
  <div class="note">
   <strong class="user">mikemartin2016 at gmail dot com</strong>
   <a href="#118856" class="date">18-Feb-2016 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I noticed that&nbsp; -&gt;sort is missing from the cursor.&nbsp; Seems like the old driver has more functionality.
<br />

<br />
[red.: The way how cursors are created is different between the drivers. In the old driver, the cursor would not be created until after the first rewind() call on the iterator.
<br />

<br />
In the new driver the cursor already exists. Because sort (and limit and skip) parameters need to be send to the server, they can not be called after the cursor already has been created.
<br />

<br />
You can use sort (and limit and skip) with the new driver as well, by specifying them as options to the Query as shown in this example: <a href="http://php.net/manual/en/mongodb-driver-query.construct.php#refsect1-mongodb-driver-query.construct-examples]" rel="nofollow" target="_blank">http://php.net/manual/en/mongodb-driver-query.construct.php#refsect1-mongodb-driver-query.construct-examples]</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118824""></a>
  <div class="note">
   <strong class="user">max-p at max-p dot me</strong>
   <a href="#118824" class="date">12-Feb-2016 10:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As one might notice, this class does not implement a hasNext() or next() method as opposed to the now deprecated Mongo driver.<br />
<br />
If, for any reason, you need to pull data from the cursor procedurally or otherwise need to override the behavior of foreach while iterating on the cursor, the SPL \IteratorIterator class can be used. When doing so, it is important to rewind the iterator before using it, otherwise you won't get any data back.<br />
<br />
<span class="default">&lt;?php<br />
$cursor </span><span class="keyword">= </span><span class="default">$collection</span><span class="keyword">-&gt;</span><span class="default">find</span><span class="keyword">();<br />
</span><span class="default">$it </span><span class="keyword">= new \</span><span class="default">IteratorIterator</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">);<br />
</span><span class="default">$it</span><span class="keyword">-&gt;</span><span class="default">rewind</span><span class="keyword">(); </span><span class="comment">// Very important<br />
<br />
</span><span class="keyword">while(</span><span class="default">$doc </span><span class="keyword">= </span><span class="default">$it</span><span class="keyword">-&gt;</span><span class="default">current</span><span class="keyword">()) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$it</span><span class="keyword">-&gt;</span><span class="default">next</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I used this trick to build a backward compatibility wrapper emulating the old Mongo driver in order to upgrade an older codebase.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
