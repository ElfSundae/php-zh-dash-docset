<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="image.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="image.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="image.setup.html">安装／配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="image.installation" class="section">
 <h2 class="title">安装</h2>
 <p class="para">
  要激活 GD 支持，配置 PHP 时加上
  <strong class="option configure">--with-gd[=DIR]</strong>
，DIR 是 GD
  的基本安装目录。要使用推荐的绑定的 GD 库版本（首次绑定于 PHP 4.3.0），使用
  <strong class="option configure">--with-gd</strong>
。要编译
  GD 库，需要<span class="productname">libpng</span> 和 <span class="productname">libjpeg</span>。
 </p>
 <p class="para">
  在 Windows 中，需要将 GD2 的 DLL 文件 <var class="filename">php_gd2.dll</var>
  作为一个扩展包含在 <var class="filename">php.ini</var> 中。GD1 的 DLL 文件
  <var class="filename">php_gd.dll</var> 在 PHP 4.3.2
  中被删除了。此外要注意首选的真彩色图像函数，例如
  <span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>，需要 GD2。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   要在 Windows 下启用 exif，在 <var class="filename">php.ini</var> 中 php_mbstring.dll 必须在
   php_exif.dll 之前加载。
  </p>
 </p></blockquote>
 <p class="para" id="image.configure.php3">
  要在 <em class="emphasis">PHP 3</em> 中禁止 GD 支持，在配置时加上
  <strong class="option configure">--without-gd</strong>
。
 </p>

 <p class="para">
  要增强 GD 的能力以处理更多的图像格式，在配置 PHP 时指定
  <em>--with-XXXX</em> 的配置开关。
  <table class="doctable table">
   <caption><strong>所支持的图像格式</strong></caption>
   
    <thead>
     <tr>
      <th>图像格式</th>
      <th>配置开关</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td><em>jpeg-6b</em></td>
      <td>
       要激活 jpeg-6b 的支持，加上
       <strong class="option configure">--with-jpeg-dir=DIR</strong>
.
      </td>
     </tr>

     <tr>
      <td><em>png</em></td>
      <td>
       要激活 png 的支持，加上
       <strong class="option configure">--with-png-dir=DIR</strong>
。注意，libpng
       需要 <a href="zlib.requirements.html" class="link">zlib library</a>，因此配置中还要加上
       <strong class="option configure">--with-zlib-dir[=DIR]</strong>
。
      </td>
     </tr>

     <tr>
      <td><em>xpm</em></td>
      <td>
       要激活 xpm 的支持，加上
       <strong class="option configure">--with-xpm-dir=DIR</strong>
。如果配置时提示找不到所需要的库，可以加上到
       X11 库的路径。
      </td>
     </tr>

    </tbody>
   
  </table>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    当把 PHP 和 libpng 一起编译时，必须使用和 GD 库连接的同一个版本。
   </span>
  </p></blockquote>
 </p>
 <p class="para">
  要增强 GD 的能力以处理更多的字体，在配置 PHP 时指定
  <em>--with-XXXX</em> 的配置开关。
  <table class="doctable table">
   <caption><strong>所支持的字库</strong></caption>
   
    <thead>
     <tr>
      <th>字库</th>
      <th>配置开关</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td><em>FreeType 1.x</em></td>
      <td>
       要激活 FreeType 1.x 的支持，加上
       <strong class="option configure">--with-ttf[=DIR]</strong>
。
      </td>
     </tr>

     <tr>
      <td><em>FreeType 2</em></td>
      <td>
       要激活 FreeType 2 的支持，加上
       <strong class="option configure">--with-freetype-dir=DIR</strong>
。
      </td>
     </tr>

     <tr>
      <td><em>T1lib</em></td>
      <td>
       要激活 T1lib（Type 1 字体），加上
       <strong class="option configure">--with-t1lib[=DIR]</strong>
。
      </td>
     </tr>

     <tr>
      <td><em>本地 TrueType 字符串函数</em></td>
      <td>
       要激活本地 TrueType 字符串函数的支持，加上
       <strong class="option configure">--enable-gd-native-ttf</strong>
。
      </td>
     </tr>

    </tbody>
   
  </table>

 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119079""></a>
  <div class="note">
   <strong class="user">Mike K</strong>
   <a href="#119079" class="date">30-Mar-2016 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Ubuntu I was missing the libpng-dev, libjpeg-dev (and in my case) libwebp-dev libraries, all gettable with apt-get.<br />
<br />
Also once those libraries are installed, including --with-png-dir --with-jpeg-dir --with-webp-dir, without any values (i.e. =/dir) appeared to be valid ... though admittedly I didn't try without (in case the configure script autodetected them).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118884""></a>
  <div class="note">
   <strong class="user">svestka1999 at gmail dot com</strong>
   <a href="#118884" class="date">23-Feb-2016 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instructions how to compile bundled version on Linux:<br />
<a href="http://stackoverflow.com/questions/35560150/php-gd-bundled-extension-without-recompiling-php-solution" rel="nofollow" target="_blank">http://stackoverflow.com/questions/35560150/php-gd-bundled-extension-without-recompiling-php-solution</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117694""></a>
  <div class="note">
   <strong class="user">amenadiel at gmail dot com</strong>
   <a href="#117694" class="date">24-Jul-2015 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While it is true that you can install GD with apt, that version comes without some of the traits of the internal, compiled version. <br />
<br />
I noticed that when I tried to call method `imageantialias`<br />
<br />
<a href="http://php.net/manual/es/function.imageantialias.php" rel="nofollow" target="_blank">http://php.net/manual/es/function.imageantialias.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116953""></a>
  <div class="note">
   <strong class="user">Patrick</strong>
   <a href="#116953" class="date">26-Mar-2015 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I installes php5-gd by adding<br />
<br />
deb <a href="http://ftp.de.debian.org/debian sid main" rel="nofollow" target="_blank">http://ftp.de.debian.org/debian sid main</a><br />
<br />
in /etc/apt/sources.list<br />
<br />
then<br />
apt-get install php5-gd<br />
<br />
then i have troubles for starting apache2 but google find all troubles ...<br />
<br />
cd /etc/apache2<br />
mkdir conf.d<br />
changes in apache2.conf :<br />
replace<br />
&nbsp; LockFile ${APACHE_LOCK_DIR}/accept.lock<br />
by<br />
&nbsp; Mutex file:${APACHE_LOCK_DIR} default<br />
comment lines&nbsp; NameVirtualHost (with a #)<br />
a2enmod suexec (correction Suexec....)<br />
a2enmod rewrite (correction erreur dav)<br />
a2enmod dav_fs (correction erreur filesystem)<br />
service apache2 start</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116842""></a>
  <div class="note">
   <strong class="user">balazstx</strong>
   <a href="#116842" class="date">09-Mar-2015 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$ sudo yum install php55-gd<br />
<br />
PHP Version 5.5.21<br />
ERVER_SOFTWARE&nbsp; &nbsp;&nbsp; Apache/2.4.10 (Amazon) PHP/5.5.21 <br />
Amazon Linux AMI 2014.09.2 (HVM) - ami-04003319</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115989""></a>
  <div class="note">
   <strong class="user">leyluj21 at gmail dot com</strong>
   <a href="#115989" class="date">23-Oct-2014 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using PHPBREW , the extension is called gd.<br />
So you do.<br />
```<br />
phpbrew ext install gd<br />
```<br />
<br />
It will compile the extension to the core.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115752""></a>
  <div class="note">
   <strong class="user">RB</strong>
   <a href="#115752" class="date">18-Sep-2014 06:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ubuntu 14.04<br />
<br />
apt-get install php5-gd<br />
service apache2 restart<br />
<br />
Fixed my Joomla / Kunena install for my LAMP-server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115676""></a>
  <div class="note">
   <strong class="user">james dot a dot munsch at gmail dot com</strong>
   <a href="#115676" class="date">06-Sep-2014 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
sudo apt-get install php5-gd &amp;&amp; sudo service apache2 restart<br />
<br />
To install under Ubuntu 14.04.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113953""></a>
  <div class="note">
   <strong class="user">PHP Compiler</strong>
   <a href="#113953" class="date">22-Dec-2013 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To all smart-willys who come here to tell us you installed GD with package management: No one cares if you used packages management to install GD. This is for people who compile from source.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112692""></a>
  <div class="note">
   <strong class="user">MIguel G</strong>
   <a href="#112692" class="date">14-Jul-2013 02:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your are suffering with PHP53 on CentOS and GD, <br />
just<br />
yum install php53-gd</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109472""></a>
  <div class="note">
   <strong class="user">alejo dot jm at gmail dot com</strong>
   <a href="#109472" class="date">20-Jul-2012 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Macox lion with mac port just use:<br />
sudo port install php5-gd</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107379""></a>
  <div class="note">
   <strong class="user">Regular Guy</strong>
   <a href="#107379" class="date">05-Feb-2012 01:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CentOS 6<br />
<br />
yum install php-gd<br />
<br />
worked, no need to recompile.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107302""></a>
  <div class="note">
   <strong class="user">drummerpatch at gmail dot com</strong>
   <a href="#107302" class="date">29-Jan-2012 06:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running a Debian Squeeze server, all I had to do to add support for GD to my Apache server was simply run `apt-get install php5-gd` and then restart Apache. No recompiling or reconfiguring or anything. Simple!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105155""></a>
  <div class="note">
   <strong class="user">florian</strong>
   <a href="#105155" class="date">31-Jul-2011 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
People having difficulties setting the --with-libdir option needs to set it like this :<br />
<br />
--with-libdir=lib64<br />
<br />
That option works fine. Doing --with-libdir=/usr/lib64 doesn't work because the configure script prepends the --prefix option before the --with-libdir option. So, doing --with-libdir=/usr/lib64 makes the configure script to look for libs in /usr/usr/lib64, which is wrong of course, and not in /usr/lib64.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104571""></a>
  <div class="note">
   <strong class="user">Joseph Marlin</strong>
   <a href="#104571" class="date">23-Jun-2011 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I also had to install the libgd package in addition to php5-gd:<br />
<br />
sudo apt-get install libgd2-xpm-dev*</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103507""></a>
  <div class="note">
   <strong class="user">octopus at logicaloctopus dot com</strong>
   <a href="#103507" class="date">17-Apr-2011 09:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was running PHP on a SUSE box on amazon EC2.<br />
to get gd to work all I had to do was to run:<br />
&gt; yast -i php5_gd<br />
<br />
and when that completed I just restarted apache. voila!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102971""></a>
  <div class="note">
   <strong class="user">boly38 at gmail dot com</strong>
   <a href="#102971" class="date">17-Mar-2011 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get GD bundled under Ubuntu, the way to recompile php5 with gd is described here (french) <a href="http://doc.ubuntu-fr.org/modules_php#php5-gd" rel="nofollow" target="_blank">http://doc.ubuntu-fr.org/modules_php#php5-gd</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101501""></a>
  <div class="note">
   <strong class="user">lucaferr</strong>
   <a href="#101501" class="date">21-Dec-2010 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Slackware 64bit (I tested 13.1) you need to make symlinks to libpng and libjpeg if you want to compile php with GD, even if you've already installed them, otherwise configure will give you a "libpng not found" error, even if you set --with-libdir=/usr/lib64 (it seems to have no effects at all). So, run these before configuring:<br />
ln -s /usr/lib64/libjpeg.so /usr/lib/libjpeg.so<br />
ln -s /usr/lib64/libpng.so /usr/lib/libpngp.so</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99856""></a>
  <div class="note">
   <strong class="user">elassoto at hotmail dot com</strong>
   <a href="#99856" class="date">10-Sep-2010 10:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have already compiled PHP and want to recompile '--with-gd', don't forget to run 'make clean' first!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95649""></a>
  <div class="note">
   <strong class="user">Larry Kluger</strong>
   <a href="#95649" class="date">13-Jan-2010 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On 64bit centos, needed to create links from lib64 to lib. Php seems to insist on looking in lib, even with "with-jpeg-dir" config.<br />
<br />
Eg<br />
<br />
ln -s /usr/lib64/libjpeg.so.62.0.0&nbsp; /usr/lib/libjpeg.so<br />
ln -s /usr/lib64/libpng.so.3.10.0&nbsp; /usr/lib/libpng.so<br />
<br />
./configure&nbsp; \<br />
&nbsp; --with-config-file-path=/etc \<br />
&nbsp; --prefix=/usr \<br />
&nbsp; --with-bz2 \<br />
&nbsp; --enable-zip \<br />
&nbsp; --enable-mbstring \<br />
&nbsp; --with-apxs2=/usr/sbin/apxs \<br />
&nbsp; --with-zlib-dir=/usr/include \<br />
&nbsp; --with-libxml-dir=/usr/lib64 \<br />
&nbsp; --with-mcrypt=/usr/lib64 \<br />
&nbsp; --with-mysql \<br />
&nbsp; --with-gd \<br />
&nbsp; --with-jpeg-dir=/usr \<br />
&nbsp; --with-png-dir=/usr \<br />
&nbsp; --enable-calendar</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88494""></a>
  <div class="note">
   <strong class="user">ben at bluehype dot com dot au</strong>
   <a href="#88494" class="date">27-Jan-2009 01:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have already compiled php without jpeg support and decide you want it , then before you compile again you might need to run "make clean" first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86699""></a>
  <div class="note">
   <strong class="user">msc at homofaber dot com</strong>
   <a href="#86699" class="date">30-Oct-2008 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that it might be pretty easy to install gd without the need to recompile php, when using debian:
<br />

<br />
apt-get install php5-gd</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85240""></a>
  <div class="note">
   <strong class="user">gerard at charlesconsulting dot com</strong>
   <a href="#85240" class="date">21-Aug-2008 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On my system,I had to ensure I had not only libpng and libjpeg, but also the libpng-devel and libjpeg-devel packages installed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84538""></a>
  <div class="note">
   <strong class="user">kronn</strong>
   <a href="#84538" class="date">17-Jul-2008 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Everytime I try to install the gd-lib as a dynamic extension, I run into the same problem: It wont work.
<br />

<br />
I get the following error:
<br />

<br />
PHP Warning:&nbsp; PHP Startup: Unable to load dynamic library '/usr/pkg/lib/php/20040412/gd.so' - dlopen(/usr/pkg/lib/php/20040412/gd.so, 9): Symbol not found: __cg_jpeg_resync_to_restart\n&nbsp; Referenced from: /System/Library/Frameworks/ApplicationServices. framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO\n&nbsp; Expected in: /usr/pkg/lib/libjpeg.62.dylib\n in Unknown on line 0
<br />

<br />
I use pkgsrc for software package managment on my mac, as may be apparent from the paths.
<br />

<br />
The solution is, to edit the file /usr/pkg/sbin/envvars and remove or comment the DYLD_LIBRARY_PATH because it is causing the error...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82621""></a>
  <div class="note">
   <strong class="user">mike at clove dot com</strong>
   <a href="#82621" class="date">18-Apr-2008 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
jpeg [jpg] file processing doesn't work unless you build php with '--with-jpeg-dir=&lt;path to jpeg library&gt;'.<br />
<br />
It still doesn't work unless &lt;path to jpeg library&gt; points to the directory holding the directory holding the library unless libjpeg.&lt;whatever&gt; is in either /usr/lib or /usr/local/lib. For instance, on a mac with libjpeg.a installed via mac ports, you need '/opt/local' rather than '/opt/local/lib'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
