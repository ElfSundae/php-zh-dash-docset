<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>VARIANT class</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="class.dotnet.html">? DOTNET</a></li>
      <li style="float: right;"><a href="ref.com.html">COM 函数 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.com.html">COM</a></li>
    <li>VARIANT class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.variant" class="reference">
 
 <h1 class="title">VARIANT class</h1>
 <div class="partintro"><p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5)</p>

 <div class="section" id="class.variant.class">
  <h2 class="title">Description</h2>
  <p class="simpara">
   The VARIANT is COM&#039;s equivalent of the PHP zval; it is a structure that
   can contain a value with a range of different possible types.  The VARIANT
   class provided by the COM extension allows you to have more control over
   the way that PHP passes values to and from COM.
  </p>
  <p class="simpara">
   <em>$vVar = new VARIANT($var)</em>
  </p>
 </div>
 <div class="section" id="variant.variant">
  <h2 class="title">Methods</h2>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>VARIANT::VARIANT</strong></span>
    ([ <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$type</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code></span>
  ]]] )</div>

  <p class="para">
   VARIANT class constructor. Parameters:
   <dl>

   <dt>
value</dt>

   <dd>

    <span class="simpara">
     initial value. if omitted, or set to <strong><code>NULL</code></strong> an VT_EMPTY object is created.
    </span>
   </dd>

   
   <dt>
type</dt>

   <dd>

    <span class="simpara">
     specifies the content type of the VARIANT object. Possible values are
     one of the <strong><code>VT_XXX</code></strong> <a href="com.constants.html" class="xref">预定义常量</a>.
    </span>
    <span class="simpara">
     In PHP versions prior to PHP 5, you could force PHP to pass a variant
     object by reference by OR&#039;ing <strong><code>VT_BYREF</code></strong>
     with the <code class="parameter">type</code>.  In PHP 5, this hack is not
     supported; instead, PHP 5 can detect parameters passed by reference
     automatically; they do not even need to be passed as VARIANT objects.
    </span>
    <span class="simpara">
     Consult the <acronym title="Microsoft Developer Network">MSDN</acronym> library for additional information
     on the VARIANT type.
    </span>
   </dd>

   
   <dt>
codepage</dt>

   <dd>

    <span class="simpara">
     specifies the codepage that is used to convert strings to
     unicode.  See the parameter of the same name in the
     <a href="class.com.html" class="xref">COM</a> class for more information.
    </span>
   </dd>

   
   </dl>

  </p>
  <p class="para">
   PHP versions prior to PHP 5 define a number of (undocumented) virtual properties
   for instances of the VARIANT class; these properties have all been removed in
   PHP 5 in favour of its more natural syntax; these differences are best
   highlighted by example:
  </p>
  <p class="para">
   <div class="example" id="com.variant.example.php4">
    <p><strong>Example #1 Variant example, PHP 4.x style</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$v&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">);<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;type&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">type&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;value&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">value&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="com.variant.example.php5">
    <p><strong>Example #2 Variant example, PHP 5 style</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$v&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">);<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;type&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">variant_get_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;value&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   The reason for the change is that, internally, the COM extension sees
   VARIANT, COM and DOTNET classes as the same thing, and the design
   philosophy for these classes is that all property and member accesses are
   passed through to COM with no interference.  The new syntax is more
   natural and less effort, and most of the removed virtual properties didn&#039;t
   make any sense in a PHP context in any case.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    PHP 5 takes a much simpler approach to handling VARIANTs; when returning
    a value or fetching a variant property, the variant is converted to a PHP
    value only when there is a direct mapping between the types that would
    not result in a loss of information.  In all other cases, the result is
    returned as an instance of the VARIANT class.  You can force PHP to
    convert or evaluate the variant as a PHP native type by using a casting
    operator explicitly, or implicitly casting to a string by
    <span class="function"><a href="function.print.html" class="function">print</a></span>ing it.  You may use the wide range of variant
    functions to perform arithmetic operations on variants without forcing a
    conversion or risking a loss of data.
   </p>
  </p></blockquote>
  <p class="para">
   See also <span class="function"><a href="function.variant-get-type.html" class="function">variant_get_type()</a></span>.
  </p>
 </div>

 </div>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="76471""></a>
  <div class="note">
   <strong class="user">darren at dcook dot org</strong>
   <a href="#76471" class="date">17-Jul-2007 02:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are frustrated that print_r($obj) (where $obj is something returned from a call to a function on a COM object) does not return anything helpful, and that variant_get_type($obj) just returns a number, the function you are actually after is:<br />
&nbsp; com_print_typeinfo($obj);<br />
<br />
It lists all functions, variables, their types in a human-readable (well, programmer-readable) format. Lovely!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36980""></a>
  <div class="note">
   <strong class="user">mark dot pearson at capita dot co dot uk</strong>
   <a href="#36980" class="date">29-Oct-2003 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running PHP 4.3.2 on Windows 2000 I had to use the following expression to create an empty Variant:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$empty </span><span class="keyword">= new </span><span class="default">Variant</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">);<br />
&nbsp;print </span><span class="default">$empty</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="comment">//&nbsp; &nbsp;&nbsp; ==&gt;&nbsp;&nbsp; 1<br />
</span><span class="default">?&gt;<br />
</span><br />
NOT<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$empty </span><span class="keyword">= new </span><span class="default">Variant</span><span class="keyword">();<br />
&nbsp;print </span><span class="default">$empty</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="comment">//&nbsp; &nbsp;&nbsp; ==&gt;&nbsp;&nbsp; 0<br />
</span><span class="default">?&gt;<br />
</span><br />
The two expressions return different Variant type values!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29830""></a>
  <div class="note">
   <strong class="user">richard dot quadling at carval dot co dot uk</strong>
   <a href="#29830" class="date">26-Feb-2003 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With thanks to Harald Radi and Wez Furlong.<br />
<br />
Some VBA functions have optional parameters. Sometimes the parameters you want to pass are not consecutive.<br />
<br />
e.g.<br />
<br />
GoTo What:=wdGoToBookmark, Name="BookMarkName"<br />
GoTo(wdGoToBookmark,,,"BookMarkName)<br />
<br />
In PHP, the "blank" parameters need to be empty.<br />
<br />
Which is ...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Some servers may have an auto timeout, so take as long as you want.<br />
</span><span class="default">set_time_limit</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Show all errors, warnings and notices whilst developing.<br />
</span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Used as a placeholder in certain COM functions where no parameter is required.<br />
</span><span class="default">$empty </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">();<br />
<br />
</span><span class="comment">// Load the appropriate type library.<br />
</span><span class="default">com_load_typelib</span><span class="keyword">(</span><span class="string">'Word.Application'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create an object to use.<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'word.application'</span><span class="keyword">) or die(</span><span class="string">'Unable to load Word'</span><span class="keyword">);<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Open a new document with bookmarks of YourName and YourAge.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">'C:/Unfilled.DOC'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Fill in the information from the form.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">GoTo</span><span class="keyword">(</span><span class="default">wdGoToBookmark</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="string">'YourName'</span><span class="keyword">); </span><span class="comment">// Note use of wdGoToBookmark, from the typelibrary and the use of $empty.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">TypeText</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourName'</span><span class="keyword">]);<br />
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">GoTo</span><span class="keyword">(</span><span class="default">wdGoToBookmark</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="string">'YourAge'</span><span class="keyword">);<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">TypeText</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourAge'</span><span class="keyword">]);<br />
<br />
</span><span class="comment">// Save it, close word and finish.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"C:/</span><span class="keyword">{</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourName'</span><span class="keyword">]}</span><span class="string">.doc"</span><span class="keyword">);<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
print </span><span class="string">"Word closed.\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The example document is ...<br />
<br />
Hello [Bookmark of YourName], you are [Bookmark of YourAge] years old.<br />
<br />
and it would be called ...<br />
<br />
word.php?YourName=Richard%20Quadling&amp;YourAge=35<br />
<br />
Regards,<br />
<br />
Richard.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15234""></a>
  <div class="note">
   <strong class="user">alain at samoun dot com</strong>
   <a href="#15234" class="date">02-Sep-2001 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment"># I think that we need some examples of this thing:
<br />
# Lets define a real variant:
<br />
</span><span class="default">$varREAL</span><span class="keyword">=&nbsp; new </span><span class="default">Variant</span><span class="keyword">(</span><span class="string">"9.34 is a real number"</span><span class="keyword">,</span><span class="default">VT_R8</span><span class="keyword">);
<br />
print </span><span class="string">"Value:"</span><span class="keyword">. </span><span class="default">$varREAL</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">; </span><span class="comment"># Will print 9.34
<br />
# Now an integer
<br />
&nbsp; </span><span class="default">$varINT</span><span class="keyword">=&nbsp; new </span><span class="default">Variant</span><span class="keyword">(</span><span class="string">"9.34 Printed as an integer"</span><span class="keyword">,</span><span class="default">VT_INT</span><span class="keyword">);
<br />
print </span><span class="string">"Value:"</span><span class="keyword">. </span><span class="default">$varINT</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">; </span><span class="comment"># Will print 9
<br />
# Now a string
<br />
&nbsp; </span><span class="default">$varSTR</span><span class="keyword">=&nbsp; new </span><span class="default">Variant</span><span class="keyword">(</span><span class="string">"9.34 Printed as a string"</span><span class="keyword">,</span><span class="default">VT_BSTR</span><span class="keyword">);
<br />
print </span><span class="string">"Value:"</span><span class="keyword">. </span><span class="default">$varSTR</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">; </span><span class="comment"># Will 9.34 Printed as a string
<br />
&nbsp;&nbsp; &nbsp; 
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
