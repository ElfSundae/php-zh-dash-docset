<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>return</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="control-structures.declare.html">? declare</a></li>
      <li style="float: right;"><a href="function.require.html">require ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.control-structures.html">流程控制</a></li>
    <li>return</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.return" class="sect1">
 <h2 class="title">return</h2>
 <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p>
 <p class="simpara">
  如果在一个函数中调用 <span class="function"><strong>return</strong></span>
  语句，将立即结束此函数的执行并将它的参数作为函数的值返回。<span class="function"><strong>return</strong></span>
  也会终止 <span class="function"><a href="function.eval.html" class="function">eval()</a></span> 语句或者脚本文件的执行。
 </p>
 <p class="simpara">
  如果在全局范围中调用，则当前脚本文件中止运行。如果当前脚本文件是被
  <span class="function"><a href="function.include.html" class="function">include</a></span> 的或者 <span class="function"><a href="function.require.html" class="function">require</a></span>
  的，则控制交回调用文件。此外，如果当前脚本是被 <span class="function"><a href="function.include.html" class="function">include</a></span>
  的，则 <span class="function"><strong>return</strong></span> 的值会被当作 <span class="function"><a href="function.include.html" class="function">include</a></span>
  调用的返回值。如果在主脚本文件中调用
  <span class="function"><strong>return</strong></span>，则脚本中止运行。如果当前脚本文件是在 <var class="filename">php.ini</var>
  中的配置选项 <a href="ini.core.html#ini.auto-prepend-file" class="link">auto_prepend_file</a> 或者 <a href="ini.core.html#ini.auto-append-file" class="link">auto_append_file</a> 所指定的，则此脚本文件中止运行。
 </p>
 <p class="simpara">
  更多信息见<a href="functions.returning-values.html" class="link">返回值</a>。
 </p>
 <p class="para">
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    注意既然 <span class="function"><strong>return</strong></span>
    是语言结构而不是函数，因此其参数没有必要用括号将其括起来。通常都不用括号，实际上也应该不用，这样可以降低
    PHP 的负担。
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    如果没有提供参数，则一定不能用括号，此时返回 <strong><code>NULL</code></strong>。如果调用
    <em>return</em> 时加上了括号却又没有参数会导致解析错误。
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    当用引用返回值时<em class="emphasis">永远不要</em>使用括号，这样行不通。只能通过引用返回变量，而不是语句的结果。如果使用
    <em>return ($a);</em> 时其实不是返回一个变量，而是表达式
    <em>($a)</em> 的值（当然，此时该值也正是 <var class="varname"><var class="varname">$a</var></var> 的值）。
   </span>
  </p></blockquote>
 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119797""></a>
  <div class="note">
   <strong class="user">hairbysubaru at gmail dot com</strong>
   <a href="#119797" class="date">29-Aug-2016 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
$stat </span><span class="keyword">= array(</span><span class="string">"Inactive"</span><span class="keyword">,</span><span class="string">"Active"</span><span class="keyword">);<br />
<br />
function </span><span class="default">fred</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="string">"firstname"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="string">"lastname"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$status</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return array(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$z</span><span class="keyword">,</span><span class="default">$status</span><span class="keyword">);<br />
}<br />
</span><span class="default">$results </span><span class="keyword">= list(</span><span class="default">$ra</span><span class="keyword">,</span><span class="default">$rb</span><span class="keyword">,</span><span class="default">$rc</span><span class="keyword">,</span><span class="default">$status</span><span class="keyword">) = </span><span class="default">fred</span><span class="keyword">(</span><span class="string">"user_details"</span><span class="keyword">);<br />
</span><span class="comment">//what we get...<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">);<br />
</span><span class="comment">// interpreted results, knowing the 'structure' of $results.<br />
</span><span class="keyword">echo </span><span class="string">"context value 2(heading):"</span><span class="keyword">.</span><span class="default">$results</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
echo </span><span class="string">"context value 0(user fname):"</span><span class="keyword">.</span><span class="default">$results</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
echo </span><span class="string">"context value 1(user lname):"</span><span class="keyword">.</span><span class="default">$results</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
echo </span><span class="string">"context value 3(status):"</span><span class="keyword">.</span><span class="default">$results</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">];<br />
echo </span><span class="string">"status:"</span><span class="keyword">.</span><span class="default">$stat</span><span class="keyword">[</span><span class="default">$results</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">]];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Produces...<br />
<br />
Array ( [0] =&gt; firstname [1] =&gt; lastname [2] =&gt; user_details [3] =&gt; 0 ) <br />
<br />
context value 0(heading):user_details<br />
context value 1(user fname):firstname<br />
context value 2(user lname):lastname<br />
context value 3(status):0<br />
status:Inactive<br />
<br />
Context is everything.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119659""></a>
  <div class="note">
   <strong class="user">sebi at sebi dot moe</strong>
   <a href="#119659" class="date">27-Jul-2016 11:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One situation where returning a value from a script and using it could be considered a good use is config files. Zend Framework 2 promotes this structure for this purpose, and it works pretty well. <br />
<br />
Example config file:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">return [<br />
&nbsp; </span><span class="string">'site' </span><span class="keyword">=&gt; </span><span class="default">123</span><span class="keyword">,<br />
&nbsp; </span><span class="string">'settings' </span><span class="keyword">=&gt; </span><span class="string">'asd'<br />
</span><span class="keyword">];<br />
<br />
</span><span class="default">Reading</span><span class="keyword">:<br />
<br />
&lt;?</span><span class="default">php<br />
$config </span><span class="keyword">= (require </span><span class="string">'config.php'</span><span class="keyword">);<br />
</span><span class="comment">// Or<br />
</span><span class="default">$config </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(require </span><span class="string">'config/local.php'</span><span class="keyword">, require </span><span class="string">'config/application.php'</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117643""></a>
  <div class="note">
   <strong class="user">brad dot k dot harms at gmail dot com</strong>
   <a href="#117643" class="date">14-Jul-2015 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wonder if return in the global scope would be a semantic way to store low-level, pure-PHP config arrays while avoiding polluting the global scope. For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// app.php<br />
<br />
</span><span class="keyword">function </span><span class="default">app</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conf </span><span class="keyword">= include(</span><span class="string">'conf.php'</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">app</span><span class="keyword">();<br />
<br />
&lt;?</span><span class="default">php<br />
</span><span class="comment">// conf.php<br />
<br />
</span><span class="keyword">return [<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'db' </span><span class="keyword">=&gt; [<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'host' </span><span class="keyword">=&gt; </span><span class="string">'127.0.0.1'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'username' </span><span class="keyword">=&gt; </span><span class="string">'user'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="string">'pass'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">],<br />
];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This approach produces exactly 0 global variables.<br />
<br />
(PS. I also tried this using a JS-like module pattern using an anonymous function but it seems that an anon function can't be defined and called in the same expression.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116709""></a>
  <div class="note">
   <strong class="user">Russell Weed</strong>
   <a href="#116709" class="date">14-Feb-2015 01:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Following up on Tom and warhog's comments regarding using return in global scope, here is another reason not to do it:<br />
<br />
For command line scripts, the return statement will NOT return a status to the OS!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$somethingBad</span><span class="keyword">)<br />
&nbsp;&nbsp; return </span><span class="default">42</span><span class="keyword">; </span><span class="comment">// This will not work! You'll get 0 back instead!<br />
</span><span class="keyword">else<br />
&nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Instead, you must use exit(): <a href="http://php.net/exit" rel="nofollow" target="_blank">http://php.net/exit</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$somethingBad</span><span class="keyword">)<br />
&nbsp;&nbsp; exit(</span><span class="default">42</span><span class="keyword">); </span><span class="comment">// OS will receive (int) 42 as the return code<br />
</span><span class="keyword">else </span><span class="comment">// everything is fine<br />
&nbsp;&nbsp; </span><span class="keyword">exit(</span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116497""></a>
  <div class="note">
   <strong class="user">Anonim</strong>
   <a href="#116497" class="date">13-Jan-2015 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also note, what you cannot do anything after&nbsp; the 'return' usage in function. <br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
$_SESSION</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">] = </span><span class="string">'Best PHP'</span><span class="keyword">;<br />
function </span><span class="default">getText</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$text</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">]);<br />
}<br />
echo </span><span class="default">getText</span><span class="keyword">().</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span><br />
This will output:<br />
Best PHP<br />
Best PHP<br />
<br />
Twice, because we have used unset() function after 'return'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114304""></a>
  <div class="note">
   <strong class="user">Tom</strong>
   <a href="#114304" class="date">05-Feb-2014 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Keep in mind that even if PHP allows you to use "return" in the global scope it is very bad design to do so.<br />
<br />
Using the return statement in the global scope encourages programmers to use files like functions and treat the include-statement like a function call. Where they initialize the file's "parameters" by setting variables in the global scope and reading them in the included file.<br />
<br />
Like so: (WARNING! This code was done by professionals in a controlled environment. Do NOT try this at home!)<br />
<span class="default">&lt;?php<br />
$parameter1 </span><span class="keyword">= </span><span class="string">"foo"</span><span class="keyword">;<br />
</span><span class="default">$parameter2 </span><span class="keyword">= </span><span class="string">"bar"</span><span class="keyword">;<br />
</span><span class="default">$result </span><span class="keyword">= include </span><span class="string">"voodoo.php"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Where "voodoo.php" may be something like:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">return </span><span class="default">$parameter1 </span><span class="keyword">. </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$parameter2</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
This is one of the worst designs you can implement since there is no function head, no way to understand where $parameter1 and $parameter2 come from by just looking at "voodoo". No explanation in the calling file as of what $parameter1 and -2 are doing or why they are even there. If the names of the parameters ever change in "voodoo" it will break the calling file. No IDE will properly support this very poor "design". And I won't even start on the security issues!<br />
<br />
If you find yourself in a situation where a return-statement in global scope is the answer to your problem, then maybe you are asking the wrong questions. Actually you may be better off using a function and throwing an exception where needed.<br />
<br />
Files are NOT functions. They should NOT be treated as such and under no circumstances should they "return" anything at all.<br />
<br />
Remember: Every time you abuse a return statement God kills a kitten and makes sure you are reborn as a mouse!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112515""></a>
  <div class="note">
   <strong class="user">J.D. Grimes</strong>
   <a href="#112515" class="date">26-Jun-2013 05:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that because PHP processes the file before running it, any functions defined in an included file will still be available, even if the file is not executed.
<br />

<br />
Example:
<br />

<br />
a.php
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">include </span><span class="string">'b.php'</span><span class="keyword">;
<br />

<br />
</span><span class="default">foo</span><span class="keyword">();
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
b.php
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">return;
<br />

<br />
function </span><span class="default">foo</span><span class="keyword">() {
<br />
&nbsp;&nbsp; &nbsp; echo </span><span class="string">'foo'</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Executing a.php will output "foo".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85112""></a>
  <div class="note">
   <strong class="user">andrew at neonsurge dot com</strong>
   <a href="#85112" class="date">15-Aug-2008 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Response to stoic's message below...<br />
<br />
I believe the way you've explained this for people may be a bit confusing, and your verbiage is incorrect.&nbsp; Your script below is technically calling return from a global scope, but as it says right after that in the description above... "If the current script file was include()ed or require()ed, then control is passed back to the calling file".&nbsp; You are in a included file.&nbsp; Just making sure that is clear.<br />
<br />
Now, the way php works is before it executes actual code it does what you call "processing" is really just a syntax check.&nbsp; It does this every time per-file that is included before executing that file.&nbsp; This is a GOOD feature, as it makes sure not to run any part of non-functional code.&nbsp; What your example might have also said... is that in doing this syntax check it does not execute code, merely runs through your file (or include) checking for syntax errors before execution.&nbsp; To show that, you should put the echo "b"; and echo "a"; at the start of each file.&nbsp; This will show that "b" is echoed once, and then "a" is echoed only once, because the first time it syntax checked a.php, it was ok.&nbsp; But the second time the syntax check failed and thus it was not executed again and terminated execution of the application due to a syntax error.<br />
<br />
Just something to help clarify what you have stated in your comments.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59866""></a>
  <div class="note">
   <strong class="user">warhog at warhog dot net</strong>
   <a href="#59866" class="date">18-Dec-2005 09:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for those of you who think that using return in a script is the same as using exit note that: using return just exits the execution of the current script, exit the whole execution.<br />
<br />
look at that example:<br />
<br />
a.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include(</span><span class="string">"b.php"</span><span class="keyword">);<br />
echo </span><span class="string">"a"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
b.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"b"</span><span class="keyword">;<br />
return;<br />
</span><span class="default">?&gt;<br />
</span><br />
(executing a.php:) will echo "ba".<br />
<br />
whereas (b.php modified):<br />
<br />
a.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include(</span><span class="string">"b.php"</span><span class="keyword">);<br />
echo </span><span class="string">"a"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
b.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"b"</span><span class="keyword">;<br />
exit;<br />
</span><span class="default">?&gt;<br />
</span><br />
(executing a.php:) will echo "b".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
