<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>运算符优先级</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.operators.html">? 运算符</a></li>
      <li style="float: right;"><a href="language.operators.arithmetic.html">算术运算符 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.operators.html">运算符</a></li>
    <li>运算符优先级</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.operators.precedence" class="sect1">
   <h2 class="title">运算符优先级</h2>
   <p class="para">
    运算符优先级指定了两个表达式绑定得有多"紧密"。例如，表达式 <em>1 + 5 *
    3</em> 的结果是 <em>16</em> 而不是 <em>18</em>
    是因为乘号（"*"）的优先级比加号（"+"）高。必要时可以用括号来强制改变优先级。例如：<em>(1
    + 5) * 3</em> 的值为 <em>18</em>。
   </p>
   <p class="para">
    如果运算符优先级相同，那运算符的结合方向决定了该如何运算。例如，&quot;-&quot;是左联的，那么 <em>1 - 2 - 3</em> 就等同于 <em>(1 - 2) - 3</em>
    并且结果是 <em>-4</em>. 另外一方面，&quot;=&quot;是右联的，所以 <em>$a = $b = $c</em> 等同于
    <em>$a = ($b = $c)</em>。
   </p>
   <p class="para">
    没有结合的相同优先级的运算符不能连在一起使用，例如 <em>1 &lt; 2 &gt; 1</em> 在PHP是不合法的。但另外一方面表达式 <em>1 &lt;= 1 == 1</em> 是合法的, 因为 <em>==</em> 的优先级低于 <em>&lt;=</em>。
   </p>
   <p class="para">
    括号的使用，哪怕在不是必要的场合下，通过括号的配对来明确标明运算顺序，而非靠运算符优先级和结合性来决定，通常能够增加代码的可读性。
   </p>
   <p class="para">
    下表按照优先级从高到低列出了运算符。同一行中的运算符具有相同优先级，此时它们的结合方向决定求值顺序。
    <table class="doctable table">
     <caption><strong>运算符优先级</strong></caption>
     
      <thead>
       <tr>
        <th>结合方向</th>
        <th>运算符</th>
        <th>附加信息</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td>无</td>
        <td>clone new</td>
        <td><a href="language.oop5.cloning.html" class="link">clone</a> 和 <a href="language.oop5.basic.html#language.oop5.basic.new" class="link">new</a></td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>[</em></td>
        <td><span class="function"><a href="function.array.html" class="function">array()</a></span></td>
       </tr>

       <tr>
        <td>右</td>
        <td><em>**</em></td>
        <td><a href="language.operators.arithmetic.html" class="link">算术运算符</a></td>
       </tr>

       <tr>
        <td>右</td>
        <td>
         <em>++</em> 
         <em>--</em> 
         <em>~</em> 
         <em>(int)</em> 
         <em>(float)</em> 
         <em>(string)</em> 
         <em>(array)</em>
         <em>(object)</em> 
         <em>(bool)</em> 
         <em>@</em>
        </td>
        <td>
         <a href="language.types.html" class="link">类型</a>和<a href="language.operators.increment.html" class="link">递增／递减</a>
        </td>
       </tr>

       <tr>
        <td>无</td>
        <td><em>instanceof</em></td>
        <td>
         <a href="language.types.html" class="link">类型</a>
        </td>
       </tr>

       <tr>
        <td>右</td>
        <td><em>!</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td>
         <em>*</em>
         <em>/</em>
         <em>%</em>
        </td>
        <td>
         <a href="language.operators.arithmetic.html" class="link">算术运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td>
         <em>+</em> 
         <em>-</em> 
         <em>.</em>
        </td>
        <td>
         <a href="language.operators.arithmetic.html" class="link">算术运算符</a>和<a href="language.operators.string.html" class="link">字符串运算符</a></td>
       </tr>

       <tr>
        <td>左</td>
        <td>
         <em>&lt;&lt;</em> 
         <em>&gt;&gt;</em>
        </td>
        <td>
         <a href="language.operators.bitwise.html" class="link">位运算符</a>
        </td>
       </tr>

       <tr>
        <td>无</td>
        <td>
         <em>&lt;</em> 
         <em>&lt;=</em> 
         <em>&gt;</em> 
         <em>&gt;=</em>
        </td>
        <td>
         <a href="language.operators.comparison.html" class="link">比较运算符</a>
        </td>
       </tr>

       <tr>
        <td>无</td>
        <td>
         <em>==</em>
         <em>!=</em> 
         <em>===</em> 
         <em>!==</em> 
         <em>&lt;&gt;</em>
         <em>&lt;=&gt;</em>
        </td>
        <td>
         <a href="language.operators.comparison.html" class="link">比较运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>&amp;</em></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">位运算符</a>和<a href="language.references.html" class="link">引用</a></td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>^</em></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">位运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>|</em></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">位运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>&amp;&amp;</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>||</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>??</em></td>
        <td>
         <a href="language.operators.comparison.html" class="link">比较运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>? :</em></td>
        <td>
         <a href="language.operators.comparison.html#language.operators.comparison.ternary" class="link">ternary</a>
        </td>
       </tr>

       <tr>
        <td>right</td>
        <td>
         <em>=</em> 
         <em>+=</em> 
         <em>-=</em> 
         <em>*=</em> 
         <em>**=</em> 
         <em>/=</em> 
         <em>.=</em> 
         <em>%=</em> 
         <em>&amp;=</em> 
         <em>|=</em> 
         <em>^=</em> 
         <em>&lt;&lt;=</em> 
         <em>&gt;&gt;=</em>
        </td>
        <td>
         <a href="language.operators.assignment.html" class="link">赋值运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>and</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>xor</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

       <tr>
        <td>左</td>
        <td><em>or</em></td>
        <td>
         <a href="language.operators.logical.html" class="link">逻辑运算符</a>
        </td>
       </tr>

      </tbody>
     
    </table>

   </p>
   <p class="para">
    <div class="example" id="example-130">
     <p><strong>Example #1 结合方向</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">3&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">3&nbsp;</span><span style="color: #007700">%&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;(3&nbsp;*&nbsp;3)&nbsp;%&nbsp;5&nbsp;=&nbsp;4<br />//&nbsp;ternary&nbsp;operator&nbsp;associativity&nbsp;differs&nbsp;from&nbsp;C/C++<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">true&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;(true&nbsp;?&nbsp;0&nbsp;:&nbsp;true)&nbsp;?&nbsp;1&nbsp;:&nbsp;2&nbsp;=&nbsp;2<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;$a&nbsp;=&nbsp;($b&nbsp;+=&nbsp;3)&nbsp;-&gt;&nbsp;$a&nbsp;=&nbsp;5,&nbsp;$b&nbsp;=&nbsp;5<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    Operator precedence and associativity only determine how expressions
    are grouped, they do not specify an order of evaluation. PHP does not
    (in the general case) specify in which order an expression is evaluated
    and code that assumes a specific order of evaluation should be avoided,
    because the behavior can change between versions of PHP or depending on
    the surrounding code.
    <div class="example" id="example-131">
     <p><strong>Example #2 Undefined order of evaluation</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">++;&nbsp;</span><span style="color: #FF8000">//&nbsp;may&nbsp;print&nbsp;either&nbsp;2&nbsp;or&nbsp;3<br /><br /></span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$array</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++;&nbsp;</span><span style="color: #FF8000">//&nbsp;may&nbsp;set&nbsp;either&nbsp;index&nbsp;1&nbsp;or&nbsp;2<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     尽管 <em>=</em> 比其它大多数的运算符的优先级低，PHP
     仍旧允许类似如下的表达式：<em>if (!$a = foo())</em>，在此例中
     <em>foo()</em> 的返回值被赋给了 <var class="varname"><var class="varname">$a</var></var>。
    </p>
   </p></blockquote>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120192""></a>
  <div class="note">
   <strong class="user">kitchin</strong>
   <a href="#120192" class="date">21-Nov-2016 09:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The precedence of '-&gt;' is less than '[' in this situation: object contains array, name of array is stored in string variable.<br />
<span class="default">&lt;?php<br />
$farm </span><span class="keyword">= new </span><span class="default">StdClass</span><span class="keyword">;<br />
</span><span class="default">$farm</span><span class="keyword">-&gt;</span><span class="default">emu </span><span class="keyword">= array( </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="string">'Henry'</span><span class="keyword">, </span><span class="string">'age' </span><span class="keyword">=&gt; </span><span class="default">9 </span><span class="keyword">);<br />
</span><span class="default">$farm</span><span class="keyword">-&gt;</span><span class="default">rabbit </span><span class="keyword">= array( </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="string">'George'</span><span class="keyword">, </span><span class="string">'age' </span><span class="keyword">=&gt; </span><span class="default">4 </span><span class="keyword">);<br />
<br />
</span><span class="default">$animal </span><span class="keyword">= </span><span class="string">'rabbit'</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$farm</span><span class="keyword">-&gt;</span><span class="default">$animal </span><span class="keyword">); </span><span class="comment">// ok<br />
// print( $farm-&gt;$animal[ 'name' ] );&nbsp; // wrong, [ has precedence.<br />
</span><span class="keyword">print( </span><span class="default">$farm</span><span class="keyword">-&gt;{</span><span class="default">$animal</span><span class="keyword">}[ </span><span class="string">'name' </span><span class="keyword">] ); </span><span class="comment">// correct, prints George.<br />
<br />
</span><span class="default">$farm</span><span class="keyword">-&gt;</span><span class="default">wash </span><span class="keyword">= </span><span class="string">'Suds'</span><span class="keyword">;<br />
</span><span class="default">$jobs </span><span class="keyword">= array( </span><span class="string">'morning' </span><span class="keyword">=&gt; </span><span class="string">'feed'</span><span class="keyword">, </span><span class="string">'evening' </span><span class="keyword">=&gt; </span><span class="string">'wash' </span><span class="keyword">);<br />
print( </span><span class="default">$farm</span><span class="keyword">-&gt;</span><span class="default">$jobs</span><span class="keyword">[ </span><span class="string">'evening' </span><span class="keyword">] ); </span><span class="comment">// correct, prints Suds.<br />
</span><span class="keyword">print( </span><span class="default">$farm</span><span class="keyword">-&gt;{</span><span class="default">$jobs</span><span class="keyword">[ </span><span class="string">'evening' </span><span class="keyword">]} ); </span><span class="comment">// correct, prints Suds.<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118296""></a>
  <div class="note">
   <strong class="user">karlisd at gmail dot com</strong>
   <a href="#118296" class="date">11-Nov-2015 02:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes it's easier to understand things in your own examples.<br />
If you want to play around operator precedence and look which tests will be made, you can play around with this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">F</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">) {echo </span><span class="default">$v</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">; return </span><span class="default">false</span><span class="keyword">;}<br />
function </span><span class="default">T</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">) {echo </span><span class="default">$v</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">; return </span><span class="default">true</span><span class="keyword">;}<br />
<br />
IF (</span><span class="default">F</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">) || </span><span class="default">T</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">) &amp;&amp; </span><span class="default">F</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">)&nbsp; || </span><span class="default">F</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">)&nbsp; &amp;&amp; ! </span><span class="default">F</span><span class="keyword">(</span><span class="default">4</span><span class="keyword">) ) {<br />
&nbsp; echo </span><span class="string">"true"</span><span class="keyword">;<br />
} else echo </span><span class="string">" false"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>Now put in IF arguments f for false and t for true, put in them some ID's. Play out by changing "F" to "T" and vice versa, by keeping your ID the same. See output and you will know which arguments&nbsp; actualy were checked.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117390""></a>
  <div class="note">
   <strong class="user">fabmlk</strong>
   <a href="#117390" class="date">03-Jun-2015 02:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Watch out for the difference of priority between 'and vs &amp;&amp;' or '|| vs or':<br />
<span class="default">&lt;?php<br />
$bool </span><span class="keyword">= </span><span class="default">true </span><span class="keyword">&amp;&amp; </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$bool</span><span class="keyword">); </span><span class="comment">// false, that's expected<br />
<br />
</span><span class="default">$bool </span><span class="keyword">= </span><span class="default">true </span><span class="keyword">and </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$bool</span><span class="keyword">); </span><span class="comment">// true, ouch!<br />
</span><span class="default">?&gt;<br />
</span>Because 'and/or' have lower priority than '=' but '||/&amp;&amp;' have higher.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117252""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#117252" class="date">10-May-2015 08:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following example will output false <br />
$a = 1;<br />
$b = 1;<br />
<br />
$c = $a + $a++;<br />
$d = 1 + $b++;<br />
<br />
if($c == $d){<br />
&nbsp;&nbsp;&nbsp; echo 'true';<br />
}else{<br />
&nbsp;&nbsp;&nbsp; echo 'false';<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112401""></a>
  <div class="note">
   <strong class="user">leipie at gmail dot com</strong>
   <a href="#112401" class="date">12-Jun-2013 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The precedence of the arrow operator (-&gt;) on objects seems to the highest of all, even higher then clone. <br />
<br />
But you can't wrap (clone $foo)-&gt;bar() like this!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109325""></a>
  <div class="note">
   <strong class="user">Carsten Milkau</strong>
   <a href="#109325" class="date">06-Jul-2012 09:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware the unusual order of bit-wise operators and comparison operators, this has often lead to bugs in my experience. For instance:<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">if ( </span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">MASK&nbsp; </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) </span><span class="default">do_something</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span><br />
will not do what you might expect from other languages. Use<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">if ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">MASK</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">) </span><span class="default">do_something</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span><br />
in PHP instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91377""></a>
  <div class="note">
   <strong class="user">headden at karelia dot ru</strong>
   <a href="#91377" class="date">09-Jun-2009 01:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Although example above already shows it, I'd like to explicitly state that ?: associativity DIFFERS from that of C++. I.e. convenient switch/case-like expressions of the form<br />
<br />
$i==1 ? "one" :<br />
$i==2 ? "two" :<br />
$i==3 ? "three" :<br />
"error";<br />
<br />
will not work in PHP as expected</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
