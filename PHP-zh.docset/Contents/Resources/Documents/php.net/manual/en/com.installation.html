<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="com.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="com.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="com.setup.html">安装／配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="com.installation" class="section">
  <h2 class="title">安装</h2>
  <p class="para">
   As of PHP 5.3.15 / 5.4.5, this extension requires <var class="filename">php_com_dotnet.dll</var>
   to be enabled inside of <var class="filename">php.ini</var> in order to use these functions. Previous versions of
   PHP enabled these extensions by default.
  </p>
  <p class="para">
   You are responsible for installing support for the various COM objects
   that you intend to use (such as MS Word); we don&#039;t and can&#039;t bundle all
   of those with PHP.
  </p>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="109778""></a>
  <div class="note">
   <strong class="user">Andriy Bazanov</strong>
   <a href="#109778" class="date">20-Aug-2012 08:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of 5.3.15 (if you are still on 5.3 branch) you have to add extension=php_com_dotnet.dll line into your php.ini to have COM, DOTNET, VARIANT and similar classes available and working.<br />
<br />
From PHP Change log:<br />
&nbsp;&nbsp;&nbsp; COM<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Fixed bug #62146 com_dotnet cannot be built shared<br />
<br />
Because of this, the official PHP builds for Windows are now built with "--enable-com-dotnet=shared" option, which means no COM/DOTNET support by default.<br />
<br />
Some of my projects that I currently maintain use adodb library which uses VARIANT class and fails to work without it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109552""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#109552" class="date">28-Jul-2012 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From PHP 5.4.5, COM and DOTNET is no longer built into the php core.you have to add COM support in php.ini:
<br />

<br />
[COM_DOT_NET]
<br />
extension=php_com_dotnet.dll
<br />

<br />
Otherwise you will see this in your error log:
<br />
Fatal error:&nbsp; Class \'COM\' not found
<br />

<br />
The extension is included with php 5.4.5 for Windows.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
