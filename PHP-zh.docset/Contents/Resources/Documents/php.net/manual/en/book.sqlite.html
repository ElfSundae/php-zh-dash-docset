<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>SQLite</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.pg-version.html">? pg_version</a></li>
      <li style="float: right;"><a href="intro.sqlite.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.database.vendors.html">针对各数据库系统对应的扩展</a></li>
    <li>SQLite</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.sqlite" class="book">
 <h1 class="title">SQLite</h1>
 
 
 
 
 
 







 





 


 




<ul class="chunklist chunklist_book"><li><a href="intro.sqlite.html">简介</a></li><li><a href="sqlite.setup.html">安装／配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="sqlite.requirements.html">需求</a></li><li><a href="sqlite.installation.html">安装</a></li><li><a href="sqlite.configuration.html">运行时配置</a></li><li><a href="sqlite.resources.html">资源类型</a></li></ul></li><li><a href="sqlite.constants.html">预定义常量</a></li><li><a href="ref.sqlite.html">SQLite 函数</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.sqlite-array-query.html">sqlite_array_query</a> &mdash; Execute a query against a given database and returns an array</li><li><a href="function.sqlite-busy-timeout.html">sqlite_busy_timeout</a> &mdash; Set busy timeout duration, or disable busy handlers</li><li><a href="function.sqlite-changes.html">sqlite_changes</a> &mdash; Returns the number of rows that were changed by the most
   recent SQL statement</li><li><a href="function.sqlite-close.html">sqlite_close</a> &mdash; Closes an open SQLite database</li><li><a href="function.sqlite-column.html">sqlite_column</a> &mdash; Fetches a column from the current row of a result set</li><li><a href="function.sqlite-create-aggregate.html">sqlite_create_aggregate</a> &mdash; Register an aggregating UDF for use in SQL statements</li><li><a href="function.sqlite-create-function.html">sqlite_create_function</a> &mdash; Registers a &quot;regular&quot; User Defined Function for use in SQL statements</li><li><a href="function.sqlite-current.html">sqlite_current</a> &mdash; Fetches the current row from a result set as an array</li><li><a href="function.sqlite-error-string.html">sqlite_error_string</a> &mdash; Returns the textual description of an error code</li><li><a href="function.sqlite-escape-string.html">sqlite_escape_string</a> &mdash; Escapes a string for use as a query parameter</li><li><a href="function.sqlite-exec.html">sqlite_exec</a> &mdash; Executes a result-less query against a given database</li><li><a href="function.sqlite-factory.html">sqlite_factory</a> &mdash; Opens an SQLite database and returns an SQLiteDatabase object</li><li><a href="function.sqlite-fetch-all.html">sqlite_fetch_all</a> &mdash; Fetches all rows from a result set as an array of arrays</li><li><a href="function.sqlite-fetch-array.html">sqlite_fetch_array</a> &mdash; Fetches the next row from a result set as an array</li><li><a href="function.sqlite-fetch-column-types.html">sqlite_fetch_column_types</a> &mdash; Return an array of column types from a particular table</li><li><a href="function.sqlite-fetch-object.html">sqlite_fetch_object</a> &mdash; Fetches the next row from a result set as an object</li><li><a href="function.sqlite-fetch-single.html">sqlite_fetch_single</a> &mdash; Fetches the first column of a result set as a string</li><li><a href="function.sqlite-fetch-string.html">sqlite_fetch_string</a> &mdash; 别名 sqlite_fetch_single</li><li><a href="function.sqlite-field-name.html">sqlite_field_name</a> &mdash; Returns the name of a particular field</li><li><a href="function.sqlite-has-more.html">sqlite_has_more</a> &mdash; Finds whether or not more rows are available</li><li><a href="function.sqlite-has-prev.html">sqlite_has_prev</a> &mdash; Returns whether or not a previous row is available</li><li><a href="function.sqlite-key.html">sqlite_key</a> &mdash; Returns the current row index</li><li><a href="function.sqlite-last-error.html">sqlite_last_error</a> &mdash; Returns the error code of the last error for a database</li><li><a href="function.sqlite-last-insert-rowid.html">sqlite_last_insert_rowid</a> &mdash; Returns the rowid of the most recently inserted row</li><li><a href="function.sqlite-libencoding.html">sqlite_libencoding</a> &mdash; Returns the encoding of the linked SQLite library</li><li><a href="function.sqlite-libversion.html">sqlite_libversion</a> &mdash; Returns the version of the linked SQLite library</li><li><a href="function.sqlite-next.html">sqlite_next</a> &mdash; Seek to the next row number</li><li><a href="function.sqlite-num-fields.html">sqlite_num_fields</a> &mdash; Returns the number of fields in a result set</li><li><a href="function.sqlite-num-rows.html">sqlite_num_rows</a> &mdash; Returns the number of rows in a buffered result set</li><li><a href="function.sqlite-open.html">sqlite_open</a> &mdash; Opens an SQLite database and create the database if it does not exist</li><li><a href="function.sqlite-popen.html">sqlite_popen</a> &mdash; Opens a persistent handle to an SQLite database and create the database if it does not exist</li><li><a href="function.sqlite-prev.html">sqlite_prev</a> &mdash; Seek to the previous row number of a result set</li><li><a href="function.sqlite-query.html">sqlite_query</a> &mdash; Executes a query against a given database and returns a result handle</li><li><a href="function.sqlite-rewind.html">sqlite_rewind</a> &mdash; Seek to the first row number</li><li><a href="function.sqlite-seek.html">sqlite_seek</a> &mdash; Seek to a particular row number of a buffered result set</li><li><a href="function.sqlite-single-query.html">sqlite_single_query</a> &mdash; Executes a query and returns either an array for one single column or the value of the first row</li><li><a href="function.sqlite-udf-decode-binary.html">sqlite_udf_decode_binary</a> &mdash; Decode binary data passed as parameters to an UDF</li><li><a href="function.sqlite-udf-encode-binary.html">sqlite_udf_encode_binary</a> &mdash; Encode binary data before returning it from an UDF</li><li><a href="function.sqlite-unbuffered-query.html">sqlite_unbuffered_query</a> &mdash; Execute a query that does not prefetch and buffer all data</li><li><a href="function.sqlite-valid.html">sqlite_valid</a> &mdash; Returns whether more rows are available</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118637""></a>
  <div class="note">
   <strong class="user">arriolasimon at gmail dot com</strong>
   <a href="#118637" class="date">14-Jan-2016 12:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just in case some is facing the error:<br />
"file is encrypted or is not a database"<br />
<br />
check this page out:<br />
<a href="http://stackoverflow.com/questions/1513849/error-file-is-encrypted-or-is-not-a-database" rel="nofollow" target="_blank">http://stackoverflow.com/questions/1513849/error-file-is-encrypted-or-is-not-a-database</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103842""></a>
  <div class="note">
   <strong class="user">nosdudefr at gmail dot com</strong>
   <a href="#103842" class="date">06-May-2011 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding&nbsp; the table creation you can optimize this code a bit by using the built in " CREATE TABLE IF NOT EXISTS &lt;tablename&gt;". This will let the table creation decision to the sqlite engine.<br />
<br />
Then, if i may, your code could be something like : <br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$db </span><span class="keyword">= new </span><span class="default">SQLiteDatabase</span><span class="keyword">(</span><span class="string">'filename'</span><span class="keyword">)) {<br />
</span><span class="comment">// first let the engine check table, and create it eventualy<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$q </span><span class="keyword">= @</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'CREATE TABLE IF NOT EXISTS tablename (id int, requests int, PRIMARY KEY (id))'</span><span class="keyword">;<br />
<br />
</span><span class="comment">//the rest of the code, according error checks etc<br />
// ...<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
For more "tweaks" feel free to look at sqlite language ref : <a href="http://www.sqlite.org/lang_createtable.html" rel="nofollow" target="_blank">http://www.sqlite.org/lang_createtable.html</a><br />
<br />
Have fun with this powerfull&amp;simple engine :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99057""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#99057" class="date">25-Jul-2010 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of July 2010, there are two ways to use SQLite from PHP:<br />
- procedural: sqlite (=sqlite2), sqlite3<br />
- object-oriented: SQLite3, PDO</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91488""></a>
  <div class="note">
   <strong class="user">Andrew Paul Dickey</strong>
   <a href="#91488" class="date">12-Jun-2009 06:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you intend to implement 2.x releases of SQLite with your development you are in the right place, as this library is suitable for use with your application (reference <a href="http://us.php.net/manual/en/book.sqlite.php" rel="nofollow" target="_blank">http://us.php.net/manual/en/book.sqlite.php</a>).<br />
<br />
If you intend to use SQLite 3.x releases of SQLite with your development please refer to the section on PHP Data Objects, and specifically the PDO-SQLite implementation available at(references: <a href="http://us.php.net/manual/en/book.pdo.php , http://au2.php.net/manual/en/ref.pdo-sqlite.php" rel="nofollow" target="_blank">http://us.php.net/manual/en/book.pdo.php , http://au2.php.net/manual/en/ref.pdo-sqlite.php</a>).<br />
<br />
It is my hope that this post will save both new users and experienced developers time during their initial or a new implementation of PHP &amp; SQLite by encouraging them to use the appropriate libraries.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82875""></a>
  <div class="note">
   <strong class="user">saivert at saivert dot com</strong>
   <a href="#82875" class="date">30-Apr-2008 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to open a database, create a table if it doesn't exist and inserting initial value.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$db </span><span class="keyword">= new </span><span class="default">SQLiteDatabase</span><span class="keyword">(</span><span class="string">'filename'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$q </span><span class="keyword">= @</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'SELECT requests FROM tablename WHERE id = 1'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$q </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">queryExec</span><span class="keyword">(</span><span class="string">'CREATE TABLE tablename (id int, requests int, PRIMARY KEY (id)); INSERT INTO tablename VALUES (1,1)'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hits </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$q</span><span class="keyword">-&gt;</span><span class="default">fetchSingle</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hits </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">queryExec</span><span class="keyword">(</span><span class="string">"UPDATE tablename SET requests = '</span><span class="default">$hits</span><span class="string">' WHERE id = 1"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="default">$err</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Use this as boilerplate code for any new project using SQLite.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
