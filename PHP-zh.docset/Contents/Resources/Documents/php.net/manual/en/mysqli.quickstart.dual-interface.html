<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Dual procedural and object-oriented interface</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqli.quickstart.html">? Quick start guide</a></li>
      <li style="float: right;"><a href="mysqli.quickstart.connections.html">Connections ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mysqli.quickstart.html">Quick start guide</a></li>
    <li>Dual procedural and object-oriented interface</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqli.quickstart.dual-interface" class="section">
  <h2 class="title">Dual procedural and object-oriented interface</h2>
  <p class="para">
   The mysqli extension features a dual interface. It supports the procedural
   and object-oriented programming paradigm.
  </p>
  <p class="para">
   Users migrating from the old mysql extension may prefer the procedural
   interface. The procedural interface is similar to that of the old mysql
   extension. In many cases, the function names differ only by prefix.
   Some mysqli functions take a connection handle as their first argument,
   whereas matching functions in the old mysql interface take
   it as an optional last argument.
  </p>
  <p class="para">
   <div class="example" id="example-1737">
    <p><strong>Example #1 Easy migration from the old mysql extension</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;'Please,&nbsp;do&nbsp;not&nbsp;use&nbsp;'&nbsp;AS&nbsp;_msg&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'_msg'</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$mysql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"test"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;'the&nbsp;mysql&nbsp;extension&nbsp;for&nbsp;new&nbsp;developments.'&nbsp;AS&nbsp;_msg&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'_msg'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Please, do not use the mysql extension for new developments.
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <em class="emphasis">The object-oriented interface</em>
  </p>
  <p class="para">
   In addition to the classical procedural interface, users can choose to use
   the object-oriented interface. The documentation is organized using
   the object-oriented interface. The object-oriented interface shows functions
   grouped by their purpose, making it easier to get started. The reference section
   gives examples for both syntax variants.
  </p>
  <p class="para">
   There are no significant performance differences between the two interfaces.
   Users can base their choice on personal preference.
  </p>
  <p class="para">
   <div class="example" id="example-1738">
    <p><strong>Example #2 Object-oriented and procedural interface</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">mysqli_connect_errno</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;connect&nbsp;to&nbsp;MySQL:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysqli_connect_error</span><span style="color: #007700">();<br />}<br /><br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;'A&nbsp;world&nbsp;full&nbsp;of&nbsp;'&nbsp;AS&nbsp;_msg&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'_msg'</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;connect&nbsp;to&nbsp;MySQL:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_error</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;'choices&nbsp;to&nbsp;please&nbsp;everybody.'&nbsp;AS&nbsp;_msg&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'_msg'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
A world full of choices to please everybody.
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   The object oriented interface is used for the quickstart because the
   reference section is organized that way.
  </p>
  <p class="para">
   <em class="emphasis">Mixing styles</em>
  </p>
  <p class="para">
   It is possible to switch between styles at any time. Mixing both styles is
   not recommended for code clarity and coding style reasons.
  </p>
  <p class="para">
   <div class="example" id="example-1739">
    <p><strong>Example #3 Bad coding style</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;connect&nbsp;to&nbsp;MySQL:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_error</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;'Possible&nbsp;but&nbsp;bad&nbsp;style.'&nbsp;AS&nbsp;_msg&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$res</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;run&nbsp;query:&nbsp;("&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">")&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">;<br />}<br /><br />if&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'_msg'</span><span style="color: #007700">];<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Possible but bad style.
</pre></div>
    </div>
    </div>
  </p>
  <p class="para">
   <em class="emphasis">See also</em>
  </p>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="methodname"><a href="mysqli.construct.html" class="methodname">mysqli::__construct()</a></span></li>
    <li class="member"><span class="methodname"><a href="mysqli.query.html" class="methodname">mysqli::query()</a></span></li>
    <li class="member"><span class="methodname"><a href="mysqli-result.fetch-assoc.html" class="methodname">mysqli_result::fetch_assoc()</a></span></li>
    <li class="member"><a href="mysqli.connect-errno.html" class="link">$mysqli::connect_errno</a></li>
    <li class="member"><a href="mysqli.connect-error.html" class="link">$mysqli::connect_error</a></li>
    <li class="member"><a href="mysqli.errno.html" class="link">$mysqli::errno</a></li>
    <li class="member"><a href="mysqli.error.html" class="link">$mysqli::error</a></li>
    <li class="member"><a href="mysqli.summary.html" class="link">The MySQLi Extension Function Summary</a></li>
   </ul>
  </p>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118663""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#118663" class="date">16-Jan-2016 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I don't know whether I can put my opinion here, but yet...<br />
<br />
I don't think that mixing styles is so bad idea. Yes, maybe it isn't good when working in a team, but if you work on a code on your own and it's convenient for you - why not?<br />
<br />
For example, I prefer the OO style generally. But when it comes to setting connection, the procedural style provides opportunity to use easy 'or' syntax:<br />
<br />
<span class="default">&lt;?php<br />
$connection </span><span class="keyword">= @</span><span class="default">mysqli_connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'root'</span><span class="keyword">, </span><span class="string">'1234'</span><span class="keyword">, </span><span class="string">'db'</span><span class="keyword">) or die(</span><span class="string">'Connect Error (' </span><span class="keyword">. </span><span class="default">mysqli_connect_errno</span><span class="keyword">() . </span><span class="string">') ' </span><span class="keyword">. </span><span class="default">mysqli_connect_error</span><span class="keyword">());<br />
</span><span class="default">?&gt;<br />
</span><br />
which is more convenient for me than:<br />
<br />
<span class="default">&lt;?php<br />
$connection </span><span class="keyword">= @new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'root'</span><span class="keyword">, </span><span class="string">'1234'</span><span class="keyword">, </span><span class="string">'db'</span><span class="keyword">);<br />
if (</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">connect_errno</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">'Connect Error (' </span><span class="keyword">. </span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">connect_errno</span><span class="keyword">() . </span><span class="string">') ' </span><span class="keyword">. </span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">connect_error</span><span class="keyword">());<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
So why shouldn't I use the procedural style when setting connection?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116461""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#116461" class="date">07-Jan-2015 08:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just want to add that both procedural mysqli_connect_errno and mysqli_connect_error DON'T accept any arguments!<br />
<a href="http://php.net/manual/de/mysqli.connect-errno.php" rel="nofollow" target="_blank">http://php.net/manual/de/mysqli.connect-errno.php</a><br />
<a href="http://php.net/manual/de/mysqli.connect-error.php" rel="nofollow" target="_blank">http://php.net/manual/de/mysqli.connect-error.php</a><br />
"int mysqli_connect_errno ( void )"<br />
"string mysqli_connect_error ( void )"<br />
It clearly states "void" there.<br />
<br />
Adding the mysqli-Instance as a parameter makes it look like it pulls the error-number out of the provided instance, which is not actually happening. This could end in a hard to detect bug when connecting to multiple SQL servers.<br />
And it is confusing for beginners.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112656""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#112656" class="date">10-Jul-2013 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After significant searching with no success finding a solution I was able to figure out the following to error 2005 where the connection could not find the host. While I am hosted on 1&amp;1 I saw numerous posts with similar problems.<br />
<br />
The solution turned out to be as follows:<br />
<br />
<span class="default">&lt;?php <br />
<br />
$mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">DB_HOST</span><span class="keyword">, </span><span class="default">DB_USER</span><span class="keyword">, </span><span class="default">DB_PASS</span><span class="keyword">, </span><span class="default">DB_NAME</span><span class="keyword">, </span><span class="default">DB_PORT</span><span class="keyword">, </span><span class="default">DB_UNIX_SOCKET</span><span class="keyword">);<br />
<br />
</span><span class="default">I added the DB_PORT </span><span class="keyword">and </span><span class="default">DB_UNIX_SOCKET<br />
<br />
</span><span class="comment">/** name of the database. please note: database and database table are not the same thing! */<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"DB_NAME"</span><span class="keyword">, </span><span class="string">"YOUR DB NAME"</span><span class="keyword">);<br />
<br />
</span><span class="comment">/** user for your database. the user needs to have rights for SELECT, UPDATE, DELETE and INSERT.<br />
/** By the way, it's bad style to use "root", but for development it will work */<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"DB_USER"</span><span class="keyword">, </span><span class="string">"YOUR DB USER"</span><span class="keyword">);<br />
<br />
</span><span class="comment">/** The password of the above user */<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"DB_PASS"</span><span class="keyword">, </span><span class="string">"YOUR DB PWORD"</span><span class="keyword">);<br />
<br />
</span><span class="comment">/** The unix socket for 1&amp;1 dedicated */<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"DB_UNIX_SOCKET"</span><span class="keyword">, </span><span class="string">"/tmp/mysql5.sock"</span><span class="keyword">);<br />
<br />
</span><span class="comment">/** The db port, replace with yours */<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"DB_PORT"</span><span class="keyword">, </span><span class="default">3306</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
