<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Fetch row as object</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mssql-fetch-field.html">? mssql_fetch_field</a></li>
      <li style="float: right;"><a href="function.mssql-fetch-row.html">mssql_fetch_row ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mssql.html">Mssql 函数</a></li>
    <li>Fetch row as object</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mssql-fetch-object" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mssql_fetch_object</h1>
  <p class="verinfo">(PHP 4, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_fetch_object</span> &mdash; <span class="dc-title">Fetch row as object</span></p>

 </div>
 
 <div id="function.mssql-fetch-object-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   
<p class="para">
 This function was <em class="emphasis">REMOVED</em> in PHP 7.0.0.
</p>
<p class="para">
 Alternatives to this function include:
</p>

   <ul class="simplelist">
    <li class="member"><span class="function"><a href="pdostatement.fetchobject.html" class="function">PDOStatement::fetchObject()</a></span></li>
    <li class="member"><span class="function"><a href="function.sqlsrv-fetch-object.html" class="function">sqlsrv_fetch_object()</a></span></li>
    <li class="member"><span class="function"><a href="function.odbc-fetch-object.html" class="function">odbc_fetch_object()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mssql-fetch-object-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">object</span> <span class="methodname"><strong>mssql_fetch_object</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mssql_fetch_object()</strong></span> is similar to
   <span class="function"><a href="function.mssql-fetch-array.html" class="function">mssql_fetch_array()</a></span>, with one difference - an
   object is returned, instead of an array.  Indirectly, that means
   that you can only access the data by the field names, and not by
   their offsets (numbers are illegal property names).
  </p>
  <p class="para">
   Speed-wise, the function is identical to
   <span class="function"><a href="function.mssql-fetch-array.html" class="function">mssql_fetch_array()</a></span>, and almost as quick as
   <span class="function"><a href="function.mssql-fetch-row.html" class="function">mssql_fetch_row()</a></span> (the difference is
   insignificant).
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-fetch-object-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">result</code></dt>

     <dd>

      <p class="para">
       The result resource that is being evaluated. This result comes from a
       call to <span class="function"><a href="function.mssql-query.html" class="function">mssql_query()</a></span>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-fetch-object-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an object with properties that correspond to the fetched row, or
   <strong><code>FALSE</code></strong> if there are no more rows.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-fetch-object-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-1690">
    <p><strong>Example #1 <span class="function"><strong>mssql_fetch_object()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Send&nbsp;a&nbsp;select&nbsp;query&nbsp;to&nbsp;MSSQL<br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;[username],&nbsp;[name]&nbsp;FROM&nbsp;[php].[dbo].[userlist]'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Check&nbsp;if&nbsp;there&nbsp;were&nbsp;any&nbsp;records<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">mssql_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'No&nbsp;records&nbsp;found'</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Print&nbsp;a&nbsp;nice&nbsp;list&nbsp;of&nbsp;users&nbsp;in&nbsp;the&nbsp;format&nbsp;of:<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;*&nbsp;name&nbsp;(username)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&lt;ul&gt;'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_fetch_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'&lt;li&gt;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&nbsp;('&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">')&lt;/li&gt;'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'&lt;/ul&gt;'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Free&nbsp;the&nbsp;query&nbsp;result<br /></span><span style="color: #0000BB">mssql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mssql-fetch-object-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数返回的字段名<em class="emphasis">大小写敏感</em>。</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数将 NULL 字段设置为 PHP <strong><code>NULL</code></strong> 值。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mssql-fetch-object-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mssql-fetch-array.html" class="function" rel="rdfs-seeAlso">mssql_fetch_array()</a> - Fetch a result row as an associative array, a numeric array, or both</span></li>
    <li class="member"><span class="function"><a href="function.mssql-fetch-row.html" class="function" rel="rdfs-seeAlso">mssql_fetch_row()</a> - Get row as enumerated array</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="49236""></a>
  <div class="note">
   <strong class="user">rubin at afternet dot org</strong>
   <a href="#49236" class="date">21-Jan-2005 02:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is important to point out that the result of both<br />
SELECT ' '<br />
and<br />
SELECT ''<br />
<br />
is the string ' '.<br />
<br />
That is, the php mssql functions will return a phantom space for any empty strings.<br />
<br />
See <a href="http://bugs.php.net/bug.php?id=26996 and http://bugs.php.net/bug.php?id=25777" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=26996 and http://bugs.php.net/bug.php?id=25777</a><br />
<br />
PHP does not classify this as a "bug" because the MS DBLib cannot tell the difference betwene the two cases. Earlier versions of php trim'd strings automatically.<br />
<br />
It may be a good idea to ltrim and rtrim your results in some cases.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33901""></a>
  <div class="note">
   <strong class="user">klystofer at brturbo dot com</strong>
   <a href="#33901" class="date">10-Jul-2003 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/*<br />
A simple example using mssql_fetch_object<br />
*/<br />
<br />
</span><span class="default">$conexao </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">"myServer"</span><span class="keyword">,</span><span class="string">"myUser"</span><span class="keyword">,</span><span class="string">"myPass"</span><span class="keyword">);<br />
</span><span class="default">mssql_select_db</span><span class="keyword">(</span><span class="string">"myDB"</span><span class="keyword">,</span><span class="default">$conexao</span><span class="keyword">);<br />
<br />
</span><span class="default">$query </span><span class="keyword">= </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"SELECT EMPRESA FROM IDENTIFICACAO ORDER BY EMPRESA;"</span><span class="keyword">);<br />
<br />
while (</span><span class="default">$retorno </span><span class="keyword">= </span><span class="default">mssql_fetch_object</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">))<br />
&nbsp;&nbsp; echo </span><span class="string">"Empresa:" </span><span class="keyword">. </span><span class="default">$retorno</span><span class="keyword">-&gt;</span><span class="default">EMPRESA</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
