<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>返回一个包含结果集中所有行的数组</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="pdostatement.fetch.html">? PDOStatement::fetch</a></li>
      <li style="float: right;"><a href="pdostatement.fetchcolumn.html">PDOStatement::fetchColumn ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.pdostatement.html">PDOStatement</a></li>
    <li>返回一个包含结果集中所有行的数组</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="pdostatement.fetchall" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">PDOStatement::fetchAll</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.1.0, PECL pdo &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">PDOStatement::fetchAll</span> &mdash; <span class="dc-title">
   返回一个包含结果集中所有行的数组
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-pdostatement.fetchall-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>PDOStatement::fetchAll</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$fetch_style</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$fetch_argument</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$ctor_args</code><span class="initializer"> = array()</span></span>
  ]]] )</div>


 </div>


 <div class="refsect1 parameters" id="refsect1-pdostatement.fetchall-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">fetch_style</code></dt>

     <dd>

      <p class="para">
       控制返回数组的内容如同 <span class="function"><a href="pdostatement.fetch.html" class="function">PDOStatement::fetch()</a></span> 文档中记载的一样。默认为 <strong><code>PDO::ATTR_DEFAULT_FETCH_MODE</code></strong> 的值（ 其缺省值为 <strong><code>PDO::FETCH_BOTH</code></strong> ）
      </p>
      <p class="para">
       想要返回一个包含结果集中单独一列所有值的数组，需要指定 <strong><code>PDO::FETCH_COLUMN</code></strong> 。通过指定  <code class="parameter">column-index</code>  参数获取想要的列。
      </p>
      <p class="para">
      想要获取结果集中单独一列的唯一值，需要将 <strong><code>PDO::FETCH_COLUMN</code></strong> 和 <strong><code>PDO::FETCH_UNIQUE</code></strong> 按位或。
      </p>
      <p class="para">
       想要返回一个根据指定列把值分组后的关联数组，需要将 <strong><code>PDO::FETCH_COLUMN</code></strong> 和 <strong><code>PDO::FETCH_GROUP</code></strong> 按位或。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">fetch_argument</code></dt>

     <dd>

      <p class="para">
       根据 <code class="parameter">fetch_style</code> 参数的值，此参数有不同的意义：
       <ul class="itemizedlist">
        <li class="listitem">
         <p class="para">
          <strong><code>PDO::FETCH_COLUMN</code></strong>：返回指定以0开始索引的列。
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>PDO::FETCH_CLASS</code></strong>：返回指定类的实例，映射每行的列到类中对应的属性名。
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>PDO::FETCH_FUNC</code></strong>：将每行的列作为参数传递给指定的函数，并返回调用函数后的结果。
         </p>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">ctor_args</code></dt>

     <dd>

      <p class="para">
       当 <code class="parameter">fetch_style</code> 参数为 <strong><code>PDO::FETCH_CLASS</code></strong> 时，自定义类的构造函数的参数。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-pdostatement.fetchall-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   <span class="function"><strong>PDOStatement::fetchAll()</strong></span> 返回一个包含结果集中所有剩余行的数组。此数组的每一行要么是一个列值的数组，要么是属性对应每个列名的一个对象。
  </p>
  <p class="para">
   使用此方法获取大结果集将导致系统负担加重且可能占用大量网络资源。与其取回所有数据后用PHP来操作，倒不如考虑使用数据库服务来处理结果集。例如，在取回数据并通过PHP处理前，在 SQL 中使用 WHERE  和 ORDER BY 子句来限定结果。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-pdostatement.fetchall-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-975"><p><strong>Example #1 获取结果集中所有剩余的行</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;name,&nbsp;colour&nbsp;FROM&nbsp;fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*&nbsp;获取结果集中所有剩余的行&nbsp;*/<br /></span><span style="color: #007700">print(</span><span style="color: #DD0000">"Fetch&nbsp;all&nbsp;of&nbsp;the&nbsp;remaining&nbsp;rows&nbsp;in&nbsp;the&nbsp;result&nbsp;set:\n"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Fetch all of the remaining rows in the result set:
Array
(
    [0] =&gt; Array
        (
            [NAME] =&gt; pear
            [0] =&gt; pear
            [COLOUR] =&gt; green
            [1] =&gt; green
        )

    [1] =&gt; Array
        (
            [NAME] =&gt; watermelon
            [0] =&gt; watermelon
            [COLOUR] =&gt; pink
            [1] =&gt; pink
        )

)
</pre></div>
    </div>
   </div>
   <div class="example" id="example-976"><p><strong>Example #2 获取结果集中单独一列的所有值</strong></p>
    <div class="example-contents"><p>
     下面例子演示了如何从一个结果集中返回单独一列所有的值，尽管 SQL 语句自身可能返回每行多列。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;name,&nbsp;colour&nbsp;FROM&nbsp;fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*&nbsp;获取第一列所有值&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_COLUMN</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array(3)
(
    [0] =&gt;
    string(5) =&gt; apple
    [1] =&gt;
    string(4) =&gt; pear
    [2] =&gt;
    string(10) =&gt; watermelon
)
</pre></div>
    </div>
   </div>
   <div class="example" id="example-977"><p><strong>Example #3 根据单独的一列把所有值分组</strong></p>
    <div class="example-contents"><p>
     下面例子演示了如何返回一个根据结果集中指定列的值分组的关联数组。该数组包含三个键：返回的 <em>apple</em> 和 <em>pear</em> 数组包含了两种不同的颜色，而返回的 <em>watermelon</em> 数组仅包含一种颜色。 
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$insert&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;fruit(name,&nbsp;colour)&nbsp;VALUES&nbsp;(?,&nbsp;?)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$insert</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'apple'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'green'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$insert</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'pear'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'yellow'</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;name,&nbsp;colour&nbsp;FROM&nbsp;fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*&nbsp;根据第一列分组&nbsp;&nbsp;*/<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_COLUMN</span><span style="color: #007700">|</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_GROUP</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [&quot;apple&quot;]=&gt;
  array(2) {
    [0]=&gt;
    string(5) &quot;green&quot;
    [1]=&gt;
    string(3) &quot;red&quot;
  }
  [&quot;pear&quot;]=&gt;
  array(2) {
    [0]=&gt;
    string(5) &quot;green&quot;
    [1]=&gt;
    string(6) &quot;yellow&quot;
  }
  [&quot;watermelon&quot;]=&gt;
  array(1) {
    [0]=&gt;
    string(5) &quot;green&quot;
  }
}

</pre></div>
    </div>
   </div>
   <div class="example" id="example-978"><p><strong>Example #4 每行结果实例化一个类</strong></p>
    <div class="example-contents"><p>
     下面列子演示了 <strong><code>PDO::FETCH_CLASS</code></strong> 获取风格的行为。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">fruit&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$colour</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;name,&nbsp;colour&nbsp;FROM&nbsp;fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_CLASS</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [0]=&gt;
  object(fruit)#1 (2) {
    [&quot;name&quot;]=&gt;
    string(5) &quot;apple&quot;
    [&quot;colour&quot;]=&gt;
    string(5) &quot;green&quot;
  }
  [1]=&gt;
  object(fruit)#2 (2) {
    [&quot;name&quot;]=&gt;
    string(4) &quot;pear&quot;
    [&quot;colour&quot;]=&gt;
    string(6) &quot;yellow&quot;
  }
  [2]=&gt;
  object(fruit)#3 (2) {
    [&quot;name&quot;]=&gt;
    string(10) &quot;watermelon&quot;
    [&quot;colour&quot;]=&gt;
    string(4) &quot;pink&quot;
  }
}
</pre></div>
    </div>
   </div>
   <div class="example" id="example-979"><p><strong>Example #5  每行调用一次函数</strong></p>
    <div class="example-contents"><p>
     下面列子演示了 <strong><code>PDO::FETCH_FUNC</code></strong> 获取风格的行为。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">fruit</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$colour</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #007700">{</span><span style="color: #0000BB">$name</span><span style="color: #007700">}</span><span style="color: #DD0000">:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$colour</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;name,&nbsp;colour&nbsp;FROM&nbsp;fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_FUNC</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fruit"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [0]=&gt;
  string(12) &quot;apple: green&quot;
  [1]=&gt;
  string(12) &quot;pear: yellow&quot;
  [2]=&gt;
  string(16) &quot;watermelon: pink&quot;
}
</pre></div>
    </div>
   </div>

  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-pdostatement.fetchall-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="pdo.query.html" class="function" rel="rdfs-seeAlso">PDO::query()</a> - Executes an SQL statement, returning a result set as a PDOStatement object</span></li>
    <li class="member"><span class="function"><a href="pdostatement.fetch.html" class="function" rel="rdfs-seeAlso">PDOStatement::fetch()</a> - 从结果集中获取下一行</span></li>
    <li class="member"><span class="function"><a href="pdostatement.fetchcolumn.html" class="function" rel="rdfs-seeAlso">PDOStatement::fetchColumn()</a> - 从结果集中的下一行返回单独的一列。</span></li>
    <li class="member"><span class="function"><a href="pdo.prepare.html" class="function" rel="rdfs-seeAlso">PDO::prepare()</a> - Prepares a statement for execution and returns a statement object</span></li>
    <li class="member"><span class="function"><a href="pdostatement.setfetchmode.html" class="function" rel="rdfs-seeAlso">PDOStatement::setFetchMode()</a> - 为语句设置默认的获取模式。</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116347""></a>
  <div class="note">
   <strong class="user">dyukemedia at gmail dot com</strong>
   <a href="#116347" class="date">16-Dec-2014 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Getting foreach to play nicely with some data from PDO FetchAll()<br />
I was not understanding to use the $value part of the foreach properly, I hope this helps someone else.<br />
Example:<br />
<span class="default">&lt;?php <br />
$stmt </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT title, FMarticle_id FROM articles WHERE domain_name =:domain_name'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">bindValue</span><span class="keyword">(</span><span class="string">':domain_name'</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$article_list </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>which gives:<br />
<br />
array (size=2)<br />
&nbsp; 0 =&gt; <br />
&nbsp;&nbsp;&nbsp; array (size=2)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'title' =&gt; string 'About Cats Really Long title for the article' (length=44)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'FMarticle_id' =&gt; string '7CAEBB15-6784-3A41-909A-1B6D12667499' (length=36)<br />
&nbsp; 1 =&gt; <br />
&nbsp;&nbsp;&nbsp; array (size=2)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'title' =&gt; string 'another cat story' (length=17)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'FMarticle_id' =&gt; string '0BB86A06-2A79-3145-8A02-ECF6EA5C405C' (length=36)<br />
<br />
Then use:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach (</span><span class="default">$article_list </span><span class="keyword">as </span><span class="default">$row </span><span class="keyword">=&gt; </span><span class="default">$link</span><span class="keyword">) {<br />
&nbsp; echo&nbsp; </span><span class="string">'&lt;a href="'</span><span class="keyword">.&nbsp; </span><span class="default">$link</span><span class="keyword">[</span><span class="string">'FMarticle_id'</span><span class="keyword">].</span><span class="string">'"&gt;' </span><span class="keyword">. </span><span class="default">$link</span><span class="keyword">[</span><span class="string">'title'</span><span class="keyword">]. </span><span class="string">'&lt;/a&gt;&lt;/br&gt;'</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116004""></a>
  <div class="note">
   <strong class="user">janniet at kiekies dot net</strong>
   <a href="#116004" class="date">27-Oct-2014 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to fetch rows as an object for which you have not defined a class, you can do:<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">$q</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_OBJ</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115175""></a>
  <div class="note">
   <strong class="user">fractalesque at gmail dot com</strong>
   <a href="#115175" class="date">10-Jun-2014 01:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
to fetch rows grouped by primary id or any other field you may use FETCH_GROUP with FETCH_UNIQUE:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//prepare and execute a statement returning multiple rows, on a single one<br />
</span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT id,name,role FROM table'</span><span class="keyword">);<br />
</span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_GROUP </span><span class="keyword">| </span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_UNIQUE</span><span class="keyword">));<br />
<br />
</span><span class="comment">//returns an array with the first selected field as key containing associative arrays with the row. This mode takes care not to repeat the key in corresponding grouped array.<br />
<br />
</span><span class="default">$result </span><span class="keyword">= array<br />
&nbsp;(</span><span class="default">1 </span><span class="keyword">=&gt; array<br />
&nbsp;&nbsp; (</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'foo'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'role'</span><span class="keyword">=&gt;</span><span class="string">'sage'</span><span class="keyword">,),<br />
&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; array<br />
&nbsp;&nbsp; (</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'bar'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'role'</span><span class="keyword">=&gt;</span><span class="string">'rage'</span><span class="keyword">,),);<br />
<br />
</span><span class="comment">// 'SELECT name,id,role FROM table' would result in that:<br />
<br />
</span><span class="default">$result </span><span class="keyword">= array<br />
&nbsp;(</span><span class="string">'foo' </span><span class="keyword">=&gt; array<br />
&nbsp;&nbsp; (</span><span class="string">'id'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'role'</span><span class="keyword">=&gt;</span><span class="string">'sage'</span><span class="keyword">,),<br />
&nbsp; </span><span class="string">'bar' </span><span class="keyword">=&gt; array<br />
&nbsp;&nbsp; (</span><span class="string">'id'</span><span class="keyword">=&gt;</span><span class="default">2</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'role'</span><span class="keyword">=&gt;</span><span class="string">'rage'</span><span class="keyword">,),);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115164""></a>
  <div class="note">
   <strong class="user">GyoreG</strong>
   <a href="#115164" class="date">06-Jun-2014 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you would like to get the result as "key-value-pairs", like:<br />
<br />
Array(<br />
&nbsp;&nbsp;&nbsp; [key1] =&gt; "value1"<br />
&nbsp;&nbsp;&nbsp; [key2] =&gt; "value2"<br />
)<br />
<br />
then you can do it by calling fetchAll with PDO::FETCH_GROUP | PDO::FETCH_COLUMN parameters. <br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $result </span><span class="keyword">= </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_GROUP</span><span class="keyword">|</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_COLUMN</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114253""></a>
  <div class="note">
   <strong class="user">michael dot arnauts at gmail dot com</strong>
   <a href="#114253" class="date">30-Jan-2014 12:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use PDO::FETCH_CLASS but don't like that all the values are of the type string, you can always use the __construct function of the class specified to convert them to a different type.<br />
<br />
Another way is using mysqlnd, but it seems I had to recompile PHP for that.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Cdr </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$a</span><span class="keyword">; </span><span class="comment">// int<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$b</span><span class="keyword">; </span><span class="comment">// float<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$c</span><span class="keyword">; </span><span class="comment">// string<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">a </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">a</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">b </span><span class="keyword">= </span><span class="default">floatval</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">b</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; <br />
}<br />
<br />
</span><span class="comment">// ...<br />
</span><span class="default">$arrCdrs </span><span class="keyword">= </span><span class="default">$objSqlStatement</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_CLASS</span><span class="keyword">, </span><span class="string">'Cdr'</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108796""></a>
  <div class="note">
   <strong class="user">ramon at monztro dot com</strong>
   <a href="#108796" class="date">25-May-2012 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to call PDOStatement::fetchAll and is not getting the result set as expected (empty instead), check if you called PDOStatement::execute first.<br />
<br />
Remember PDOStatement::fetchAll does not execute the query, it just mounts the array. <br />
<br />
:)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104740""></a>
  <div class="note">
   <strong class="user">Hayley Watson</strong>
   <a href="#104740" class="date">05-Jul-2011 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use the PDO::FETCH_CLASS | PDO::FETCH_PROPS_LATE flags to map columns to object properties, fetchAll() will use any __set() method your object has when carrying out the mapping.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104609""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#104609" class="date">25-Jun-2011 11:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that fetchAll() can be extremely memory inefficient for large data sets. My memory limit was set to 160 MB this is what happened when I tried:
<br />

<br />
<span class="default">&lt;?php
<br />
$arr </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">();
<br />
</span><span class="comment">// Fatal error: Allowed memory size of 16777216 bytes exhausted
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
If you are going to loop through the output array of fetchAll(), instead use fetch() to minimize memory usage as follows:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">while (</span><span class="default">$arr </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetch</span><span class="keyword">()) {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">memory_get_usage</span><span class="keyword">() / (</span><span class="default">1024</span><span class="keyword">*</span><span class="default">1024</span><span class="keyword">),</span><span class="default">3</span><span class="keyword">) .</span><span class="string">' MB&lt;br /&gt;'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// do_other_stuff();
<br />
</span><span class="keyword">}
<br />
</span><span class="comment">// Last line for the same query shows only 28.973 MB usage
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98359""></a>
  <div class="note">
   <strong class="user">Dennis</strong>
   <a href="#98359" class="date">10-Jun-2010 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Error:<br />
SQLSTATE[HY000]: General error: 2014 Cannot execute queries while other unbuffered queries are active. Consider using PDOStatement::fetchAll(). Alternatively, if your code is only ever going to run against mysql, you may enable query buffering by setting the PDO::MYSQL_ATTR_USE_BUFFERED_QUERY attribute.<br />
<br />
If you're using something like:<br />
<br />
while ($row = $query-&gt;fetchObject()) {<br />
&nbsp;&nbsp;&nbsp; [...]<br />
}<br />
<br />
try using this instead:<br />
<br />
$rows = $query-&gt;fetchAll(PDO::FETCH_CLASS, 'ArrayObject');<br />
<br />
foreach ($rows as $row) {<br />
&nbsp;&nbsp;&nbsp; [...]<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97973""></a>
  <div class="note">
   <strong class="user">esw at pixeloution dot removeme dot com</strong>
   <a href="#97973" class="date">19-May-2010 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Interestingly enough, when you use fetchAll, the constructor for your object is called AFTER the properties are assigned. For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">person </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$name</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">. </span><span class="string">" is my name."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment"># set up select from a database here with PDO<br />
</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">$STH</span><span class="keyword">-&gt;</span><span class="default">fetchALL</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_CLASS</span><span class="keyword">, </span><span class="string">'person'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Will result in ' is my name' being appended to all the name columns. However if you call it slightly differently:<br />
<br />
<span class="default">&lt;?php<br />
$obj </span><span class="keyword">= </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">$STH</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_CLASS </span><span class="keyword">| </span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_PROPS_LATE</span><span class="keyword">, </span><span class="string">'person'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Then the constructor will be called before properties are assigned. I can't find this documented anywhere, so I thought it would be nice to add a note here.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94236""></a>
  <div class="note">
   <strong class="user">mxrgus</strong>
   <a href="#94236" class="date">24-Oct-2009 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In method body:<br />
<br />
return $pstmt-&gt;fetchAll() or die("bad");<br />
<br />
will not return correct value, but "1" instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90692""></a>
  <div class="note">
   <strong class="user">Daniel Hofmann</strong>
   <a href="#90692" class="date">05-May-2009 09:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PLEASE BE AWARE: If you do an OUTER LEFT JOIN and set PDO FetchALL to PDO::FETCH_ASSOC, any primary key you used in the OUTER LEFT JOIN will be set to a blank if there are no records returned in the JOIN.<br />
<br />
For example:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//query the product table and join to the image table and return any images, if we have any, for each product<br />
</span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"SELECT * FROM product, image<br />
LEFT OUTER JOIN image ON (product.product_id = image.product_id)"</span><span class="keyword">;<br />
<br />
</span><span class="default">$array </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The resulting array will look something like this:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [product_id] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [notes] =&gt; "this product..."<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [brand] =&gt; "Best Yet"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ...<br />
<br />
The fix is to simply specify your field names in the SELECT clause instead of using the * as a wild card, or, you can also specify the field in addition to the *. The following example returns the product_id field correctly:<br />
<br />
<span class="default">&lt;?php<br />
$sql </span><span class="keyword">= </span><span class="string">"SELECT *, product.product_id FROM product, image<br />
LEFT OUTER JOIN image ON (product.product_id = image.product_id)"</span><span class="keyword">;<br />
<br />
</span><span class="default">$array </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The resulting array will look something like this:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [product_id] =&gt; 3<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [notes] =&gt; "this product..."<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [brand] =&gt; "Best Yet"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88699""></a>
  <div class="note">
   <strong class="user">Ant P.</strong>
   <a href="#88699" class="date">04-Feb-2009 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You might find yourself wanting to use FETCH_GROUP and FETCH_ASSOC at the same time, to get your table's primary key as the array key:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// $stmt is some query like "SELECT rowid, username, comment"<br />
</span><span class="default">$results </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_GROUP</span><span class="keyword">|</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
<br />
</span><span class="comment">// It does work, but not as you might expect:<br />
</span><span class="default">$results </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1234 </span><span class="keyword">=&gt; array(</span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">'username' </span><span class="keyword">=&gt; </span><span class="string">'abc'</span><span class="keyword">, </span><span class="string">'comment' </span><span class="keyword">=&gt; </span><span class="string">'[...]'</span><span class="keyword">)),<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1235 </span><span class="keyword">=&gt; array(</span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">'username' </span><span class="keyword">=&gt; </span><span class="string">'def'</span><span class="keyword">, </span><span class="string">'comment' </span><span class="keyword">=&gt; </span><span class="string">'[...]'</span><span class="keyword">)),<br />
);<br />
<br />
</span><span class="comment">// ...but you can at least strip the useless numbered array out easily:<br />
</span><span class="default">$results </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'reset'</span><span class="keyword">, </span><span class="default">$results</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86769""></a>
  <div class="note">
   <strong class="user">davey at php dot net</strong>
   <a href="#86769" class="date">03-Nov-2008 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When passing PDO::FETCH_CLASS as the first argument, this method will accept the class name as the second option:<br />
<br />
<span class="default">&lt;?php<br />
$query </span><span class="keyword">= </span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />
<br />
if (</span><span class="default">$result </span><span class="keyword">&amp;&amp; </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">rowCount</span><span class="keyword">() &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$records </span><span class="keyword">= </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_CLASS</span><span class="keyword">, </span><span class="string">'Some_Class'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// $record is now an array of Some_Class objects<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
- Davey</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86710""></a>
  <div class="note">
   <strong class="user">mrshelly at hotmail dot com</strong>
   <a href="#86710" class="date">31-Oct-2008 04:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP fetchAll Data From SQL Server 2005 <br />
if field's data type is varchar(nvarchar), only fetch 255 chars. but the "text" data type is ok.<br />
<br />
so, notice! to change the 'varchar' or 'nvarchar' (length &gt; 255) to 'text' data type..<br />
<br />
hope to help u.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$user </span><span class="keyword">= </span><span class="string">'sa'</span><span class="keyword">;<br />
</span><span class="default">$pass </span><span class="keyword">= </span><span class="string">'pass'</span><span class="keyword">;<br />
<br />
</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'mssql:host=127.0.0.1; dbname=tempdb;'</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">);<br />
<br />
</span><span class="default">$mainSQL </span><span class="keyword">= </span><span class="string">"SELECT field_varchar, field_text FROM table1"</span><span class="keyword">;<br />
</span><span class="default">$sth </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$mainSQL</span><span class="keyword">);<br />
</span><span class="default">$sth</span><span class="keyword">-&gt;</span><span class="default">setFetchMode</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
</span><span class="default">$sth</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
</span><span class="default">$retRows </span><span class="keyword">= </span><span class="default">$sth</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">();<br />
</span><span class="comment">// the field_varchar field only to fetch 255 chars(max)<br />
// the field_text is ok.<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$retRows</span><span class="keyword">);<br />
<br />
unset(</span><span class="default">$sth</span><span class="keyword">); unset(</span><span class="default">$conn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83750""></a>
  <div class="note">
   <strong class="user">harlequin2 at gmx dot de</strong>
   <a href="#83750" class="date">10-Jun-2008 02:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is also another fetch mode supported on Oracle and MSSQL: <br />
PDO::FETCH_ASSOC<br />
<br />
&gt; fetches only column names and omits the numeric index.<br />
<br />
If you would like to return all columns from an sql statement with column keys as table headers, it's as simple as this:<br />
<br />
<span class="default">&lt;?php<br />
$dbh </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">"DS"</span><span class="keyword">, </span><span class="string">"USERNAME"</span><span class="keyword">, </span><span class="string">"PASSWORD"</span><span class="keyword">);<br />
</span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$dbh</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"SELECT * FROM tablename"</span><span class="keyword">);<br />
</span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
</span><span class="default">$arrValues </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_ASSOC</span><span class="keyword">);<br />
</span><span class="comment">// open the table<br />
</span><span class="keyword">print </span><span class="string">"&lt;table wdith=\"100%\"&gt;\n"</span><span class="keyword">;<br />
print </span><span class="string">"&lt;tr&gt;\n"</span><span class="keyword">;<br />
</span><span class="comment">// add the table headers<br />
</span><span class="keyword">foreach (</span><span class="default">$arrValues</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$useless</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;th&gt;</span><span class="default">$key</span><span class="string">&lt;/th&gt;"</span><span class="keyword">;<br />
}<br />
print </span><span class="string">"&lt;/tr&gt;"</span><span class="keyword">;<br />
</span><span class="comment">// display data<br />
</span><span class="keyword">foreach (</span><span class="default">$arrValues </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$row </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"&lt;td&gt;</span><span class="default">$val</span><span class="string">&lt;/td&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;/tr&gt;\n"</span><span class="keyword">;<br />
}<br />
</span><span class="comment">// close the table<br />
</span><span class="keyword">print </span><span class="string">"&lt;/table&gt;\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80164""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#80164" class="date">02-Jan-2008 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If no rows have been returned, fetchAll returns an empty array.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70480""></a>
  <div class="note">
   <strong class="user">stas at metalinfo dot ru</strong>
   <a href="#70480" class="date">18-Oct-2006 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note, that you can use PDO::FETCH_COLUMN|PDO::FETCH_GROUP pair only while selecting two columns, not like DB_common::getAssoc(), when grouping is set to true.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
