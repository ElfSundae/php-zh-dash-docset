<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mongo.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="mongo.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mongo.setup.html">安装／配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mongo.installation" class="section">
 <h2 class="title">安装</h2>
 <p class="para">
  MongoDB的PHP驱动程序可以工作在几乎任何系统上：Windows、Mac OS X、Unix和Linux；大众和罕见的机器；32位和64位的机器；PHP 5.1、5.2和5.3。
 </p>
 <p class="para">
  此 <a href="http://pecl.php.net/" class="link external" title="Link : http://pecl.php.net/">&raquo;&nbsp;PECL</a> 扩展未与
PHP 捆绑。 这个页面包含了安装在不同系统上的更多具体信息，以及用户遇上的问题和疑难解答。
 </p>

 <ul class="itemizedlist">
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.nix" class="link external">&raquo;&nbsp;在*NIX上安装</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.manual" class="link external">&raquo;&nbsp;普通安装</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.osx" class="link external">&raquo;&nbsp;OS X</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.gentoo" class="link external">&raquo;&nbsp;Gentoo</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.fedora" class="link external">&raquo;&nbsp;Fedora</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.windows" class="link external">&raquo;&nbsp;在Windows上安装</a>
   </p>
  </li>
  <li class="listitem">
   <p class="para">
    <a href="#mongo.installation.thirdparty" class="link external">&raquo;&nbsp;第三方安装说明s</a>
   </p>
  </li>
 </ul>

 <div class="section" id="mongo.installation.nix">
  <h2 class="title">在*NIX上安装</h2>

  <p class="para">
   执行:
   <div class="example-contents">
<div class="cdata"><pre>

$ sudo pecl install mongo

</pre></div>
   </div>

  </p>

  <p class="para">
   如果你使用 CentOS 或者 Redhat, 可以使用 Csoke Arpad 创建的
   <a href="http://downloads-distro.mongodb.org/repo/redhat/os/" class="link external" title="Link : http://downloads-distro.mongodb.org/repo/redhat/os/">&raquo;&nbsp;这些发行版的 RPM</a>。
  </p>

  <p class="para">
   将以下行添加到 php.ini:
   <div class="example-contents">
<div class="cdata"><pre>

extension=mongo.so

</pre></div>
   </div>

  </p>

  <p class="para">
   如果 pecl 运行时超出了内存限制，请确认在 php.ini 中的 memory_limit 设置不小于 32MB。
  </p>
 </div>

 <div class="section" id="mongo.installation.manual">
  <h2 class="title">普通安装</h2>

  <p class="para">驱动开发人员和对最新 bug 修复感兴趣的人，可以从 <a href="http://github.com/mongodb/mongo-php-driver" class="link external" title="Link : http://github.com/mongodb/mongo-php-driver">&raquo;&nbsp;Github</a> 上获取最新源码来编译驱动。
   前往 Github 并点击 &quot;download&quot; 按钮。然后运行：

   <div class="example-contents">
<div class="cdata"><pre>

$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;
$ phpize
$ ./configure
$ sudo make install

</pre></div>
   </div>

  </p>

  <p class="para">
   并按以下说明修改 php.ini：
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     确保 <em class="emphasis">extension_dir</em> 变量指向了 <em class="emphasis">mongo.so</em> 的位置。
     编译时会显示安装 PHP 驱动的位置，输出看上去就比如：
     <div class="example-contents">
<div class="cdata"><pre>

      Installing &#039;/usr/lib/php/extensions/no-debug-zts-20060613/mongo.so&#039;

</pre></div>
     </div>


      确保和运行的 PHP 是同一个扩展目录：

     <div class="example-contents">
<div class="cdata"><pre>

      $ php -i | grep extension_dir
        extension_dir =&gt; /usr/lib/php/extensions/no-debug-zts-20060613 =&gt;
      /usr/lib/php/extensions/no-debug-zts-20060613  

</pre></div>
     </div>


    如果不一致，则需要修改 php.ini 里的 <em class="emphasis">extension_dir</em>，或者把 <em class="emphasis">mongo.so</em> 移过去。
    </p>
   </li>
   <li class="listitem">
    <p class="para">要在 PHP 启动的时候加载这个扩展，添加一行：

     <div class="example-contents">
<div class="cdata"><pre>

      extension=mongo.so

</pre></div>
     </div>


    </p>
   </li>
  </ul>

  <div class="section" id="mongo.installation.osx">
   <h2 class="title">OS X</h2>

   <p class="para">
    如果你的系统无法找到 autoconf，你需要安装 Xcode（在你的安装DVD里，或者在苹果网站上免费下载）。
   </p>
   
   <p class="para">
    如果你在使用 XAMPP，你也许可以通过以下指令编译驱动：
    <div class="example-contents">
<div class="cdata"><pre>

sudo /Applications/XAMPP/xamppfiles/bin/pecl install mongo

</pre></div>
    </div>

   </p>

   <p class="para">
    如果你正在使用 MAMP（或者是 XAMPP，并且上面的命令没起作用），已经编译好的二进制文件可以从
    <a href="https://s3.amazonaws.com/drivers.mongodb.org/php/index.html" class="link external" title="Link : https://s3.amazonaws.com/drivers.mongodb.org/php/index.html">&raquo;&nbsp;Github</a>
    下载（下载名称含有「osx」、匹配你 PHP 版本的那个）。从压缩包中解压 mongo.so 并添加它到 MAMP 或 XAMPP的扩展目录。
    添加 
    <div class="example-contents">
<div class="cdata"><pre>

      extension=mongo.so

</pre></div>
    </div>

    到使用的 php.ini 文件并重启服务。
   </p>
  </div>

  <div class="section" id="mongo.installation.gentoo">
   <h2 class="title">Gentoo</h2>
   <p class="para">
    Gentoo 有一个 PHP 驱动的包，叫做 dev-php5/mongo，可以通过以下命令安装：
   </p>
   <div class="example-contents">
<div class="cdata"><pre>

$ sudo emerge -va dev-php5/mongo

</pre></div>
   </div>


   <p class="para">如果你使用了 PECL，你可能得到 libtool 版本不正确的错误。
    从源码编译，你需要运行 aclocal 和 autoconf。
   </p>
   <div class="example-contents">
<div class="cdata"><pre>

$ phpize &amp;&amp; aclocal &amp;&amp; autoconf &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install

</pre></div>
   </div>

  </div>
  <div class="section" id="mongo.installation.fedora">
   <h2 class="title">Red Hat</h2>
   <p class="para">
    这包含了 Fedora 和 CentOS。
   </p>
   <p class="para">
    这些系统上默认的 Apache 设置禁止请求产生网络连接，意味着当连接到数据库，驱动会得到一个 &quot;Permission denied&quot;
    错误。当你遇上这个问题，可以试试运行：
    <div class="example-contents">
<div class="cdata"><pre>
$ /usr/sbin/setsebool -P httpd_can_network_connect 1 
</pre></div>
    </div>

    然后重启 Apache。（在 SELinux 下也会产生这个问题。）
   </p>
  </div>
 </div>

 <div class="section" id="mongo.installation.windows">
  <h2 class="title">在 Windows 上安装</h2>

  <p class="para">
   已编译好的每个版本的二进制文件可以从 <a href="https://s3.amazonaws.com/drivers.mongodb.org/php/index.html" class="link external" title="Link : https://s3.amazonaws.com/drivers.mongodb.org/php/index.html">&raquo;&nbsp;Github</a> 上获取到，包括了不同版本、线程安全、 VC 库。
   解压并把 php_mongo.dll 放到你的 PHP 扩展目录（默认是 &quot;ext&quot;）。
  </p>

  <p class="para">
   最新的（非发布的）代码会在每次提交的时候编译成 Windows 二进制文件。Zip 包含有 php_mongo.dll 和 一个 version.txt。
   请保留你的 version.txt，这样当你遇上问题时，你可以告诉开发人员你所使用的版本。（数字很长并且看上去无意义的，但是对开发人员是有意义的！）
  </p>
  <p class="para">
   获取最新的漏洞修复（以及可能的漏洞），下载对应你安装的 PHP 版本的二进制文件：
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.2vc6.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.2vc6.zip">&raquo;&nbsp;
      PHP 5.2 VC6 非线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.2vc6ts.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.2vc6ts.zip">&raquo;&nbsp;
      PHP 5.2 VC6 线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc6.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc6.zip">&raquo;&nbsp;
      PHP 5.3 VC6 非线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc6ts.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc6ts.zip">&raquo;&nbsp;
      PHP 5.3 VC6 线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc8.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc8.zip">&raquo;&nbsp;
      PHP 5.3 VC8 非线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc8ts.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc8ts.zip">&raquo;&nbsp;
      PHP 5.3 VC8 线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc9.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc9.zip">&raquo;&nbsp;
      PHP 5.3 VC9 非线程安全 Mongo 扩展
     </a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="http://downloads.mongodb.org/mongo-latest-php5.3vc9ts.zip" class="link external" title="Link : http://downloads.mongodb.org/mongo-latest-php5.3vc9ts.zip">&raquo;&nbsp;
      PHP 5.3 VC9 线程安全 Mongo 扩展
     </a>
    </p>
   </li>
  </ul>

  <p class="para">
   并添加下面这行到你的 php.ini 文件：
   <div class="example-contents">
<div class="cdata"><pre>

extension=php_mongo.dll

</pre></div>
   </div>

  </p>
 </div>

 <div class="section" id="mongo.installation.thirdparty">
  <h2 class="title">第三方安装说明</h2>
  
  <p class="para">
   很多人创建了安装 PHP 驱动的极好教程。
  </p>

    <ul class="itemizedlist">
     <li class="listitem">
         <p class="para">
             <a href="http://justinhileman.info/article/reinstalling-php-on-mac-os-x/" class="link external" title="Link : http://justinhileman.info/article/reinstalling-php-on-mac-os-x/">&raquo;&nbsp;
                 (Re)installing PHP on Mac OS X
             </a>
         </p>
         <p class="para">
             This article by Justin Hileman details the process of installing PHP and
             additional extensions with Homebrew on OS X. This complements the earlier
             instructions on this page for installing the driver with Homebrew.
         </p>
     </li>
     <li class="listitem">
         <p class="para">
             <a href="http://www.vimeo.com/8005503" class="link external" title="Link : http://www.vimeo.com/8005503">&raquo;&nbsp;
                 PHP 5.3.1 with Xdebug, MongoDB and Lithium on Ubuntu 9.10 / Apache 2.2
             </a>
         </p>
         <p class="para">This screencast by Jon Adams demonstrates how to quickly get up and
             running with PHP 5.3.1, Xdebug, and MongoDB on Ubuntu 9.10 with Apache.
         </p>
     </li>
    </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116471""></a>
  <div class="note">
   <strong class="user">brick</strong>
   <a href="#116471" class="date">08-Jan-2015 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Apache 2.4.10 win32 from apachelounge with php 5.6.4 VC11 x86 Thread Safe on windows7 sp1.<br />
The 5.6 Thread Safe (TS) x86 mongo.dll i downloaded from <a href="http://pecl.php.net/package/mongo/1.5.8/windows " rel="nofollow" target="_blank">http://pecl.php.net/package/mongo/1.5.8/windows </a><br />
I kept getting the following error<br />
PHP Startup: Unable to load dynamic library mongo.dll<br />
The specified module could not be found. <br />
I fixed this by adding the php and the php/ext to the windows path and rebooting(log off didn't cut it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113674""></a>
  <div class="note">
   <strong class="user">Daniel</strong>
   <a href="#113674" class="date">14-Nov-2013 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This may help also:<br />
<br />
<a href="http://blog.salientdigital.com/2012/05/16/how-to-fix-no-acceptable-c-compiler-found-in-path-on-mac-os-x-lion/" rel="nofollow" target="_blank">http://blog.salientdigital.com/2012/05/16/how-to-fix-no-acceptable-c-compiler-found-in-path-on-mac-os-x-lion/</a><br />
<br />
Xcode doesn't ship with "Command Line Tools", you need to install then after installing Xcode.<br />
<br />
You need Command Line Tools to get the program `m4` that you need to install mongo driver using: sudo pecl install mongo.<br />
<br />
HTH</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112022""></a>
  <div class="note">
   <strong class="user">bradley dot henke at colorado dot edu</strong>
   <a href="#112022" class="date">23-Apr-2013 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instructions for Manually Installing MongoDB for PHP for use with "XAMPP for Linux":<br />
<br />
There were two gotchas that I ran into. "XAMPP for Linux" needs 32 bit libraries, and the php API version must match the php API version of "XAMPP for Linux".<br />
Hopefully this will save someone else time figuring this all out!<br />
<br />
1) Install "XAMPP for Linux" AND the "XAMPP for Linux Development Files".<br />
<br />
2) Grab the source code from github (in the manual instructions above)<br />
$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz<br />
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;<br />
<br />
There are now some smalls deviation from the manual instructions...<br />
3) PHPize<br />
$ sudo /opt/lampp/bin/phpize<br />
<br />
4) Configure<br />
$ ./configure<br />
<br />
5) Make changes to the Makefile (XAMPP requires a 32-bit compilation)<br />
- Choose your favorite text editor and open "Makefile"<br />
- Make the following changes:<br />
Line 20: prefix = /opt/lampp<br />
Line 23: prefix = /opt/lampp<br />
Line 25: phpincludedir = /opt/lampp/include/php<br />
Line 27: CFLAGS = -g -O2 -m32<br />
Line 34: EXTENSION_DIR = /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
Line 35: PHP_EXECUTABLE = /opt/lampp/bin/php<br />
<br />
Make sure you replace &lt;/path/to/mongo-php-driver-master&gt;<br />
Line 38: INCLUDES = -I/opt/lampp/include/php -I/opt/lampp/include/php/main -I/opt/lampp/include/php/TSRM -I/opt/lampp/include/php/Zend -I/opt/lampp/include/php/ext -I/opt/lampp/include/php/ext/date/lib -I&lt;/path/to/mongo-php-driver-master&gt;/util -I&lt;/path/to/mongo-php-driver-master&gt;/exceptions -I&lt;/path/to/mongo-php-driver-master&gt;/gridfs -I&lt;/path/to/mongo-php-driver-master&gt;/types -I&lt;/path/to/mongo-php-driver-master&gt;/mcon<br />
<br />
6) Compile<br />
$ sudo make all<br />
<br />
7) Copy the static object into the extension directory<br />
$ sudo cp modules/mongo.so /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
<br />
9) Update your php.ini file<br />
- Grab you favorite text editor and open /opt/lampp/etc/php.ini (you'll probably need to use sudo).<br />
- Add the line: extension=mongo.so<br />
<br />
10) Restart "XAMPP for Linux". You should now be able to see Mongo listed in your phpinfo() page! Installation Complete!!!<br />
<br />
Good Luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111083""></a>
  <div class="note">
   <strong class="user">Hanakaze</strong>
   <a href="#111083" class="date">13-Jan-2013 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To install the Mongo driver on Windows 7 x64 with EasyPHP, you have to use the x86 driver (instead of x64) and non nts :<br />
php_mongo-1.3.2RC1-5.4-vc9.dll actually</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105302""></a>
  <div class="note">
   <strong class="user">tiago dot braga at gmail dot com</strong>
   <a href="#105302" class="date">08-Aug-2011 06:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Windows running IIS the directory to instal is "C:\Program Files\PHP\ext". Than you have to install the apropriate MongoDriver version (in my case was mongo-1.1.4-php5.3vc9) and than Restart IIS.<br />
<br />
The MongoDB Driver will be available.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104629""></a>
  <div class="note">
   <strong class="user">rishi at plavaga dot in</strong>
   <a href="#104629" class="date">27-Jun-2011 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using XAMPP 1.7.4 (32 bit) on Windows 7. Though it was mentioned that Apache uses a non-threadsafe version of DLL, when used, it was giving me the below error:
<br />

<br />
PHP Warning:&nbsp; PHP Startup: Unable to load dynamic library 
<br />
Warning:&nbsp; PHP Startup: Unable to load dynamic library 'D:\xampp\php\ext\php_mongo.dll' - The specified module could not be found.
<br />

<br />
I had to use the thread-safe version (mongo-1.1.4.zip\mongo-1.1.4-php5.3vc6ts\php_mongo.dll) to get it working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104223""></a>
  <div class="note">
   <strong class="user">Andrey</strong>
   <a href="#104223" class="date">02-Jun-2011 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On windows installation check for VC compilator version inside phpinfo(), if you install incorrect one it wouldn't work.<br />
I tried to run on Apache2 with VC6, and always get folowing error:<br />
<br />
Fatal error: Class 'Mongo' not found<br />
<br />
Until I look into phpinfo and found MSVC9, after that<br />
I install VC9 dll files and it solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100606""></a>
  <div class="note">
   <strong class="user">poorpuer at gmail dot com</strong>
   <a href="#100606" class="date">26-Oct-2010 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're running IIS under Windows 7 and have PHP manager installed you'll also need to manually enable the extension. Start IIS Manager, select PHP Manager, under the section labeled PHP Extensions click on Enable or disable an extension, then enable the php_mongo.dll extension, and restart IIS.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96435""></a>
  <div class="note">
   <strong class="user">cap at unagon dot com</strong>
   <a href="#96435" class="date">26-Feb-2010 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Debian users: apt-get install php5-dev will install phpize for you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
