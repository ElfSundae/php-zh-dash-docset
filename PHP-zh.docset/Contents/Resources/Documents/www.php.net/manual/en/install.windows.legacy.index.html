<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>旧版本 Windows 支持</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.windows.troubleshooting.html">? Windows 下 PHP 故障排除</a></li>
      <li style="float: right;"><a href="install.cloud.html">云计算平台上的安装 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.windows.html">Windows 系统下的安装</a></li>
    <li>旧版本 Windows 支持</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.windows.legacy.index" class="sect1">
    <h2 class="title">旧版本 Windows 支持</h2>
   <p class="para">
    本节适用于 Windows 98/Me 和 Windows NT/2000/XP/2003。PHP
    不能在 16 位平台上工作，如 Windows 3.1，有时我们将支持的
    Windows 平台为 Win32。
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
      从 PHP 5.5.0 开始不再支持 Windows XP/2003。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
      从 PHP 5.3.0 开始，不再支持 Windows 98/Me/NT4/2000。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
      从 PHP 4.3.0 开始不再支持 Windows 95。
    </p>
   </p></blockquote>
   <p class="para">
    如果你有微软 Visual Studio 这样的开发环境，你也可以从原始源码中构建 PHP。
    
   </p>
   <p class="para">
    在 Windows 系统上安装 PHP 后，如果还想加载各种扩展来增加功能，请参考
    <a href="install.windows.legacy.index.html#install.windows.legacy.extensions" class="link">这里</a>。
   </p>
   
   



<div class="sect2" id="install.windows.legacy.manual">
 <h3 class="title">手工安装步骤</h3>
 <p class="para">
  本章包含有在 Microsoft Windows 中手工安装和配置 PHP
  的指示。
 </p>
 <div class="sect3" id="install.windows.legacy.manual.download">
  <h4 class="title">选择和下载 PHP 发行包</h4>
  <p class="para">
   从 <a href="https://windows.php.net/download/" class="link external" title="Link : https://windows.php.net/download/">&raquo;&nbsp;PHP for Windows: Binaries and Sources</a>
   页面下载 PHP 的 zip 二进制发行包。有几个不同版本，根据所用 web 服务器选择合适的版本：
      参见 <a href="https://windows.php.net/download/" class="link external" title="Link : https://windows.php.net/download/">&raquo;&nbsp;下载页</a> 中的指南。
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.manual.package">
  <h4 class="title">PHP 压缩包的结构和内容</h4>
  <p class="para">
   将 zip 包解压缩到自己选择的目录，例如 C:\PHP\。此目录和文件结构类似于：
   <div class="example" id="install.unix.nginx.restart.nginx">
    <p><strong>Example #1 PHP 5 压缩包的结构</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>

c:\php
   |
   +--dev
   |  |
   |  |-php5ts.lib                 -- php5.lib 的非线程安全版本
   |
   +--ext                          -- PHP 扩展库的 DLL 文件目录
   |  |
   |  |-php_bz2.dll
   |  |
   |  |-php_cpdf.dll
   |  |
   |  |-...
   |
   +--extras                       -- 空 
   |
   +--pear                         -- PEAR 的初始版本
   |
   |
   |-go-pear.bat                   -- PEAR 安装脚本
   |
   |-...
   |
   |-php-cgi.exe                   -- CGI 可执行文件
   |
   |-php-win.exe                   -- 无窗口执行脚本的可执行文件
   |
   |-php.exe                       -- PHP 命令行可执行文件（CLI）
   |
   |-...
   |
   |-php.ini-development           -- 默认的 php.ini 设置
   |
   |-php.ini-production            -- 推荐的 php.ini 设置
   |
   |-php5apache2_2.dll             -- 非线程安全版本中无此文件
   |
   |-php5apache2_2_filter.dll      -- 非线程安全版本中无此文件
   |
   |-...
   |
   |-php5ts.dll                    -- PHP 核心 DLL（php5.dll 的非线程安全版本）
   | 
   |-...

</pre></div>
    </div>

   </div>
  </p>
  <p class="para">
   以下是 PHP zip 包中包含的模块和可执行文件列表：
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <var class="filename">go-pear.bat</var> - PEAR
      安装脚本。更多内容参见<a href="https://pear.php.net/manual/en/installation.php" class="link external" title="Link : https://pear.php.net/manual/en/installation.php">&raquo;&nbsp;安装 PEAR</a>。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="filename">php-cgi.exe</var> - CGI 可执行文件，可用于 IIS 上以 CGI 或者 FastCGI 方式运行 PHP。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="filename">php-win.exe</var> - PHP 可执行文件，可运行 PHP 脚本而不打开命令行窗口（例如使用
      Windows 图形界面的 PHP 程序）。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="filename">php.exe</var> - PHP 可执行文件，用于命令行界面运行 PHP 脚本（CLI）。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="filename">php5apache2_2.dll</var> - Apache 2.2.X 模块。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="filename">php5apache2_2_filter.dll</var> - Apache 2.2.X 过滤器。
     </p>
    </li>
   </ul>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.manual.phpini">
  <h4 class="title">修改 <var class="filename">php.ini</var> 文件</h4>
  <p class="para">
   解压缩 PHP 的包之后，将 <var class="filename">php.ini-production</var> 拷贝为
   同一目录下的 <var class="filename">php.ini</var>。如有必要，也可以将
   <var class="filename">php.ini</var> 放到其它地方，但是需要更多配置步骤，具体见<a href="configuration.file.html" class="link">配置文件</a>。
  </p>
  <p class="para">
   <var class="filename">php.ini</var> 文件决定 PHP 如何配置自身以及如何在其工作环境下运行。以下
   <var class="filename">php.ini</var> 文件中的配置指令有助于使 PHP 更好地运行于 Windows
   之中。有一些是可选项。还有很多其它指令也可能与用户环境有关，更多信息见
   <a href="ini.list.html" class="link">php.ini 配置选项列表</a>。
  </p>
  <p class="para">
   必须的指令：
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <var class="varname">extension_dir</var> = <code class="literal">&lt;指向扩展库目录的路径&gt;</code> -
      <var class="varname">extension_dir</var> 需要指向存放 PHP
      扩展库文件的目录。可以是绝对路径（如 &quot;C:\PHP\ext&quot;）或相对路径（如
      &quot;.\ext&quot;）。在 <var class="filename">php.ini</var> 文件中要加载的扩展库都必须在
      <var class="varname">extension_dir</var> 所指定的目录之中。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">extension</var> = <code class="literal">xxxxx.dll</code> -
      对每个需要激活的扩展，都需要一行相应的 &quot;extension=&quot; 语句来说明
      PHP 启动时加载 <var class="varname">extension_dir</var> 目录下的哪些扩展。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">log_errors</var> = <code class="literal">On</code> - 
      PHP 有错误日志的功能可以将错误报告发送到一个文件中，或者系统服务中（例如系统日志），与下面的
      <var class="varname">error_log</var> 指令配合工作。在 IIS 下运行时，<var class="varname">log_errors</var>
      应被激活，并且配合有效的 <var class="varname">error_log</var>。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">error_log</var> = <code class="literal">&lt;指向错误日志文件的路径&gt;</code> - 
      error_log 需要指向一个具有绝对或相对路径的文件名用于记录 PHP
      的错误日志。Web 服务器需要对此文件有可写权限。最常用的位置是各种临时目录，例如
      &quot;C:\inetpub\temp\php-errors.log&quot;。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">cgi.force_redirect</var> = <code class="literal">0</code> - 
      在 IIS 下运行时需要关闭此项指令。这是个在许多其它 web 服务器中都需要激活的目录安全功能，但是在
      IIS 下如果激活则会导致 PHP 引擎在 Windows 中出错。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">cgi.fix_pathinfo</var> = <code class="literal">1</code> - 
      此指令可以允许 PHP 遵从 CGI 规则访问真实路径信息。IIS 的 FastCGI 实现需要激活此指令。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">fastcgi.impersonate</var> = <code class="literal">1</code> - 
      IIS 下的 FastCGI 支持模拟呼叫用户方安全令牌的能力。这使得 IIS 可以定义请求方的安全上下文。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">fastcgi.logging</var> = <code class="literal">0</code> - 
      FastCGI 日志在 IIS 下应被关闭。如果激活，则任何类的任何消息都被 FastCGI
      视为错误条件从而导致 IIS 产生 HTTP 500 错误。
     </p>
    </li>
   </ul>
  </p>
  <p class="para">
   可选指令：
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <var class="varname">max_execution_time</var> = <code class="literal">##</code> - 
      此指令设定任何脚本所能够运行的最长时间。默认值是 30 秒。如果
      PHP 程序需要更多时间运行则增大此值。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">memory_limit</var> = <code class="literal">###M</code> - 
      PHP 进程能够占用的内存，单位为兆字节。默认值是 128M，对大多数程序都够用了。某些复杂程序可能需要更多。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">display_errors</var> = <code class="literal">Off</code> - 
      此指令设定 PHP 是否将任何错误信息包含在返回给 web
      服务器的数据流中。如果设定为 &quot;On&quot;，则 PHP
      将任何由 <var class="varname">error_reporting</var> 指令所定义的错误信息作为错误数据流发给
      web 服务器。为安全起见，建议对在线服务器设为 &quot;Off&quot;
      以避免泄露任何可能包含在错误消息中的安全敏感信息。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">open_basedir</var> = <code class="literal">&lt;指向目录的路径，由分号分隔&gt;</code> -
      例如
      openbasedir=&quot;C:\inetpub\wwwroot;C:\inetpub\temp&quot;。此指令指定了允许
      PHP 进行文件系统操作的目录。任何对这些目录之外的文件操作都会导致错误。此指令在共享主机环境中特别有用，可以阻止
      PHP 脚本访问任何其网站根目录之外的文件。
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <var class="varname">upload_max_filesize</var> = <code class="literal">###M</code> 和
      <var class="varname">post_max_size</var> = <code class="literal">###M</code> -
      分别是上传文件的最大大小和 POST 方法提交数据的最大大小。如果 PHP
      程序需要上传大型数据例如照片和视频文件，则应提高这两项的值。
     </p>
    </li>
   </ul>
  </p>
  <p class="para">
   至此已在系统中安装了 PHP。下一步是选择一种 web 服务器并且使其能够运行
   PHP。在目录中选择 web 服务器。
  </p>
  <p class="para">
   除了可在 web 服务器中运行 PHP 之外，PHP 还可以在命令行运行，如同
   <code class="literal">.BAT</code> 批处理脚本一样。详见
   <a href="install.windows.legacy.index.html#install.windows.legacy.commandline" class="link">Windows
    下的 PHP 命令行方式</a>。
  </p>
 </div>
</div>



   




<div class="sect2" id="install.windows.legacy.iis">
 <h3 class="title">Microsoft IIS</h3>
 <p class="para">
  本部分将具体指导如何在微软 Internet 信息服务（IIS）上安装 PHP。
 </p>
 <ul class="itemizedlist">
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.legacy.index.html#install.windows.legacy.iis6" class="link">在 IIS 5.1 和 IIS 6.0 上手工安装 PHP</a>
   </span>
  </li>
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.legacy.index.html#install.windows.legacy.iis7" class="link">在 IIS 7.0 及更高版本上手工安装 PHP</a>
   </span>
  </li>
 </ul>
</div>



   




<div class="sect2" id="install.windows.legacy.iis6">
 <h3 class="title">Microsoft IIS 5.1 和 IIS 6.0</h3>
 <p class="para">
  本章包含有在 Windows XP 和 Windows Server 2003 下的
  Internet 信息服务（IIS）5.1 和 IIS 6.0 中安装 PHP 的指南。有关在
  Windows Vista，Windows Server 2008，Windows 7 以及 Windows Server 2008 R2
  下的 IIS 7.0 以及更高版本中安装 PHP 的指南见
  <a href="install.windows.legacy.index.html#install.windows.legacy.iis7" class="link">Microsoft IIS 7.0 及更高版本</a>一章。
 </p>
 <div class="sect3" id="install.windows.legacy.iis6.fastcg">
  <h4 class="title">配置 IIS 以处理 PHP 请求</h4>
  <p class="para">
   根据<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a>的说明下载和安装 PHP。
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     在使用 IIS 时推荐使用非线程安全的 PHP。可以在
     <a href="https://windows.php.net/download/" class="link external" title="Link : https://windows.php.net/download/">&raquo;&nbsp;PHP for Windows: 
      Binaries and Sources Releases</a> 下载。
    </p>
   </p></blockquote>
  </p>
  <p class="para">
   按以下示例在 <var class="filename">php.ini</var> 文件中配置
   针对 CGI- 和 FastCGI- 的指令：
   <div class="example" id="install.unix.nginx.test.nginx.php">
    <p><strong>Example #2 <var class="filename">php.ini</var> 中的 CGI 和 FastCGI 设定</strong></p>
    <div class="example-contents">
<div class="inicode"><pre class="inicode">fastcgi.impersonate = 1
fastcgi.logging = 0
cgi.fix_pathinfo=1
cgi.force_redirect = 0</pre>
</div>
    </div>

   </div>
  </p>
  <p class="para">
   下载并安装 <a href="http://www.iis.net/extensions/fastcgi" class="link external" title="Link : http://www.iis.net/extensions/fastcgi">&raquo;&nbsp;FastCGI for
   IIS</a>。有 32 位和 64 位平台的，根据用户平台选择相应的下载。
  </p>
  <p class="para">
   用以下命令配置 FastCGI 扩展处理 PHP 请求。用指向
   <var class="filename">php-cgi.exe</var> 文件的绝对路径替换其中的 &quot;-path&quot; 的参数。
   <div class="example" id="example-12">
    <p><strong>Example #3 配置 FastCGI 扩展以处理 PHP 请求</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -add -section:&quot;PHP&quot; ^
-extension:php -path:&quot;C:\PHP\php-cgi.exe&quot;
</pre></div>
    </div>

   </div>
  </p>
  <p class="para">
   此命令将创建对应于 *.php 文件后缀的 IIS 脚本映射，则所有以 *.php 结尾的 URL
   都会被 FastCGI 扩展处理。此外还配置了 FastCGI 扩展使用 <var class="filename">php-cgi.exe</var>
   可执行文件来处理 PHP 请求。
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     至此所需的安装和配置步骤就完成了。以下剩余的指示是可选项，但是强烈推荐以使得在
     IIS 上达到最佳的 PHP 功能和性能。
    </p>
   </p></blockquote>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.impersonation">
  <h4 class="title">角色扮演及文件系统访问</h4>
  <p class="para">
   在 IIS 中使用 PHP 建议激活 FastCGI 的角色扮演功能。此功能在 <var class="filename">php.ini</var>
   中由 <var class="varname">fastcgi.impersonate</var> 指令控制。激活角色扮演后，PHP
   将以 IIS 所认证的用户帐号身份进行所有的文件系统操作。这将确保即使在（同一个主机）不同的
   IIS 网站下使用了同一个 PHP 进程，只要每个网站使用了不同的用户帐号作为 IIS
   身份认证，则这些网站的 PHP 脚本将不能访问彼此的文件。
  </p>
  <p class="para">
   例如在 IIS 5.1 和 IIS 6.0 中，默认配置下的匿名认证将使用内置的用户帐号 IUSR_&lt;MACHINE_NAME&gt;
   作为默认身份。这意味着要使得
   IIS 能够运行 PHP 脚本，至少要将这些脚本的读取权限授予 IUSR_&lt;MACHINE_NAME&gt; 帐号。如果 PHP
   程序需要对某些文件或文件夹进行写入操作，那 IUSR_&lt;MACHINE_NAME&gt; 帐号也需要有相对应的写入权限。
  </p>
  <p class="para">
   要查看哪个用户帐号被用作 IIS 匿名认证的身份，使用以下步骤：
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      在 Windows 开始菜单中选择"运行..."，输入"inetmgr"并点击"确定"；
     </p>
    </li>
    <li>
     <p class="simpara">
      在树形视图下展开"网站"节点，右键点击要使用的网站并选择"属性"；
     </p>    
    </li>
    <li>
     <p class="simpara">
      点击"目录安全"面板；
     </p>    
    </li>
    <li>
     <p class="simpara">
      记录下在"认证方式"对话框中的"用户名"字段。
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis6anonauth.png" alt="IIS 5.1 和 IIS 6.0 的匿名认证" width="654" height="461" />
    </div>
   </div>
  </p>
  <p class="para">
   要修改文件及文件夹的权限，使用 Windows 资源管理器或者 <var class="varname">icacls</var> 命令行。
   <div class="example" id="example-13">
    <p><strong>Example #4 配置文件访问权限</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
icacls C:\inetpub\wwwroot\upload /grant IUSR:(OI)(CI)(M)
</pre></div>     
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.defaultdoc">
  <h4 class="title">在 IIS 中把 <var class="filename">index.php</var> 设定为默认文档</h4>
  <p class="para">
   IIS 的默认文档用于没有指定文件名的 HTTP 请求。对于 PHP 应用来说默认文档通常为
   <var class="filename">index.php</var>。要将 <var class="filename">index.php</var>
   添加到 IIS 的默认文档列表中，使用以下步骤：
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      在 Windows 开始菜单中选择"运行..."，输入"inetmgr"并点击"确定"；
     </p>
    </li>
    <li>
     <p class="simpara">
      在树形视图下展开"网站"节点，右键点击要使用的网站并选择"属性"；
     </p>
    </li>
    <li>
     <p class="simpara">
      点击"文档"面板；
     </p>
    </li>
    <li>
     <p class="simpara">
      点击"添加..."按钮并在"默认内容页面"中输入"index.php"。
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis6defaultdoc.png" alt="将 index.php 设为 IIS 的默认文档" width="659" height="465" />
    </div>
   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.recycling">
  <h4 class="title">FastCGI 和 PHP 回收配置</h4>
  <p class="para">
   用以下命令配置 IIS FastCGI 对于 PHP 进程的回收设定。FastCGI 的设置
   <var class="varname">instanceMaxRequests</var> 控制了单一的 <var class="filename">php-cgi.exe</var>
   进程处理多少个请求之后会被 IIS 关闭。PHP 环境变量 <var class="varname">PHP_FCGI_MAX_REQUESTS</var>
   控制了一个 <var class="filename">php-cgi.exe</var>
   进程处理多少个请求之后会被自我回收。要确保 FastCGI 中 <var class="varname">InstanceMaxRequests</var>
   的值小于或等于 <var class="varname">PHP_FCGI_MAX_REQUESTS</var> 的值。
   <div class="example" id="example-14">
    <p><strong>Example #5 配置 FastCGI 和 PHP 的回收</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-InstanceMaxRequests:10000

cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000
</pre></div>     
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.timeouts">
  <h4 class="title">FastCGI 超时设定</h4>
  <p class="para">
   如果会有一些需时较长的 PHP 脚本运行，则增加超时的设定值。有两个控制超时的指令
   <var class="varname">activityTimeout</var> 和
   <var class="varname">requestTimeout</var>。有关这些设定的更多信息参见
   <a href="http://learn.iis.net/page.aspx/248/configuring-fastcgi-extension-for-iis-60/" class="link external" title="Link : http://learn.iis.net/page.aspx/248/configuring-fastcgi-extension-for-iis-60/">&raquo;&nbsp;Configuring FastCGI Extension for IIS 6.0</a>。
   <div class="example" id="install.unix.litespeed.extract.php">
    <p><strong>Example #6 配置 FastCGI 超时设定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-ActivityTimeout:90

cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-RequestTimeout:90
</pre></div>     
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.phpinilocation">
  <h4 class="title">改变 <var class="filename">php.ini</var> 文件的位置</h4>
  <p class="para">
   PHP 在几个位置搜索<a href="configuration.file.html" class="link">配置文件</a>
   <var class="filename">php.ini</var>，可以通过环境变量 <var class="varname">PHPRC</var>
   来改变 <var class="filename">php.ini</var> 的默认位置。要使得 PHP 从用户指定的位置加载配置文件，使用以下命令。指向
   <var class="filename">php.ini</var> 文件的绝对路径应作为环境变量 <var class="varname">PHPRC</var>
   的值。
   <div class="example" id="install.unix.litespeed.build.php">
    <p><strong>Example #7 改变 <var class="filename">php.ini</var> 文件的位置</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-EnvironmentVars:PHPRC:&quot;C:\Some\Directory\&quot;
</pre></div>         
    </div>

   </div>
  </p>
 </div>
</div>



   



<div class="sect2" id="install.windows.legacy.iis7">
 <h3 class="title">Microsoft IIS 7.0 及更高版本</h3>
 <p class="para">
  本章包含有在 Windows Vista SP1，Windows 7，Windows Server 2008 以及
  Windows Server 2008 R2下的 IIS 7.0 以及更高版本中手工安装 PHP
  的指南。有关在 Windows XP 和 Windows Server 2003 
  下的 IIS 5.1 和 IIS 6.0 中安装 PHP 的指南见
  <a href="install.windows.legacy.index.html#install.windows.legacy.iis6" class="link">Microsoft IIS 5.1 和 IIS 6.0</a> 一章。
 </p>
 <div class="sect3" id="install.windows.legacy.iis7.fastcgi.enable">
  <h4 class="title">在 IIS 中激活 FastCGI 支持</h4>
  <p class="para">
   默认安装的 IIS 中 FastCGI 模块被关闭。要激活其的步骤在不同版本的 Windows 下不同。
  </p>
  <p class="para">
   要在 Windows Vista SP1 和 Windows 7 中激活 FastCGI 支持：
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      在 Windows 开始菜单中选择"运行..."（或在搜索框内），输入"optionalfeatures.exe"并按"确定"（或敲回车键）；
     </p>
    </li>
    <li>
     <p class="simpara">
      在"Windows 功能"对话框中展开"Internet
      信息服务"，"万维网服务"，"应用程序开发功能"，并选中"CGI"的选择框；
     </p>
    </li>
    <li>
     <p class="simpara">
      点击确定按钮并等待安装完成。
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7vistacgi.png" alt="在 Windows Vista SP1 和 Windows 7 中激活 FastCGI 支持" width="429" height="375" />
    </div>
   </div>
  </p>
  <p class="para">
   要在 Windows Server 2008 和 Windows Server 2008 R2 中激活 FastCGI 支持：
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      在 Windows 开始菜单中选择 &quot;Run:&quot;，输入 &quot;CompMgmtLauncher&quot;
      并点击 &quot;Ok&quot;；
     </p>
    </li>
    <li>
     <p class="simpara">
      如果在 &quot;Roles&quot; 节点下没有 &quot;Web Server (IIS)&quot; role，则点击
      &quot;Add Roles&quot; 添加之；
     </p>
    </li>
    <li>
     <p class="simpara">
      如果存在 &quot;Web Server (IIS)&quot; role，则点击 &quot;Add Role Services&quot; 并激活
      &quot;Application Development&quot; 组之下的 &quot;CGI&quot; 选择框；
     </p>
    </li>
    <li>
     <p class="simpara">
      点击 &quot;Next&quot; 及 &quot;Install&quot;，等待安装完成。
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7w2k8cgi.png" alt="在 Windows Server 2008 和 Windows Server 2008 R2 中激活 FastCGI 支持" width="546" height="411" />
    </div>
   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.fastcgi.conf">
  <h4 class="title">配置 IIS 以处理 PHP 请求</h4>
  <p class="para">
   根据 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a> 的说明下载和安装 PHP。
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      在使用 IIS 时推荐使用非线程安全的 PHP。可以在
      <a href="https://windows.php.net/download/" class="link external" title="Link : https://windows.php.net/download/">&raquo;&nbsp;PHP for Windows: 
      Binaries and Sources Releases</a> 下载。
     </p>
    </p></blockquote>
  </p>
  <p class="para">
   按以下示例在 <var class="filename">php.ini</var> 文件中配置
   针对 CGI- 和 FastCGI- 的指令：
   <div class="example" id="install.openbsd.ports.example">
    <p><strong>Example #8 <var class="filename">php.ini</var> 中的 CGI 和 FastCGI 设定</strong></p>
    <div class="example-contents">
<div class="inicode"><pre class="inicode">fastcgi.impersonate = 1
fastcgi.logging = 0
cgi.fix_pathinfo=1
cgi.force_redirect = 0</pre>
</div>
    </div>

   </div>
  </p>
  <p class="para">
   通过 IIS 管理界面或者命令行工具配置对应于 PHP 的 IIS 程序映射。
  </p>
  <div class="sect4" id="install.windows.legacy.iis7.fastcgi.conf.ui">
   <h5 class="title">使用 IIS 管理界面来创建 PHP 的程序映射</h5>
    <p class="para">
     按照以下步骤在 IIS 管理界面中创建 PHP 的程序映射：
     <div class="procedure">
      <ol type="1"><li>
       <p class="simpara">
        在 Windows 开始菜单中选择"运行..."，输入"inetmgr"并点击"确定"；
      </p>
      </li>
      <li>
       <p class="simpara">
        在 IIS 管理器中左边面板"连接"下面的树状图中选择该服务器的节点；
       </p>
      </li>
      <li>
       <p class="para">
        在中间面板下方的"功能视图"页面打开"处理程序映射"功能；
        <div class="mediaobject">
         
         <div class="imageobject">
          <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7handlericon.png" alt="创建 PHP 的程序映射：处理程序映射的位置" width="708" height="515" />
         </div>
        </div>
       </p>
      </li>
      <li>
       <p class="simpara">在右边"操作"面板中点击"添加模块映射..."；</p>
      </li>
      <li>
       <p class="para">
        在"添加模块映射"对话框中输入以下内容：
        <ul class="itemizedlist">
         <li class="listitem">
          <span class="simpara">请求路径(P)：*.php</span>
         </li>
         <li class="listitem">
          <span class="simpara">模块(M)：FastCgiModule</span>
         </li>
         <li class="listitem">
          <span class="simpara">可执行文件(可选)(E)：C:\[Path to PHP installation]\php-cgi.exe</span>
         </li>
         <li class="listitem">
          <span class="simpara">名称(N)：PHP_via_FastCGI</span>
         </li>
        </ul>
       </p>
      </li>
      <li>
       <p class="simpara">
        点击"请求限制(R)..."按钮并选中"仅当请求映射至以下内容时才调用处理程序(I)："然后选择"文件或文件夹(O)"；
        </p>
      </li>
      <li>
       <p class="simpara">
        在所有对话框中点击确定以保存配置。
       </p>
      </li>
     </ol></div>
     <div class="mediaobject">
      
      <div class="imageobject">
       <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7handlermap.png" alt="创建 PHP 的程序映射：添加程序映射" width="705" height="512" />
      </div>
     </div>
    </p>
  </div>
  <div class="sect4" id="install.windows.legacy.iis7.fastcgi.conf.cmd">
   <h5 class="title">使用命令行工具创建 PHP 的程序映射</h5>
   <p class="para">
    用以下命令创建一个 IIS FastCGI 处理池以使 <var class="filename">php-cgi.exe</var>
    可执行文件来处理 PHP 请求。用自己系统上指向 <var class="filename">php-cgi.exe</var>
    文件的绝对路径来替代 <var class="varname">fullPath</var> 参数的值。
    <div class="example" id="install.unix.debian.apt.example">
     <p><strong>Example #9 创建 IIS FastCGI 处理池</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd set config /section:system.webServer/fastCGI ^
/+[fullPath=&#039;c:\PHP\php-cgi.exe&#039;]
</pre></div>
     </div>

    </div>
   </p>
   <p class="para">
    用以下命令配置 IIS 处理针对 PHP 的请求。用自己系统上指向 <var class="filename">php-cgi.exe</var>
    文件的绝对路径来替代 <var class="varname">scriptProcessor</var> 参数的值。
    <div class="example" id="install.unix.debian.apt.example2">
     <p><strong>Example #10 创建对应于 PHP 请求的处理程序映射</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd set config /section:system.webServer/handlers ^
/+[name=&#039;PHP_via_FastCGI&#039;, path=&#039;*.php&#039;,verb=&#039;*&#039;,modules=&#039;FastCgiModule&#039;,^
scriptProcessor=&#039;c:\PHP\php-cgi.exe&#039;,resourceType=&#039;Either&#039;]
</pre></div>
     </div>

    </div>
   </p>
   <p class="para">
    此命令创建了一个对于 *.php 文件后缀的处理程序映射，使得所有以 .php
    结尾的 URL 都会被 FastCGI 模块处理。
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      至此所需的安装和配置步骤就完成了。以下剩余的指示是可选项，但是强烈推荐以使得在
      IIS 上达到最佳的 PHP 功能和性能。
     </p>
    </p></blockquote>
   </p>
  </div>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.impersonation">
  <h4 class="title">角色扮演及文件系统访问</h4>
  <p class="para">
   在 IIS 中使用 PHP 建议激活 FastCGI 的角色扮演功能。此功能在 <var class="filename">php.ini</var>
   中由 <var class="varname">fastcgi.impersonate</var> 指令控制。激活角色扮演后，PHP
   将以 IIS 所认证的用户帐号身份进行所有的文件系统操作。这将确保即使在（同一个主机）不同的
   IIS 网站下使用了同一个 PHP 进程，只要每个网站使用了不同的用户帐号作为 IIS
   身份认证，则这些网站的 PHP 脚本将不能访问彼此的文件。
  </p>
  <p class="para">
   例如在 IIS 7 中，默认配置下的匿名认证将使用内置的用户帐号 IUSR 作为默认身份。这意味着要使得
   IIS 能够运行 PHP 脚本，至少要将这些脚本的读取权限授予 IUSR 帐号。如果 PHP
   程序需要对某些文件或文件夹进行写入操作，那 IUSER 帐号也需要有相对应的写入权限。
  </p>
  <p class="para">
   在 IIS 7 中要查看哪个用户帐号被用作匿名认证的身份，使用以下命令。将其中的
   &quot;Default Web Site&quot; 替换为自己使用的网站名。在输出的 XML
   配置单元中查找 <var class="varname">userName</var> 属性。（注意：要以管理员身份运行此命令行）
   <div class="example" id="install.unix.debian.config.example">
    <p><strong>Example #11 确定用于 IIS 匿名认证的用户帐号</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe list config &quot;Default Web Site&quot; ^
/section:anonymousAuthentication

&lt;system.webServer&gt;
  &lt;security&gt;
    &lt;authentication&gt;
      &lt;anonymousAuthentication enabled=&quot;true&quot; userName=&quot;IUSR&quot; /&gt;
    &lt;/authentication&gt;
   &lt;/security&gt;
&lt;/system.webServer&gt;
</pre></div>
    </div>

   </div>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     如果在 <var class="varname">anonymousAuthentication</var>
     单元中没有显示 <var class="varname">userName</var>
     属性，或者其值为一个空字符串，那意味着应用程序池的身份被用于该网站的匿名身份。
    </p>
   </p></blockquote>
  </p>
  <p class="para">
   要修改文件及文件夹的权限，使用 Windows 资源管理器或者 <var class="varname">icacls</var> 命令行。
   <div class="example" id="install.unix.debian.config.example2">
    <p><strong>Example #12 配置文件访问权限</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
icacls C:\inetpub\wwwroot\upload /grant IUSR:(OI)(CI)(M)
</pre></div>
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.defaultdoc">
  <h4 class="title">在 IIS 中把 <var class="filename">index.php</var> 设定为默认文档</h4>
  <p class="para">
   IIS 的默认文档用于没有指定文件名的 HTTP 请求。对于 PHP 应用来说默认文档通常为
   <var class="filename">index.php</var>。要将 <var class="filename">index.php</var>
   添加到 IIS 的默认文档列表中，使用此命令：
   <div class="example" id="example-20">
    <p><strong>Example #13 将 <var class="filename">index.php</var> 设为 IIS 的默认文档</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config ^
-section:system.webServer/defaultDocument /+&quot;files.[value=&#039;index.php&#039;]&quot; ^
/commit:apphost
</pre></div>
    </div>

   </div>   
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.recycling">
  <h4 class="title">FastCGI 和 PHP 回收配置</h4>
  <p class="para">
   用以下命令配置 IIS FastCGI 对于 PHP 进程的回收设定。FastCGI 的设置
   <var class="varname">instanceMaxRequests</var> 控制了单一的 <var class="filename">php-cgi.exe</var>
   进程处理多少个请求之后会被 IIS 关闭。PHP 环境变量 <var class="varname">PHP_FCGI_MAX_REQUESTS</var>
   控制了一个 <var class="filename">php-cgi.exe</var>
   进程处理多少个请求之后会被自我回收。要确保 FastCGI 中 <var class="varname">InstanceMaxRequests</var>
   的值小于或等于 <var class="varname">PHP_FCGI_MAX_REQUESTS</var> 的值。
   <div class="example" id="example-21">
    <p><strong>Example #14 配置 FastCGI 和 PHP 的回收</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;c:\php\php-cgi.exe&#039;].instanceMaxRequests:10000

%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/+&quot;[fullPath=&#039;C:\{php_folder}\php-cgi.exe&#039;].environmentVariables.^
[name=&#039;PHP_FCGI_MAX_REQUESTS&#039;,value=&#039;10000&#039;]&quot;
</pre></div>
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.timeouts">
  <h4 class="title">FastCGI 超时设定</h4>
  <p class="para">
   如果会有一些需时较长的 PHP 脚本运行，则增加超时的设定值。有两个控制超时的指令
   <var class="varname">activityTimeout</var> 和
   <var class="varname">requestTimeout</var>。用以下命令修改超时设定。确保在
   <var class="varname">fullPath</var> 的参数中使用自己系统上的
   <var class="filename">php-cgi.exe</var> 的绝对路径。
   <div class="example" id="example-22">
    <p><strong>Example #15 配置 FastCGI 超时设定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;C:\php\php-cgi.exe&#039;,arguments=&#039;&#039;].activityTimeout:&quot;90&quot;  /commit:apphost

%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;C:\php\php-cgi.exe&#039;,arguments=&#039;&#039;].requestTimeout:&quot;90&quot;  /commit:apphost
</pre></div>
    </div>

   </div>   
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.phpinilocation">
  <h4 class="title">改变 <var class="filename">php.ini</var> 文件的位置</h4>
  <p class="para">
   PHP 在几个位置搜索<a href="configuration.file.html" class="link">配置文件</a>
   <var class="filename">php.ini</var>，可以通过环境变量 <var class="varname">PHPRC</var>
   来改变 <var class="filename">php.ini</var> 的默认位置。要使得 PHP 从用户指定的位置加载配置文件，使用以下命令。指向
   <var class="filename">php.ini</var> 文件的绝对路径应作为环境变量 <var class="varname">PHPRC</var>
   的值。
   <div class="example" id="example-23">
    <p><strong>Example #16 改变 <var class="filename">php.ini</var> 文件的位置</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
appcmd.exe set config  -section:system.webServer/fastCgi ^
/+&quot;[fullPath=&#039;C:\php\php.exe&#039;,arguments=&#039;&#039;].environmentVariables.^
[name=&#039;PHPRC&#039;,value=&#039;C:\Some\Directory\&#039;]&quot; /commit:apphost
</pre></div>         
    </div>

   </div>   
  </p>
 </div>
</div>


   
   



<div class="sect2" id="install.windows.legacy.apache1">
 <h3 class="title">Microsoft Windows 下的 Apache 1.3.x</h3>
 <p class="para">
  本节包括在 Microsoft Windows 平台的 Apache 下安装 PHP 的说明和提示。在另外的页面也有 
  
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   请先阅读 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手动安装步骤</a>！
  </p>
 </p></blockquote>
 <p class="simpara">
  有两种方式让 PHP 工作在 Windows 下的 Apache 1.3.x 中。首先是使用 CGI
  可执行程序（PHP 4 下为 <var class="filename">php.exe</var>，PHP 5 下为 
  <var class="filename">php-cgi.exe</var>），另外一种方式是使用 Apache 模块
  DLL。无论是那种方式，都需要修改 <var class="filename">httpd.conf</var> 来配置 Apache，使 PHP
  能够在其上运行，然后都需要重启服务。
 </p>
 <p class="simpara">
  值得注意的是，现在 Windows 下的 SAPI 模块已经稳定得多，我们建议首先考虑使用
  SAPI 而不要使用 CGI 可执行程序。因为 SAPI 更加透明和安全。
 </p>
 <p class="simpara">
  虽然还有些其它的方法来在 Apache 下配置 PHP，下面介绍的方法是最简单并适用于新手的。请参考
  Apache 的文档以获得更多的配置参数。
 </p>
 <p class="simpara">
  在修改完配置文件后，请记得重启 Apache 服务。例如，如果把 Apache 作为 Windows
  的一个服务来运行，那么在命令提示行下使用
  <strong class="command">NET STOP APACHE</strong>命令然后再使用 
  <strong class="command">NET START APACHE</strong>命令便可重启服务。也可以使用重启 Apache 服务的快捷方式来重启。
 </p>
 
 <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">记住当在
Windows 环境下的 Apache 配置文件中添加路径值时，所有的反斜线，如
<var class="filename">c:\directory\file.ext</var>，应转换为正斜线：
<var class="filename">c:/directory/file.ext</var>。对目录来说，也必须由斜线结尾。</span></p></blockquote>

 <div class="sect3" id="install.windows.legacy.apache1.module">
  <h4 class="title">作为 Apache 的模块安装</h4>
  <p class="para">
   应该将下面几行加入 Apache 的 <var class="filename">httpd.conf</var> 文件：
  </p>
  <p class="para">
   <div class="example" id="example-24">
    <p><strong>Example #17 PHP 作为 Apache 1.3.x 的一个模块</strong></p>
    <div class="example-contents"><p>
     这里假设 PHP 安装在 
     <var class="filename">c:\php</var>。如果不是这样请根据情况修改路径。
    </p></div>
    <div class="example-contents"><p>
     对于 PHP 4：
    </p></div>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 在 LoadModule 一节的末尾添加
# 不要忘记将该文件从 sapi 复制出来
LoadModule php4_module &quot;C:/php/php4apache.dll&quot;

# 在 AddModule 一节的末尾添加
AddModule mod_php4.c</pre>
</div>
    </div>

    <div class="example-contents"><p>
     对于 PHP 5：
    </p></div>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 在 LoadModule 一节的末尾添加
LoadModule php5_module &quot;C:/php/php5apache.dll&quot;

# 在 AddModule 一节的末尾添加
AddModule mod_php5.c</pre>
</div>
    </div>

    <div class="example-contents"><p>
     两个 PHP 版本都需要添加的内容：
    </p></div>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 将下面这行添加到 &lt;IfModule mod_mime.c&gt; 条件块中
AddType application/x-httpd-php .php

# 如果要使用语法高亮的 .phps 文件，需要添加
AddType application/x-httpd-php-source .phps</pre>
</div>
    </div>

   </div>
  </p>
 </div>

 <div class="sect3" id="install.windows.legacy.apache1.cgi">
  <h4 class="title">作为 CGI 可执行文件的安装</h4>
  <p class="para">
   如果按照 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a> 将 PHP
   解压到 <var class="filename">C:\php\</var>，需要在 Apache 的配置文件中添加如下内容以使
   PHP 按照 CGI 方式运行: 
   <div class="example" id="example-25">
    <p><strong>Example #18 PHP 以 CGI 方式运行在 Apache 1.3.x</strong></p>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">ScriptAlias /php/ &quot;c:/php/&quot;
AddType application/x-httpd-php .php

# 对于 PHP 4
Action application/x-httpd-php &quot;/php/php.exe&quot;

# 对于 PHP 5
Action application/x-httpd-php &quot;/php/php-cgi.exe&quot;

# 指定 php.ini 所在目录
SetEnv PHPRC C:/php</pre>
</div>
    </div>

   </div>
   请注意第二行的配置可以在默认的 <var class="filename">httpd.conf</var> 中找到，但是是被注释掉的。也请记得将 
   <var class="filename">c:/php/</var>替换为 PHP 所在的真实路径。
  </p>
  
  <div class="warning"><strong class="warning">Warning</strong><p class="para">服务器使用 CGI 方式进行部署可能存在几个公开的缺陷。请阅读
<a href="security.cgi-bin.html" class="link">CGI 安全</a>一章 以学习 如何抵御这些攻击。</p></div>

  <p class="simpara">
   如果想发布语法高亮的 php 文件，没有类似于模块方式下 PHP 那种方便的方法。如果选择了 CGI
   方式运行 PHP，需要使用 <span class="function"><a href="function.highlight-file.html" class="function">highlight_file()</a></span> 函数来进行语法高亮。创建一个
   PHP 文件，加入下述代码即可：<code class="literal">&lt;?php highlight_file(&#039;some_php_script.php&#039;); ?&gt;</code>。
  </p>
 </div>

</div>


   




<div class="sect2" id="install.windows.legacy.apache2">
 <h3 class="title">Microsoft Windows 下的 Apache 2.x</h3>
 <p class="para">
  本节包括在 Microsoft Windows 系统中针对 Apache 2.x 安装 PHP 的指导与说明。
  
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   应该先阅读<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a>！
  </p>
 </p></blockquote>
 
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <strong>Apache 2.2 支持</strong><br />
  <p class="para">
   Apache 2.2 用户应留意对于 Apache 2.2 的 DLL 文件名是
   <var class="filename">php5apache2_2.dll</var> 而不是
   <var class="filename">php5apache2.dll</var>，并且只在 PHP 5.2.0
   以及更高版本中出现。
  </p>
 </p></blockquote>
 
 <p class="para">
  强烈建议阅读 <a href="http://httpd.apache.org/docs/current/" class="link external" title="Link : http://httpd.apache.org/docs/current/">&raquo;&nbsp;Apache 文档</a>来加深对
  Apache 2.x 服务器的基本理解。此外在继续下去之前考虑先阅读一下 Apache 2.x 的 
  <a href="http://httpd.apache.org/docs/current/platform/windows.html" class="link external" title="Link : http://httpd.apache.org/docs/current/platform/windows.html">&raquo;&nbsp;Windows 下使用说明</a>。
 </p>
 
 <p class="para">
  Apache 2.x 被设计运行于 Windows 版的服务器平台下，例如 Windows NT 4.0，Windows
  2000，Windows XP 或 Windows 7。虽然 Apache 2.x 可以在 Windows 9x
  下勉强运行，但对此平台的支持尚未完成，某些功能无法正确工作。对此并无补救计划。
 </p>
 
 <p class="para">
  下载最新版本的 <a href="http://httpd.apache.org/" class="link external" title="Link : http://httpd.apache.org/">&raquo;&nbsp;Apache 2.x</a>
  以及适合的 PHP 版本。先完成<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a>后再回来继续将
  PHP 集成入 Apache。
 </p>
 
 <p class="para">
  Windows 下有三种方法使 PHP 工作于 Apache 2.x 之中。可以以 handler，CGI，或者 FastCGI 方式运行 PHP。
 </p>
 
 <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">记住当在
Windows 环境下的 Apache 配置文件中添加路径值时，所有的反斜线，如
<var class="filename">c:\directory\file.ext</var>，应转换为正斜线：
<var class="filename">c:/directory/file.ext</var>。对目录来说，也必须由斜线结尾。</span></p></blockquote>
 
 <div class="sect3" id="install.windows.apache2.legacy.module">
  <h4 class="title">以 Apache handler 方式安装</h4>
  <p class="para">
   需要将以下几行加入到 Apache 的 <var class="filename">httpd.conf</var> 配置文件中以加载 Apache 2.x 的 PHP 模块：
   <div class="example" id="example-26">
    <p><strong>Example #19 PHP 在 Apache 2.x 中作为 handler</strong></p>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 
LoadModule php5_module &quot;c:/php/php5apache2.dll&quot;
AddHandler application/x-httpd-php .php

# 配置 php.ini 的路径
PHPIniDir &quot;C:/php&quot;</pre>
</div>
    </div>

   </div>
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    记得用自己 PHP 实际所在的路径替换掉上例中的 
    <var class="filename">c:/php/</var>。要留意在 LoadModule 指令中使用了
    <var class="filename">php5apache2.dll</var> 或者
    <var class="filename">php5apache2_2.dll</var>，并且该文件确实位于所指定的位置。
   </span>
  </p></blockquote>
  <p class="para">
   以上配置将使 PHP 处理任何具有 .php 后缀的文件，即使该文件还有其它的文件后缀。例如一个名为
   <var class="filename">example.php.txt</var> 的文件将被作为 PHP 文件运行。要确保只有以
   <var class="filename">.php</var> <em class="emphasis">结尾</em>的文件才被执行，则用以下配置替换上面的：
  </p>
  
  <div class="example" id="example-27">
   <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">&lt;FilesMatch \.php$&gt;
      SetHandler application/x-httpd-php
 &lt;/FilesMatch&gt;</pre>
</div>
   </div>

  </div>
 </div>
 
 <div class="sect3" id="install.windows.apache2.legacy.cgi">
  <h4 class="title">以 CGI 方式运行 PHP</h4>
  <p class="para">
   要更好地理解在 Apache 下运行 CGI，请参阅
   <a href="http://httpd.apache.org/docs/current/howto/cgi.html" class="link external" title="Link : http://httpd.apache.org/docs/current/howto/cgi.html">&raquo;&nbsp;Apache CGI 文档</a>。
  </p>
  <p class="para">
   要将 PHP 以 CGI 方式运行，需要将 php-cgi 文件放入到用
   ScriptAlias 指令所指定的 CGI 目录中。
  </p>
  <p class="para">
   然后需要给 PHP 文件中添加一 #! 的行来指明 PHP 可执行文件的位置：
   <div class="example" id="example-28">
    <p><strong>Example #20 Apache 2.x 下 CGI 方式的 PHP</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
#!C:/php/php.exe
&lt;?php
  phpinfo();
?&gt;
</pre></div>
    </div>

   </div>
  </p>
  <div class="warning"><strong class="warning">Warning</strong><p class="para">服务器使用 CGI 方式进行部署可能存在几个公开的缺陷。请阅读
<a href="security.cgi-bin.html" class="link">CGI 安全</a>一章 以学习 如何抵御这些攻击。</p></div>
 </div>
 
 <div class="sect3" id="install.windows.apache2.legacy.fastcgi">
  <h4 class="title">以 FastCGI 方式运行 PHP</h4>
  
  <p class="para">
   以 FastCGI 方式运行 PHP 比起 CGI 方式有很多优点。设定的方式很直接：
  </p>
  <p class="para">
   从 <a href="http://httpd.apache.org/mod_fcgid/" class="link external" title="Link : http://httpd.apache.org/mod_fcgid/">&raquo;&nbsp;http://httpd.apache.org/mod_fcgid/</a>
   取得 mod_fcgid，该站点有 Win32 可执行文件的下载。按照下载文件中的指示安装此模块。
  </p>
  <p class="para">
   按以下方法配置 web 服务器，注意用自己系统上的路径替换其中相应的内容：
   
   <div class="example" id="example-29">
    <p><strong>Example #21 配置 Apache 以 FastCGI 方式运行 PHP</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
LoadModule fcgid_module modules/mod_fcgid.so  

# Where is your php.ini file?
FcgidInitialEnv PHPRC        &quot;c:/php&quot; 

AddHandler fcgid-script .php  
FcgidWrapper &quot;c:/php/php-cgi.exe&quot; .php  
</pre></div>
   </div>

   </div>
   此时具有 .php 后缀的文件将被 PHP FastCGI 所解析执行。
  </p>
  
 </div>
 
</div>



   




<div class="sect2" id="install.windows.legacy.sambar">
 <h3 class="title">Microsoft Windows 下的 Sambar 服务器</h3>
 <p class="para">
  本节包含针对 Windows 下的 
  <a href="http://www.sambar.com/" class="link external" title="Link : http://www.sambar.com/">&raquo;&nbsp;Sambar 服务器</a>的说明和提示。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   应该首先阅读 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a>！
  </p>
 </p></blockquote>
 <p class="simpara">
  下面列出了怎样在 Windows 下设置 Sambar 服务器的 ISAPI 模块。
 </p>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     在 Sambar 安装目录中找到 <var class="filename">mappings.ini</var>文件（在 config 目录中）；
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     打开 <var class="filename">mappings.ini</var> 并在 
     <code class="literal">[ISAPI]</code> 部分加入下面一行： 
     <div class="example" id="example-30">
      <p><strong>Example #22 Sambar 的 ISAPI 设置</strong></p>
      <div class="example-contents">
<div class="cdata"><pre>
#对 PHP 4
*.php = c:\php\php4isapi.dll

#对 PHP 5
*.php = c:\php\php5isapi.dll
</pre></div>
      </div>

     </div>
     （上面假定 PHP 安装在 <var class="filename">c:\php</var>。）
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     重启动 Sambar 服务器以使改动生效。
    </p>
   </li>
  </ul>
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   如果想要用 PHP 与分布于网络中不同的主机上的资源通讯，则需要改变 Sambar
   服务器的服务进程所使用的帐号。Sambar 服务进程使用的默认帐号是
   LocalSystem，没有远程资源的访问许可。可以通过 Windows
   控制面板中的"管理工具"里面的"服务"来修改此帐号。
  </p>
 </p></blockquote>
</div>


   



<div class="sect2" id="install.windows.legacy.xitami">
 <h3 class="title">Microsoft Windows 下的 Xitami</h3>
 <p class="para">
  本节包含针对 Windows 下的 
  <a href="http://www.xitami.com/" class="link external" title="Link : http://www.xitami.com/">&raquo;&nbsp;Xitami</a> 的说明与提示。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   应该首先阅读 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手工安装步骤</a>！
  </p>
 </p></blockquote>
 <p class="simpara">
  下面列出了怎样在 Windows 下在 Xitami 中设置 PHP 的 CGI 方式。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <strong>CGI 用户重要提示</strong><br />
  <p class="para">
   请阅读 <a href="faq.installation.html#faq.installation.forceredirect" class="link">FAQ：cgi.force_redirect</a>
   中的重要细节。此选项需要被设为 <code class="literal">0</code>。如果想要使用 
   <code class="literal">$_SERVER[&#039;PHP_SELF&#039;]</code>，还必须激活 
   <a href="ini.core.html#ini.cgi.fix-pathinfo" class="link">cgi.fix_pathinfo</a>选项。
  </p>
 </p></blockquote>
 
 <div class="warning"><strong class="warning">Warning</strong><p class="para">服务器使用 CGI 方式进行部署可能存在几个公开的缺陷。请阅读
<a href="security.cgi-bin.html" class="link">CGI 安全</a>一章 以学习 如何抵御这些攻击。</p></div>
 
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     确保 web 服务器在运行，在浏览器中打开 Xitami 的管理控制台（通常是 
     <code class="literal">http://127.0.0.1/admin</code>），并点击 Configuration；
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     找到 Filters，在 File extensions（.xxx）字段中加入想要 PHP 解析的后缀名（例如 .php）；
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     在 Filter command 或 script 中输入 PHP 的 CGI 可执行文件名，例如 PHP 4 是 
     <var class="filename">C:\php\php.exe</var>，PHP 5 是 
     <var class="filename">C:\php\php-cgi.exe</var>；
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     点击"Save"图标；
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     重启动服务器以使改动生效。
    </p>
   </li>
  </ul>
 </p>
</div>



   


<div class="sect2" id="install.windows.legacy.building">
 <h3 class="title">从源程序编译</h3>
 <p class="para">
  本章讲述了在 Windows 下如何使用 Microsoft 的工具编译 PHP。要在
  CygWin 中编译 PHP，请参考 <a href="install.unix.html" class="xref">Unix 系统下的安装</a> 一章。
 </p>
 <p class="para">
  具体内容见：<a href="https://wiki.php.net/internals/windows/stepbystepbuild" class="link external" title="Link : https://wiki.php.net/internals/windows/stepbystepbuild">&raquo;&nbsp;https://wiki.php.net/internals/windows/stepbystepbuild</a>。
 </p>
</div>



   

 

<div class="sect2" id="install.windows.legacy.extensions">
 <h3 class="title">Windows 下安装扩展库</h3>
 <p class="para">
  在 Windows 下安装完 PHP 和 web 服务器之后，可能想要安装一些扩展库来获得更多功能。可以通过修改 
  <var class="filename">php.ini</var> 来选择当 PHP 启动时加载哪些扩展库。也可以在脚本中通过使用 
  <span class="function"><a href="function.dl.html" class="function">dl()</a></span>来动态加载。
 </p>
 <p class="para">
  PHP 扩展库的 DLL 文件都具有 
  <code class="literal">php_</code> 前缀。
 </p>
 <p class="para">
  很多扩展库都 <em class="emphasis">内置于</em> Windows 版的 PHP
  之中。这意味着要加载这些扩展库，额外的 DLL 文件和 
  <a href="ini.core.html#ini.extension" class="link">extension</a>
  配置指令都 <em class="emphasis">不需要</em>。Windows 下的 
  <a href="install.windows.legacy.index.html#install.windows.legacy.extensions.overview" class="link">PHP 扩展库</a>
  列表列出了需要或曾经需要额外
  PHP DLL 文件的扩展库。下面是内置的扩展库列表（截止到 PHP 5.0.4）：
   <a href="book.bc.html" class="link">BCMath</a>,
   <a href="book.calendar.html" class="link">Calendar</a>,
   <a href="book.com.html" class="link">COM</a>,
   <a href="book.ctype.html" class="link">Ctype</a>,
   <a href="book.dom.html" class="link">DOM</a>,
   <a href="book.ftp.html" class="link">FTP</a>,
   <a href="book.libxml.html" class="link">LibXML</a>,
   <a href="book.iconv.html" class="link">Iconv</a>,
   <a href="book.uodbc.html" class="link">ODBC</a>,
   <a href="book.pcre.html" class="link">PCRE</a>,
   <a href="book.session.html" class="link">Session</a>,
   <a href="book.simplexml.html" class="link">SimpleXML</a>,
   <a href="book.spl.html" class="link">SPL</a>,
   <a href="book.wddx.html" class="link">WDDX</a>,
   <a href="book.xml.html" class="link">XML</a> 和 
   <a href="book.zlib.html" class="link">Zlib</a>.
 </p>
 <p class="para">
  PHP 搜索扩展库的默认位置在 
  <var class="filename">C:\php5</var>。要修改此项以符合用户自己的
  PHP 设置，需要编辑 <var class="filename">php.ini</var> 文件： 
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     需要修改
     <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a>
     设置以指向用户放置扩展库的目录或者说放置 
     <var class="filename">php_*.dll</var> 文件的位置。例如： 
     <div class="informalexample">
      <div class="example-contents">
<div class="inicode"><pre class="inicode">extension_dir = C:\php\extensions</pre>
</div>
      </div>

     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     要在 <var class="filename">php.ini</var> 中启用某扩展库，需要去掉 <var class="filename">php.ini</var> 文件中该行 
     <code class="literal">extension=php_*.dll</code> 前的注释符号，将想要加载的扩展库前的分号（;）删除即可。 
     <div class="example" id="example-31">
      <p><strong>Example #23 在 Windows 下启用 <a href="book.bzip2.html" class="link">Bzip2</a> 扩展库</strong></p>
      <div class="example-contents">
<div class="inicode"><pre class="inicode">// 将这一行
;extension=php_bz2.dll

// 改成这样
extension=php_bz2.dll</pre>
</div>
      </div>

     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     有些扩展库需要额外的 DLL 才能工作。其中一部分包括在发行包里，在主目录下可以找到。但还有一些，例如
     Oracle（<var class="filename">php_oci8.dll</var>）所需要的 DLL 没有绑定在发行包里。别忘了将 
     <var class="filename">C:\php</var> 放到系统路径 
     <var class="envar">PATH</var> 中去（此过程在另外的 <a href="faq.installation.html#faq.installation.addtopath" class="link">FAQ 条目</a>中有说明）。
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     某些 DLL 没有绑定在 PHP 发行包中，详情见每个扩展库的文档页。此外有关 
     <acronym title="PHP Extension and Application Repository">PECL</acronym> 的说明见手册页 
     <a href="install.pecl.html" class="link">PECL
     扩展库安装</a>。在 
     <acronym title="PHP Extension and Application Repository">PECL</acronym> 中有日益增加数目巨大的 PHP
     扩展库，这些扩展库需要 <a href="install.pecl.downloads.html" class="link">单独下载</a>。
    </p>
   </li>
  </ul>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    如果运行服务器模块版的 PHP，在修改了 <var class="filename">php.ini</var> 之后别忘了重新启动 web 服务器以使其改动生效。
   </span>
  </p></blockquote>
 </p>
 
 
 
 
 <p class="para">
  下表说明了哪些扩展库需要额外的 DLL。 
   <table id="install.windows.legacy.extensions.overview" class="doctable table">
    <caption><strong>PHP 扩展库</strong></caption>
    
     <thead>
      <tr>
       <th>扩展库</th>
       <th>说明</th>
       <th>注解</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>php_bz2.dll</td>
       <td><a href="book.bzip2.html" class="link">bzip2</a> 压缩函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_calendar.dll</td>
       <td><a href="book.calendar.html" class="link">Calendar</a> 日历转换函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_ctype.dll</td>
       <td><a href="book.ctype.html" class="link">ctype</a> 家族函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_curl.dll</td>
       <td><a href="book.curl.html" class="link">CURL</a>，客户端 URL 库函数</td>
       <td>需要：<var class="filename">libeay32.dll</var>，<var class="filename">ssleay32.dll</var>（已附带），在
       OpenSSL 1.1 版本里需要：<var class="filename">libcrypto-*.dll</var> and <var class="filename">libssl-*.dll</var> (已附带)</td>
      </tr>



      <tr>
       <td>php_dba.dll</td>
       <td><a href="book.dba.html" class="link">DBA</a>：数据库（dbm
        风格）抽象层函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_dbase.dll</td>
       <td><a href="book.dbase.html" class="link">dBase</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_dbx.dll</td>
       <td><a href="book.dbx.html" class="link">dbx</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_exif.dll</td>
       <td><a href="book.exif.html" class="link">EXIF</a> 函数</td>
       <td>需要 
        <a href="book.mbstring.html" class="link">php_mbstring.dll</a>。并且在
        <var class="filename">php.ini</var> 中，<var class="filename">php_exif.dll</var> 必须在 
        <var class="filename">php_mbstring.dll</var>
        <code class="literal">之后</code>加载</td>
      </tr>

      <tr>
       <td>php_fbsql.dll</td>
       <td><a href="book.fbsql.html" class="link">FrontBase</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_fdf.dll</td>
       <td><a href="book.fdf.html" class="link">FDF</a>：表单数据格式化函数</td>
       <td>需要：<var class="filename">fdftk.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_filepro.dll</td>
       <td><a href="book.filepro.html" class="link">filePro</a> 函数</td>
       <td>只读访问</td>
      </tr>

      <tr>
       <td>php_ftp.dll</td>
       <td><a href="book.ftp.html" class="link">FTP</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_gd2.dll</td>
       <td><a href="book.image.html" class="link">GD</a> 库图像函数</td>
       <td>GD2</td>
      </tr>

      <tr>
       <td>php_gettext.dll</td>
       <td><a href="book.gettext.html" class="link">Gettext</a> 函数</td>
       <td>PHP &lt;= 4.2.0 需要 
        <var class="filename">gnu_gettext.dll</var>（已附带），PHP &gt;= 4.2.3 需要 
        <var class="filename">libintl-1.dll</var>，
        <var class="filename">iconv.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_hyperwave.dll</td>
       <td>HyperWave 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_iconv.dll</td>
       <td><a href="book.iconv.html" class="link">ICONV</a> 字符集转换</td>
       <td>需要：<var class="filename">iconv-1.3.dll</var>（已附带），<var class="filename">iconv.dll</var></td>
      </tr>

      <tr>
       <td>php_iisfunc.dll</td>
       <td>IIS 管理函数库</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_imap.dll</td>
       <td><a href="book.imap.html" class="link">IMAP</a>，POP3 和 NNTP 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_ingres.dll</td>
       <td><a href="book.ingres.html" class="link">Ingres II</a> 函数</td>
       <td>需要：Ingres II 库</td>
      </tr>

      <tr>
       <td>php_interbase.dll</td>
       <td><a href="book.ibase.html" class="link">InterBase</a> 函数</td>
       <td>需要：<var class="filename">gds32.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_ldap.dll</td>
       <td><a href="book.ldap.html" class="link">LDAP</a> 函数</td>
       <td>需要 ：
        <var class="filename">libeay32.dll</var>，<var class="filename">ssleay32.dll</var>（已附带）。在 OpenSSL 1.1 里需要：
        <var class="filename">libcrypto-*.dll</var> 和 <var class="filename">libssl-*.dll</var> (已附带)
      </td>
      </tr>

      <tr>
       <td>php_mbstring.dll</td>
       <td><a href="book.mbstring.html" class="link">Multi-Byte String</a> 多字节字符串函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_mcrypt.dll</td>
       <td><a href="book.mcrypt.html" class="link">Mcrypt 加密</a>函数</td>
       <td>需要：<var class="filename">libmcrypt.dll</var></td>
      </tr>

      <tr>
       <td>php_mhash.dll</td>
       <td><a href="book.mhash.html" class="link">Mhash</a> 函数</td>
       <td>需要：<var class="filename">libmhash.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_mime_magic.dll</td>
       <td><a href="book.mime-magic.html" class="link">Mimetype</a> 函数</td>
       <td>需要：<var class="filename">magic.mime</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_mysql.dll</td>
       <td><a href="book.mysql.html" class="link">MySQL</a> 函数</td>
       <td>需要：<var class="filename">libmysql.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_mysqli.dll</td>
       <td><a href="book.mysqli.html" class="link">MySQLi</a> 函数</td>
       <td>需要：<var class="filename">libmysql.dll</var>（PHP &lt;= 5.0.2 中是 
        <var class="filename">libmysqli.dll</var>）（已附带）</td>
      </tr>

      <tr>
       <td>php_oci8.dll</td>
       <td><a href="book.oci8.html" class="link">Oracle 8</a> 函数</td>
       <td>需要：Oracle 8.1+ 客户端库</td>
      </tr>

      <tr>
       <td>php_openssl.dll</td>
       <td><a href="book.openssl.html" class="link">OpenSSL</a> 函数</td>
       <td>需要：<var class="filename">libeay32.dll</var>（已附带），OpenSSL 1.1 起需要 <var class="filename">liblibcrypto-*.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_pgsql.dll</td>
       <td><a href="book.pgsql.html" class="link">PostgreSQL</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_shmop.dll</td>
       <td><a href="book.shmop.html" class="link">Shared Memory</a> 共享内存函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_snmp.dll</td>
       <td><a href="book.snmp.html" class="link">SNMP</a> 函数</td>
       <td>仅用于 Windows NT！</td>
      </tr>

      <tr>
       <td>php_soap.dll</td>
       <td><a href="book.soap.html" class="link">SOAP</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_sockets.dll</td>
       <td><a href="book.sockets.html" class="link">Socket</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_tidy.dll</td>
       <td><a href="book.tidy.html" class="link">Tidy</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_tokenizer.dll</td>
       <td><a href="book.tokenizer.html" class="link">Tokenizer</a> 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_w32api.dll</td>
       <td>W32api 函数</td>
       <td>无</td>
      </tr>

      <tr>
       <td>php_xmlrpc.dll</td>
       <td><a href="book.xmlrpc.html" class="link">XML-RPC</a> 函数</td>
       <td>需要：<var class="filename">iconv.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_xslt.dll</td>
       <td>XSLT 函数</td>
       <td>需要：<var class="filename">sablot.dll</var>，<var class="filename">expat.dll</var>，
       <var class="filename">iconv.dll</var>（已附带）。</td>
      </tr>

      <tr>
       <td>php_yaz.dll</td>
       <td><a href="book.yaz.html" class="link">YAZ</a> 函数</td>
       <td>需要：<var class="filename">yaz.dll</var>（已附带）</td>
      </tr>

      <tr>
       <td>php_zip.dll</td>
       <td><a href="book.zip.html" class="link">Zip 文件</a>函数</td>
       <td>只读访问</td>
      </tr>

      <tr>
       <td>php_zlib.dll</td>
       <td><a href="book.zlib.html" class="link">ZLib</a> 压缩函数</td>
       <td>无</td>
      </tr>

     </tbody>
    
   </table>

 </p>
</div>



   




<div class="sect2" id="install.windows.legacy.commandline">
 <h3 class="title">PHP 在 Microsoft Windows 下的命令行方式</h3>
 <p class="para">
  本章包含有针对在 Windows 下以命令行运行 PHP 的说明与提示。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   应该先阅读 <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link"> 手工安装步骤</a>！
  </p>
 </p></blockquote>
 <p class="para">
  要在命令行下运行 PHP，可以无需对 Windows 做任何改动。
  <div class="example-contents screen">
<div class="cdata"><pre>
C:\PHP5\php.exe -f &quot;C:\PHP Scripts\script.php&quot; -- -arg1 -arg2 -arg3
</pre></div>     
  </div>
 </p>
 
 <p class="para">
  但是有几个很容易的步骤可以使其更加简便。某些步骤可能已经在之前完成了，不过还是在这里重复说明以便提供一个完整的步骤序列。
  <ul class="itemizedlist">
   
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     <var class="envar">PATH</var> 和 <var class="envar">PATHEXT</var> 都是在 Windows
     下已有的重要环境变量，要留意不要覆盖了其内容，仅仅是向其中添加内容。
    </p>
   </p></blockquote>
   
   <li class="listitem">
    <p class="para">
     将 PHP 可执行文件（<var class="filename">php.exe</var>，<var class="filename">php-win.exe</var>
     或者 <var class="filename">php-cli.exe</var>）的路径添加到 <var class="envar">PATH</var>
     环境变量中去。如何将 PHP 目录添加到 <var class="envar">PATH</var>
     中请参阅<a href="faq.installation.html#faq.installation.addtopath" class="link">与之相关的常见问题</a>。
    </p>
   </li>
   
   <li class="listitem">
    <p class="para">
     将 <code class="literal">.PHP</code> 后缀添加到
     <var class="varname">PATHEXT</var> 环境变量中去。可以在修改
     <var class="envar">PATH</var> 环境变量时同时进行。跟<a href="faq.installation.html#faq.installation.addtopath" class="link">常见问题</a>中说明的步骤一样，不要要修改的是
     <var class="varname">PATHEXT</var> 环境变量而不是
     <var class="envar">PATH</var> 环境变量。
     <blockquote class="note"><p><strong class="note">Note</strong>: 
      <p class="para">
       把 <code class="literal">.PHP</code> 放置到什么位置将决定具有相同文件名时运行的优先级。例如将
       <code class="literal">.PHP</code> 放到 <code class="literal">.BAT</code>
       之前将导致如果有同名的 PHP 脚本和批处理文件，则 PHP 脚本会运行。
      </p>
     </p></blockquote>
    </p>
   </li>
   
   <li class="listitem">
    <p class="para">
     将 <code class="literal">.PHP</code> 后缀关联为一种文件类型，用以下命令完成：
     <div class="example-contents screen">
<div class="cdata"><pre>
assoc .php=phpfile
</pre></div>     
     </div>
    </p>
   </li>
   
   <li class="listitem">
    <p class="para">
     将 <code class="literal">phpfile</code> 文件类型关联到适当的 PHP
     可执行文件，用以下命令完成：
     <div class="example-contents screen">
<div class="cdata"><pre>
ftype phpfile=&quot;C:\PHP5\php.exe&quot; -f &quot;%1&quot; -- %~2
</pre></div>     
     </div>
    </p>
   </li>
   
  </ul>
 </p>
 
 <p class="para">
  按照以上步骤将使 PHP 脚本可以在任何目录下运行，不需要输入 PHP 可执行文件名以及
  <code class="literal">.PHP</code> 后缀，并且所有参数都会被传递给脚本来处理。
 </p>
 
 <p class="para">
  以下例子说明了可以手工修改的注册表项目变化。
  <div class="example" id="example-32">
   <p><strong>Example #24 注册表变化</strong></p>
   <div class="example-contents screen">
<div class="cdata"><pre>
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.php]
@=&quot;phpfile&quot;
&quot;Content Type&quot;=&quot;application/php&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile]
@=&quot;PHP Script&quot;
&quot;EditFlags&quot;=dword:00000000
&quot;BrowserFlags&quot;=dword:00000008
&quot;AlwaysShowExt&quot;=&quot;&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\DefaultIcon]
@=&quot;C:\\PHP5\\php-win.exe,0&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell]
@=&quot;Open&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell\Open]
@=&quot;&amp;Open&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell\Open\command]
@=&quot;\&quot;C:\\PHP5\\php.exe\&quot; -f \&quot;%1\&quot; -- %~2&quot;
</pre></div>
   </div>
  </div>
 </p>
 
 <p class="para">
  有了这些改变之后，本页顶端第一个例子中的命令可以写成这样：
  <div class="example-contents screen">
<div class="cdata"><pre>
&quot;C:\PHP Scripts\script&quot; -arg1 -arg2 -arg3
</pre></div>
  </div>
  或者如果 <code class="literal">&quot;C:\PHP Scripts&quot;</code> 路径位于
  <var class="envar">PATH</var> 环境变量中的话：
  <div class="example-contents screen">
<div class="cdata"><pre>
script -arg1 -arg2 -arg3
</pre></div>
  </div>
 </p>
 
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   不过如果想要通过此技巧将 PHP 脚本作为命令行管道过滤器的话，有个小问题。例如以下例子：
   <div class="example-contents screen">
<div class="cdata"><pre>
dir | &quot;C:\PHP Scripts\script&quot; -arg1 -arg2 -arg3
</pre></div>
   </div>
   或者
   <div class="example-contents screen">
<div class="cdata"><pre>
dir | script -arg1 -arg2 -arg3
</pre></div>
   </div>
   此时脚本会死掉，没有输出任何内容。要解决此问题，还需要做一个注册表修改。
   <div class="example-contents screen">
<div class="cdata"><pre>
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer]
&quot;InheritConsoleHandles&quot;=dword:00000001
</pre></div>
   </div>
   有关此问题的更多信息见<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;321788" class="link external" title="Link : http://support.microsoft.com/default.aspx?scid=kb;en-us;321788">&raquo;&nbsp;微软知识库文章：321788</a>。
   从 Windows 10 开始，此设置似乎被颠倒，请参考以下链接 <a href="https://social.msdn.microsoft.com/Forums/en-US/f19d740d-21c8-4dc2-a9ab-d5c0527e932b/nasty-file-association-regression-bug-in-windows-10-console?forum=windowssdk" class="link external" title="Link : https://social.msdn.microsoft.com/Forums/en-US/f19d740d-21c8-4dc2-a9ab-d5c0527e932b/nasty-file-association-regression-bug-in-windows-10-console?forum=windowssdk">&raquo;&nbsp;
      Microsoft forum post</a>。
  </p>
 </p></blockquote>
</div>



  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
 <div class="note">There are no user contributed notes for this page.</div>
</div>
</div></div></body></html>
