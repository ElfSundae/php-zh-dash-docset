<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>发送邮件</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ezmlm-hash.html">? ezmlm_hash</a></li>
      <li style="float: right;"><a href="book.mailparse.html">Mailparse ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mail.html">Mail 函数</a></li>
    <li>发送邮件</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mail" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mail</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mail</span> &mdash; <span class="dc-title">发送邮件</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mail-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mail</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$to</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$subject</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$message</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$additional_headers</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$additional_parameters</code><span class="initializer"> = ?</span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   发送一封电子邮件。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mail-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">to</code></dt>

     <dd>

      <p class="para">
       电子邮件收件人，或收件人列表。
      </p>
      <p class="para">
       本字符串的格式必须符合
       <a href="http://www.faqs.org/rfcs/rfc2822" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2822">&raquo;&nbsp;RFC 2822</a>。例如：
       <ul class="simplelist">
        <li class="member">user@example.com</li>
        <li class="member">user@example.com, anotheruser@example.com</li>
        <li class="member">User &lt;user@example.com&gt;</li>
        <li class="member">User &lt;user@example.com&gt;, Another User &lt;anotheruser@example.com&gt;</li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">subject</code></dt>

     <dd>

      <p class="para">
       电子邮件的主题。
      </p>
      <div class="caution"><strong class="caution">Caution</strong>
       <p class="para">
        本项不能包含任何换行符，否则邮件可能无法正确发送。
       </p>
      </div>
     </dd>

    
    
     <dt>
<code class="parameter">message</code></dt>

     <dd>

      <p class="para">
       所要发送的消息。
      </p>
      <p class="para">
       行之间必须以一个 LF（\n）分隔。每行不能超过 70 个字符。
      </p>
      <div class="caution"><strong class="caution">Caution</strong>
       <p class="para">
        （Windows 下）当 PHP 直接连接到 SMTP 服务器时，如果在一行开头发现一个句号，则会被删掉。要避免此问题，将单个句号替换成两个句号。
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n."</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\n.."</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

       </p>
      </div>
     </dd>

    
    
     <dt>
<code class="parameter">additional_headers</code>（可选项）</dt>

     <dd>

      <p class="para">
       String to be inserted at the end of the email header.
      </p>
      <p class="para">
       This is typically used to add extra headers (From, Cc, and Bcc).
       Multiple extra headers should be separated with a CRLF (\r\n).
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <p class="para">
        When sending mail, the mail <em class="emphasis">must</em> contain
        a <code class="literal">From</code> header. This can be set with the 
        <code class="parameter">additional_headers</code> parameter, or a default
        can be set in <var class="filename">php.ini</var>.
       </p>
       <p class="para">
        Failing to do this will result in an error
        message similar to <code class="literal">Warning: mail(): &quot;sendmail_from&quot; not
        set in php.ini or custom &quot;From:&quot; header missing</code>.
       </p>
      </p></blockquote>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <p class="para">
        If messages are not received, try using a LF (\n) only.
        Some poor quality Unix mail transfer agents replace LF by CRLF
        automatically (which leads to doubling CR if CRLF is used).
        This should be a last resort, as it does not comply with
        <a href="http://www.faqs.org/rfcs/rfc2822" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2822">&raquo;&nbsp;RFC 2822</a>.
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">additional_parameters</code> (optional)</dt>

     <dd>

      <p class="para">
       The <code class="parameter">additional_parameters</code> parameter
       can be used to pass an additional parameter to the program configured
       to use when sending mail using the <code class="literal">sendmail_path</code>
       configuration setting. For example, this can be used to set the
       envelope sender address when using sendmail with the
       <code class="literal">-f</code> sendmail option.
      </p>
      <p class="para">
       The user that the webserver runs as should be added as a trusted user to the
       sendmail configuration to prevent a &#039;X-Warning&#039; header from being added
       to the message when the envelope sender (-f) is set using this method.
       For sendmail users, this file is <var class="filename">/etc/mail/trusted-users</var>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mail-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns <strong><code>true</code></strong> if the mail was successfully accepted for delivery, <strong><code>false</code></strong> otherwise.
  </p>
  <p class="para">
   It is important to note that just because the mail was accepted for delivery,
   it does NOT mean the mail will actually reach the intended destination.
  </p>
 </div>


 

 <div class="refsect1 changelog" id="refsect1-function.mail-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>7.2.0</td>
       <td>
        现在 <code class="parameter">additional_headers</code> 参数开始支持 <span class="type">array</span>。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mail-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2987">
    <p><strong>Example #1 Sending mail.</strong></p>
    <div class="example-contents"><p>
     Using <span class="function"><strong>mail()</strong></span> to send a simple email:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;message<br /></span><span style="color: #0000BB">$message&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Line&nbsp;1\nLine&nbsp;2\nLine&nbsp;3"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;In&nbsp;case&nbsp;any&nbsp;of&nbsp;our&nbsp;lines&nbsp;are&nbsp;larger&nbsp;than&nbsp;70&nbsp;characters,&nbsp;we&nbsp;should&nbsp;use&nbsp;wordwrap()<br /></span><span style="color: #0000BB">$message&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">wordwrap</span><span style="color: #007700">(</span><span style="color: #0000BB">$message</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">70</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Send<br /></span><span style="color: #0000BB">mail</span><span style="color: #007700">(</span><span style="color: #DD0000">'caffinated@example.com'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'My&nbsp;Subject'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2988">
    <p><strong>Example #2 Sending mail with extra headers.</strong></p>
    <div class="example-contents"><p>
     The addition of basic headers, telling the MUA
     the From and Reply-To addresses:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'nobody@example.com'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$subject&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'the&nbsp;subject'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$message&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'hello'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'From:&nbsp;webmaster@example.com'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'Reply-To:&nbsp;webmaster@example.com'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'X-Mailer:&nbsp;PHP/'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">phpversion</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">mail</span><span style="color: #007700">(</span><span style="color: #0000BB">$to</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$headers</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2989">
    <p><strong>Example #3 Sending mail with an additional command line parameter.</strong></p>
    <div class="example-contents"><p>
     The <code class="parameter">additional_parameters</code> parameter
     can be used to pass an additional parameter to the program configured
     to use when sending mail using the <code class="literal">sendmail_path</code>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />mail</span><span style="color: #007700">(</span><span style="color: #DD0000">'nobody@example.com'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'the&nbsp;subject'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'the&nbsp;message'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'-fwebmaster@example.com'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2990">
    <p><strong>Example #4 Sending HTML email</strong></p>
    <div class="example-contents"><p>
     It is also possible to send HTML email with <span class="function"><strong>mail()</strong></span>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;multiple&nbsp;recipients<br /></span><span style="color: #0000BB">$to&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'aidan@example.com'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">',&nbsp;'</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;note&nbsp;the&nbsp;comma<br /></span><span style="color: #0000BB">$to&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'wez@example.com'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;subject<br /></span><span style="color: #0000BB">$subject&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Birthday&nbsp;Reminders&nbsp;for&nbsp;August'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;message<br /></span><span style="color: #0000BB">$message&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'<br />&lt;html&gt;<br />&lt;head&gt;<br />&nbsp;&nbsp;&lt;title&gt;Birthday&nbsp;Reminders&nbsp;for&nbsp;August&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&nbsp;&nbsp;&lt;p&gt;Here&nbsp;are&nbsp;the&nbsp;birthdays&nbsp;upcoming&nbsp;in&nbsp;August!&lt;/p&gt;<br />&nbsp;&nbsp;&lt;table&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Person&lt;/th&gt;&lt;th&gt;Day&lt;/th&gt;&lt;th&gt;Month&lt;/th&gt;&lt;th&gt;Year&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Joe&lt;/td&gt;&lt;td&gt;3rd&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1970&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Sally&lt;/td&gt;&lt;td&gt;17th&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1973&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&lt;/table&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br />'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;send&nbsp;HTML&nbsp;mail,&nbsp;the&nbsp;Content-type&nbsp;header&nbsp;must&nbsp;be&nbsp;set<br /></span><span style="color: #0000BB">$headers&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'MIME-Version:&nbsp;1.0'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'Content-type:&nbsp;text/html;&nbsp;charset=iso-8859-1'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Additional&nbsp;headers<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'To:&nbsp;Mary&nbsp;&lt;mary@example.com&gt;,&nbsp;Kelly&nbsp;&lt;kelly@example.com&gt;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'From:&nbsp;Birthday&nbsp;Reminder&nbsp;&lt;birthday@example.com&gt;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'Cc:&nbsp;birthdayarchive@example.com'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'Bcc:&nbsp;birthdaycheck@example.com'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Mail&nbsp;it<br /></span><span style="color: #0000BB">mail</span><span style="color: #007700">(</span><span style="color: #0000BB">$to</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$headers</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     <blockquote class="note"><p><strong class="note">Note</strong>: 
      <p class="para">
       If intending to send HTML or otherwise Complex mails, it is recommended
       to use the PEAR package <a href="https://pear.php.net/package/Mail" class="link external" title="Link : https://pear.php.net/package/Mail">&raquo;&nbsp;PEAR::Mail</a>.
      </p>
     </p></blockquote>
    </p></div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mail-notes">    
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    The Windows implementation of <span class="function"><strong>mail()</strong></span> differs in many
    ways from the Unix implementation. First, it doesn&#039;t use a local binary
    for composing messages but only operates on direct sockets which means a
    <code class="literal">MTA</code> is needed listening on a network socket (which
    can either on the localhost or a remote machine).
   </p>
   <p class="para">
    Second, the custom headers like
    <code class="literal">From:</code>,
    <code class="literal">Cc:</code>,
    <code class="literal">Bcc:</code> and
    <code class="literal">Date:</code> are
    <em class="emphasis">not</em> interpreted by the
    <code class="literal">MTA</code> in the first place, but are parsed by PHP.
   </p>
   <p class="para">
    As such, the <code class="parameter">to</code> parameter should not be an address
    in the form of &quot;Something &lt;someone@example.com&gt;&quot;. The
    mail command may not parse this properly while talking with 
    the MTA.
   </p>
  </p></blockquote>
  
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    It is worth noting that the <span class="function"><strong>mail()</strong></span> function is not
    suitable for larger volumes of email in a loop. This function opens
    and closes an SMTP socket for each email, which is not very efficient.
   </p>
   <p class="para">
    For the sending of large amounts of email, see the
    <a href="https://pear.php.net/package/Mail" class="link external" title="Link : https://pear.php.net/package/Mail">&raquo;&nbsp;PEAR::Mail</a>, and
    <a href="https://pear.php.net/package/Mail_Queue" class="link external" title="Link : https://pear.php.net/package/Mail_Queue">&raquo;&nbsp;PEAR::Mail_Queue</a> packages.
   </p>
  </p></blockquote>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    The following RFCs may be useful:
    <a href="http://www.faqs.org/rfcs/rfc1896" class="link external" title="Link : http://www.faqs.org/rfcs/rfc1896">&raquo;&nbsp;RFC 1896</a>,
    <a href="http://www.faqs.org/rfcs/rfc2045" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2045">&raquo;&nbsp;RFC 2045</a>,
    <a href="http://www.faqs.org/rfcs/rfc2046" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2046">&raquo;&nbsp;RFC 2046</a>,
    <a href="http://www.faqs.org/rfcs/rfc2047" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2047">&raquo;&nbsp;RFC 2047</a>,
    <a href="http://www.faqs.org/rfcs/rfc2048" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2048">&raquo;&nbsp;RFC 2048</a>,
    <a href="http://www.faqs.org/rfcs/rfc2049" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2049">&raquo;&nbsp;RFC 2049</a>, and
    <a href="http://www.faqs.org/rfcs/rfc2822" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2822">&raquo;&nbsp;RFC 2822</a>.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mail-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imap-mail.html" class="function" rel="rdfs-seeAlso">imap_mail()</a> - Send an email message</span></li>
    <li class="member"><a href="https://pear.php.net/package/Mail" class="link external" title="Link : https://pear.php.net/package/Mail">&raquo;&nbsp;PEAR::Mail</a></li>
    <li class="member"><a href="https://pear.php.net/package/Mail_Mime" class="link external" title="Link : https://pear.php.net/package/Mail_Mime">&raquo;&nbsp;PEAR::Mail_Mime</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125168""></a>
  <div class="note">
   <strong class="user">pangz dot lab at gmail dot com</strong>
   <a href="#125168" class="date">06-Jul-2020 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
* Sending email with attachment<br />
<br />
function sendMail(<br />
&nbsp;&nbsp;&nbsp; string $fileAttachment,<br />
&nbsp;&nbsp;&nbsp; string $mailMessage = MAIL_CONF["mailMessage"],<br />
&nbsp;&nbsp;&nbsp; string $subject&nbsp; &nbsp;&nbsp; = MAIL_CONF["subject"],<br />
&nbsp;&nbsp;&nbsp; string $toAddress&nbsp;&nbsp; = MAIL_CONF["toAddress"],<br />
&nbsp;&nbsp;&nbsp; string $fromMail&nbsp; &nbsp; = MAIL_CONF["fromMail"]<br />
): bool {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $fileAttachment = trim($fileAttachment);<br />
&nbsp;&nbsp;&nbsp; $from&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; = $fromMail;<br />
&nbsp;&nbsp;&nbsp; $pathInfo&nbsp; &nbsp; &nbsp;&nbsp; = pathinfo($fileAttachment);<br />
&nbsp;&nbsp;&nbsp; $attchmentName&nbsp; = "attachment_".date("YmdHms").(<br />
&nbsp;&nbsp;&nbsp; (isset($pathInfo['extension']))? ".".$pathInfo['extension'] : ""<br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $attachment&nbsp; &nbsp; = chunk_split(base64_encode(file_get_contents($fileAttachment)));<br />
&nbsp;&nbsp;&nbsp; $boundary&nbsp; &nbsp; &nbsp; = "PHP-mixed-".md5(time());<br />
&nbsp;&nbsp;&nbsp; $boundWithPre&nbsp; = "\n--".$boundary;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $headers&nbsp;&nbsp; = "From: $from";<br />
&nbsp;&nbsp;&nbsp; $headers&nbsp; .= "\nReply-To: $from";<br />
&nbsp;&nbsp;&nbsp; $headers&nbsp; .= "\nContent-Type: multipart/mixed; boundary=\"".$boundary."\"";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $message&nbsp;&nbsp; = $boundWithPre;<br />
&nbsp;&nbsp;&nbsp; $message&nbsp; .= "\n Content-Type: text/plain; CHARSET=gb2312\n";<br />
&nbsp;&nbsp;&nbsp; $message&nbsp; .= "\n $mailMessage";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $message .= $boundWithPre;<br />
&nbsp;&nbsp;&nbsp; $message .= "\nContent-Type: application/octet-stream; name=\"".$attchmentName."\"";<br />
&nbsp;&nbsp;&nbsp; $message .= "\nContent-Transfer-Encoding: base64\n";<br />
&nbsp;&nbsp;&nbsp; $message .= "\nContent-Disposition: attachment\n";<br />
&nbsp;&nbsp;&nbsp; $message .= $attachment;<br />
&nbsp;&nbsp;&nbsp; $message .= $boundWithPre."--";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return mail($toAddress, $subject, $message, $headers);<br />
}<br />
<br />
* Sending email in html<br />
<br />
function sendHtmlMail(<br />
&nbsp;&nbsp;&nbsp; string $mailMessage = MAIL_CONF["mailMessage"],<br />
&nbsp;&nbsp;&nbsp; string $subject&nbsp; &nbsp;&nbsp; = MAIL_CONF["subject"],<br />
&nbsp;&nbsp;&nbsp; array $toAddress&nbsp; &nbsp; = MAIL_CONF["toAddress"],<br />
&nbsp;&nbsp;&nbsp; string $fromMail&nbsp; &nbsp; = MAIL_CONF["fromMail"]<br />
): bool {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $to&nbsp; &nbsp; &nbsp; &nbsp; = implode(",", $toAddress);<br />
&nbsp;&nbsp;&nbsp; $headers[] = 'MIME-Version: 1.0';<br />
&nbsp;&nbsp;&nbsp; $headers[] = 'Content-type: text/html; charset=iso-8859-1';&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; $headers[] = 'To: '.$to;<br />
&nbsp;&nbsp;&nbsp; $headers[] = 'From: '.$fromMail;&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; return mail($to, $subject, $mailMessage, implode("\r\n", $headers));<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124291""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#124291" class="date">12-Oct-2019 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you notice wrong displayed characters in the email it's because you need to properly set the Content-Type and the Charset in the headers of the email:<br />
<br />
<span class="default">&lt;?php<br />
$headers </span><span class="keyword">= </span><span class="string">'Content-Type: text/plain; CHARSET=gb2312' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Mostly, UTF-8 is your best choice.<br />
<br />
You can set custom headers with the fourth parameter of the mail() function.<br />
<br />
To make the whole thing waterproof, add the following header too:<br />
<br />
<span class="default">&lt;?php<br />
$headers </span><span class="keyword">.= </span><span class="string">'Content-Transfer-Encoding: base64' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Now you can use the combination of UTF-8 and Base64 to properly encode the subject line and the recipient name like this:<br />
<br />
<span class="default">&lt;?php<br />
$subject </span><span class="keyword">= </span><span class="string">'=?UTF-8?B?' </span><span class="keyword">. </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="string">'Test email with German Umlauts ??ü?'</span><span class="keyword">) . </span><span class="string">'?='</span><span class="keyword">;<br />
</span><span class="default">$recipient </span><span class="keyword">= </span><span class="string">'=?UTF-8?B?' </span><span class="keyword">. </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="string">'Margret Müller'</span><span class="keyword">) . </span><span class="string">'?= &lt;recipient@domain.com&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
And don't forget to Base64 encode the email message too:<br />
<br />
<span class="default">&lt;?php<br />
$message </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="string">'This email contains German Umlauts ??ü?.'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
All references are taken from:<br />
https://dev.to/lutvit/how-to-make-the-php-mail-function-awesome-3cii</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124015""></a>
  <div class="note">
   <strong class="user">Mark Simon</strong>
   <a href="#124015" class="date">05-Jul-2019 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is worth noting that you can set up a fake sendmail program using the sendmail_path directive in php.ini.<br />
<br />
Despite the comment in that file, sendmail_path also works for Window. From https://www.php.net/manual/en/mail.configuration.php#ini.sendmail-path:<br />
<br />
This directive works also under Windows. If set, smtp, smtp_port and sendmail_from are ignored and the specified command is executed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121858""></a>
  <div class="note">
   <strong class="user">charles dot fisher at arconic dot com</strong>
   <a href="#121858" class="date">10-Nov-2017 07:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I migrated an application to a platform without a local transport agent (MTA). I did not want to configure an MTA, so I wrote this xxmail function to replace mail() with calls to a remote SMTP server. Hopefully it is of some use.<br />
<br />
function xxmail($to, $subject, $body, $headers)<br />
{<br />
&nbsp;$smtp = stream_socket_client('tcp://smtp.yourmail.com:25', $eno, $estr, 30);<br />
<br />
&nbsp;$B = 8192;<br />
&nbsp;$c = "\r\n";<br />
&nbsp;$s = 'myapp@someserver.com';<br />
<br />
&nbsp;fwrite($smtp, 'helo ' . $_ENV['HOSTNAME'] . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
<br />
&nbsp;// Envelope<br />
&nbsp;fwrite($smtp, 'mail from: ' . $s . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
&nbsp;fwrite($smtp, 'rcpt to: ' . $to . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
&nbsp;fwrite($smtp, 'data' . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
<br />
&nbsp;// Header <br />
&nbsp;fwrite($smtp, 'To: ' . $to . $c); <br />
&nbsp;if(strlen($subject)) fwrite($smtp, 'Subject: ' . $subject . $c); <br />
&nbsp;if(strlen($headers)) fwrite($smtp, $headers); // Must be \r\n (delimited)<br />
&nbsp;fwrite($smtp, $headers . $c); <br />
<br />
&nbsp;// Body<br />
&nbsp;if(strlen($body)) fwrite($smtp, $body . $c); <br />
&nbsp;fwrite($smtp, $c . '.' . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
<br />
&nbsp;// Close<br />
&nbsp;fwrite($smtp, 'quit' . $c);<br />
&nbsp; $junk = fgets($smtp, $B);<br />
&nbsp;fclose($smtp);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121411""></a>
  <div class="note">
   <strong class="user">eeeugeneee</strong>
   <a href="#121411" class="date">21-Jul-2017 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Send mail with minimal requirements from email services.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $encoding </span><span class="keyword">= </span><span class="string">"utf-8"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Preferences for Subject field<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subject_preferences </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"input-charset" </span><span class="keyword">=&gt; </span><span class="default">$encoding</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"output-charset" </span><span class="keyword">=&gt; </span><span class="default">$encoding</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"line-length" </span><span class="keyword">=&gt; </span><span class="default">76</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"line-break-chars" </span><span class="keyword">=&gt; </span><span class="string">"\r\n"<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Mail header<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="string">"Content-type: text/html; charset="</span><span class="keyword">.</span><span class="default">$encoding</span><span class="keyword">.</span><span class="string">" \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">.= </span><span class="string">"From: "</span><span class="keyword">.</span><span class="default">$from_name</span><span class="keyword">.</span><span class="string">" &lt;"</span><span class="keyword">.</span><span class="default">$from_mail</span><span class="keyword">.</span><span class="string">"&gt; \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">.= </span><span class="string">"MIME-Version: 1.0 \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: 8bit \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">.= </span><span class="string">"Date: "</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">"r (T)"</span><span class="keyword">).</span><span class="string">" \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">.= </span><span class="default">iconv_mime_encode</span><span class="keyword">(</span><span class="string">"Subject"</span><span class="keyword">, </span><span class="default">$mail_subject</span><span class="keyword">, </span><span class="default">$subject_preferences</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Send mail<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mail</span><span class="keyword">(</span><span class="default">$mail_to</span><span class="keyword">, </span><span class="default">$mail_subject</span><span class="keyword">, </span><span class="default">$mail_message</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121163""></a>
  <div class="note">
   <strong class="user">php at simoneast dot net</strong>
   <a href="#121163" class="date">31-May-2017 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Often it's helpful to find the exact error message that is triggered by the mail() function. While the function doesn't provide an error directly, you can use error_get_last() when mail() returns false.<br />
<br />
<span class="default">&lt;?php<br />
$success </span><span class="keyword">= </span><span class="default">mail</span><span class="keyword">(</span><span class="string">'example@example.com'</span><span class="keyword">, </span><span class="string">'My Subject'</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">);<br />
if (!</span><span class="default">$success</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$errorMessage </span><span class="keyword">= </span><span class="default">error_get_last</span><span class="keyword">()[</span><span class="string">'message'</span><span class="keyword">];<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
(Tested successfully on Windows which uses SMTP by default, but sendmail on Linux/OSX may not provide the same level of detail.)<br />
<br />
Thanks to https://stackoverflow.com/a/20203870/195835</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121027""></a>
  <div class="note">
   <strong class="user">chris at ocproducts dot com</strong>
   <a href="#121027" class="date">26-Apr-2017 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 'sendmail' executable which PHP uses on Linux/Mac (not Windows) expects "\n" as a line separator.<br />
<br />
This executable is a standard, and emulated by other MTAs.<br />
<br />
"\n" is confirmed required for qmail and postfix, probably also for sendmail and exim but I have not tested.<br />
<br />
If you pass through using "\r\n" as a separator it may appear to work, but your email will be subtly corrupted and some middleware may break. It only works because some systems will clean up your mistake.<br />
<br />
If you are implementing DKIM be very careful, as DKIM checks will fail (at least on popular validation tools) if you screw this up. DKIM must be calculated using "\r\n" but then you must switch it all to "\n" when using the PHP mail function.<br />
<br />
On Windows, however, you should use "\r\n" because PHP is using SMTP in this situation, and hence the normal rules of the SMTP protocol (not the normal rules of Unix piping) apply.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120328""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#120328" class="date">14-Dec-2016 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Security advice: Although it is not documented, for the parameters $to and $subject the mail() function changes at least \r and \n to space. So these parameters are safe against injection of additional headers. But you might want to check $to for commas as these separate multiple addresses and you might not want to send to more than one recipient.<br />
<br />
The crucial part is the $additional_headers parameter. This parameter can't be cleaned by the mail() function. So it is up to you to prevent unwanted \r or \n to be inserted into the values you put in there. Otherwise you just created a potential spam distributor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108669""></a>
  <div class="note">
   <strong class="user">pavel.lint at vk.com</strong>
   <a href="#108669" class="date">16-May-2012 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a small handy function I use to send email in UTF-8.<br />
<br />
&nbsp;<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mail_utf8</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">$from_user</span><span class="keyword">, </span><span class="default">$from_email</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="string">'(No subject)'</span><span class="keyword">, </span><span class="default">$message </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">)<br />
&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$from_user </span><span class="keyword">= </span><span class="string">"=?UTF-8?B?"</span><span class="keyword">.</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$from_user</span><span class="keyword">).</span><span class="string">"?="</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="string">"=?UTF-8?B?"</span><span class="keyword">.</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">).</span><span class="string">"?="</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="string">"From: </span><span class="default">$from_user</span><span class="string"> &lt;</span><span class="default">$from_email</span><span class="string">&gt;\r\n"</span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"MIME-Version: 1.0" </span><span class="keyword">. </span><span class="string">"\r\n" </span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Content-type: text/html; CHARSET=gb2312" </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">; <br />
<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">mail</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">); <br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108498""></a>
  <div class="note">
   <strong class="user">rexlorenzo at gmail dot com</strong>
   <a href="#108498" class="date">02-May-2012 01:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful to not put extra spaces for the $headers variable.<br />
<br />
For example, this didn't work on our servers:<br />
<br />
$headers = "From: $from \r\n Bcc: $bcc \r\n";<br />
<br />
But this did:<br />
<br />
$headers = "From: $from\r\nBcc: $bcc\r\n";<br />
<br />
Notice the removal of the spaces around the first \r\n.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107524""></a>
  <div class="note">
   <strong class="user">Max AT</strong>
   <a href="#107524" class="date">15-Feb-2012 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To define a mail sensitivity you have to put this line in the headers:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $headers </span><span class="keyword">= </span><span class="string">"MIME-Version: 1.0\n" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">.= </span><span class="string">"Content-Type: text/html; charset=\"iso-8859-1\"\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">.= </span><span class="string">"Sensitivity: Personal\n"</span><span class="keyword">;<br />
<br />
&nbsp;</span><span class="default">$status&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">mail</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">,</span><span class="default">$headers</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
Possible Options:<br />
Sensitivity: Normal, Personal, Private and Company-Confidential<br />
<br />
These will be recognised and handled in Outlook, Thunderbird and others.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107321""></a>
  <div class="note">
   <strong class="user">ABOMB</strong>
   <a href="#107321" class="date">30-Jan-2012 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having delivery issues from this function to Gmail, Yahoo, AOL, etc.&nbsp; I used the notes here to figure that you need to be setting your Return-Path to a valid email to catch bounces.&nbsp; There are two extra delivery gotchas on top of that:<br />
<br />
1) The domain in the email used in the -f option in the php.ini sendmail parameter or in the mail() extra parameters field, needs to have a valid SPF record for the domain (in DNS as a "TXT" record type for sure and add an additional&nbsp; "SPF" type record if possible).&nbsp; Why? That's header field being used for spam checks.<br />
<br />
2) You should also use a domain key or DKIM.&nbsp; The trick here is that the domain key/DKIM is case sensitive!&nbsp; I used Cpanel to create my domain key which automatically used all lowercase domain names in the key creation.&nbsp; I found when&nbsp; sending email and using a camel case "-f account@MyDomainHere.Com" option, my key was not accepted.&nbsp; However it was accepted when I used "-f account@mydomainhere.com".<br />
<br />
There are many other factors that can contribute to mail not getting to inboxes, including your own multiple failed testing attempts, so I suggest you consult each site's guidelines and don't ask me for help.&nbsp; These are just the couple technical issues that helped my case.<br />
<br />
I hope this saves someone some time and headaches...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98775""></a>
  <div class="note">
   <strong class="user">Porjo</strong>
   <a href="#98775" class="date">06-Jul-2010 11:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure you enclose \r\n in double quotes (not single quotes!) so that PHP can translate that into the correct linefeed code</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59773""></a>
  <div class="note">
   <strong class="user">Ben Cooke</strong>
   <a href="#59773" class="date">15-Dec-2005 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that there is a big difference between the behavior of this function on Windows systems vs. UNIX systems. On Windows it delivers directly to an SMTP server, while on a UNIX system it uses a local command to hand off to the system's own MTA.
<br />

<br />
The upshot of all this is that on a Windows system your&nbsp; message and headers must use the standard line endings \r\n as prescribed by the email specs. On a UNIX system the MTA's "sendmail" interface assumes that recieved data will use UNIX line endings and will turn any \n to \r\n, so you must supply only \n to mail() on a UNIX system to avoid the MTA hypercorrecting to \r\r\n.
<br />

<br />
If you use plain old \n on a Windows system, some MTAs will get a little upset. qmail in particular will refuse outright to accept any message that has a lonely \n without an accompanying \r.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50544""></a>
  <div class="note">
   <strong class="user">php dot net at schrecktech dot com</strong>
   <a href="#50544" class="date">02-Mar-2005 04:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When sending MIME email make sure you follow the documentation with the "70" characters per line...you may end up with missing characters...and that is really hard to track down...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
