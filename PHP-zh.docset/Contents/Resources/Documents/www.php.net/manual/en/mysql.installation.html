<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysql.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="mysql.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mysql.setup.html">安装/配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysql.installation" class="section">
 <h2 class="title">安装</h2>
 
 <div class="warning"><strong class="warning">Warning</strong>
  <p class="para">本扩展自 PHP 5.5.0
起已废弃，并在自 PHP 7.0.0 开始被移除。应使用 <a href="book.mysqli.html" class="link">MySQLi</a>
或 <a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> 扩展来替换之。参见 <a href="mysqlinfo.api.choosing.html" class="link">MySQL：选择 API</a> 
指南来获取更多信息。用以替代本函数的有：</p>
 </div>

 <p class="para" id="mysql.configure">
  编译时，只要使用
  <strong class="option configure">--with-mysql[=DIR]</strong>
  配置选项即可，其中可选的
  <code class="literal">[DIR]</code> 指向 MySQL 的安装目录。
 </p>
 <p class="para">
  虽然本 MySQL 扩展库兼容 MySQL 4.1.0
  及其以后版本，但是它不支持这些版本提供的额外功能。要使用这些功能，请使用
  <a href="book.mysqli.html" class="link">MySQLi</a> 扩展库。
 </p>
 <p class="para">
  如果要同时安装 mysql 扩展库和 mysqli 扩展库，必须使用同一个客户端库以避免任何冲突。
 </p>

 <div class="section" id="mysql.installation.linux">
  <h2 class="title">在 Linux 系统下安装</h2>
  <p class="para">
   Note: <code class="literal">[DIR]</code> is the path to the MySQL client library 
   files (<em class="emphasis">headers and libraries</em>), which can be downloaded from 
   <a href="http://www.mysql.com/" class="link external" title="Link : http://www.mysql.com/">&raquo;&nbsp;MySQL</a>.
  </p>
  <table class="doctable table">
   <caption><strong>ext/mysql compile time support matrix</strong></caption>
   
    <thead>
     <tr>
      <th>PHP 版本</th>
      <th>默认</th>
      <th>配置选项: <a href="mysqlnd.overview.html" class="link">mysqlnd</a></th>
      <th>配置选项: <code class="literal">libmysql</code></th>
      <th>更新日志</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>4.x.x</td>
      <td>libmysql</td>
      <td>不适用</td>
      <td><strong class="option configure">--without-mysql</strong> to disable</td>
      <td>MySQL enabled by default, MySQL client libraries are bundled</td>
     </tr>

     <tr>
      <td>5.0.x, 5.1.x, 5.2.x</td>
      <td>libmysql</td>
      <td>不适用</td>
      <td><strong class="option configure">--with-mysql=[DIR]</strong></td>
      <td>
       MySQL is no longer enabled by default, and the MySQL client libraries
       are no longer bundled
      </td>
     </tr>

     <tr>
      <td>5.3.x</td>
      <td>libmysql</td>
      <td><strong class="option configure">--with-mysql=mysqlnd</strong></td>
      <td><strong class="option configure">--with-mysql=[DIR]</strong></td>
      <td>mysqlnd is now available</td>
     </tr>

     <tr>
      <td>5.4.x</td>
      <td>mysqlnd</td>
      <td><strong class="option configure">--with-mysql</strong></td>
      <td><strong class="option configure">--with-mysql=[DIR]</strong></td>
      <td>mysqlnd is now the default</td>
     </tr>

    </tbody>
   
  </table>

 </div>

 <div class="section" id="mysql.installation.windows">
  <h2 class="title">在 Windows 系统下安装</h2>
  <div class="section">
   <h2 class="title">PHP 4</h2>
   <p class="para">
    PHP MySQL 扩展已经编译入 PHP。
   </p>
  </div>
  <div class="section">
   <h2 class="title">PHP 5+</h2>
   <p class="para">
    MySQL 默认未启用，因此必须在 <var class="filename">php.ini</var> 中激活
    <var class="filename">php_mysql.dll</var> 动态连接库。此外，PHP
    还需要访问 MySQL 客户端连接库。PHP 的 Windows
    发行版包括了一个
    <var class="filename">libmysql.dll</var>，为了让 PHP 能和
    MySQL 对话，此文件必须放在 Windows 的系统路径
    <var class="envar">PATH</var> 中。怎样做见 FAQ
    中的"<a href="faq.installation.html#faq.installation.addtopath" class="link">怎样把 PHP
    目录加入到 Windows <var class="varname">PATH</var>中</a>"。尽管将
    <var class="filename">libmysql.dll</var> 拷贝到 Windows
    系统目录中也可以（因为系统目录默认在系统路径
    <var class="envar">PATH</var> 中），但不推荐这样做。
   </p>
   <p class="para">
    要激活任何 PHP 扩展库（例如
    <var class="filename">php_mysql.dll</var>），PHP 指令
    <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a>
    要被设为 PHP 扩展库所在的目录。参见<a href="install.windows.manual.html" class="link">手工 Windows
    安装指南</a>。PHP 5 下 extension_dir 取值的一个例子是
    <code class="literal">c:\php\ext</code>。
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     如果启动 web 服务器时出现类似如下的错误：<code class="literal">&quot;Unable
     to load dynamic library &#039;./php_mysql.dll&#039;&quot;</code>，这是因为系统找不到
     <var class="filename">php_mysql.dll</var> 和／或
     <var class="filename">libmysql.dll</var>。
    </p>
   </p></blockquote>
  </div>
  <div class="section">
   <h2 class="title">PHP 5.3.0+</h2>
   <p class="para">
    The <a href="mysqlnd.overview.html" class="link">MySQL Native Driver</a> is enabled by
    default. Include <var class="filename">php_mysql.dll</var>, but <var class="filename">libmysql.dll</var>
    is no longer required or used.
   </p>
  </div>
 </div>

 <div class="section" id="mysql.installation.notes">
  <h2 class="title">MySQL 安装注意事项</h2>
   <div class="warning"><strong class="warning">Warning</strong>
    <p class="para">
     当同时加在本扩展库和 recode 扩展库时 PHP 可能会崩溃。更多信息见
     <a href="ref.recode.html" class="link">recode</a> 扩展库。
    </p>
   </div>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     如果需要不同于
     <em class="emphasis">latin</em>（默认值）的字符集，必须安装外部的（非绑定的）已编译入所需字符集支持的
     libmysql。
    </p>
   </p></blockquote>
 </div>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="110819""></a>
  <div class="note">
   <strong class="user">mail dot umlcat at gee mail dot com</strong>
   <a href="#110819" class="date">11-Dec-2012 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Could not install mysql, on windows, had several conflicts or bugs.<br />
<br />
In order to solve it:<br />
<br />
* Used the "libmysql.dll" provided by PHP zip files, not the one that comes with Mysql, the mysql file had to be moved or deleted from its folder. Put it on the "apache/bin" folder, altought some use it in "windows" folder.<br />
<br />
* Originally, moved "*mysql*.dll" files from its extension folder, and returned back.<br />
<br />
* enabled mysql driver extensions in the "php.ini" file, but also enabled some extensions, that seemed not to be required, but, it did, like "php_openssl.dll" or "php_pdo.dll" on an early version of php.<br />
<br />
Added the "PHPIniDir xxx"" to the "httpd.conf" apache config. file, where xxx is the path to the folder where the "php.ini" file is located, and make sure its the same.<br />
<br />
Be warned, that this fixes, may help or not, for your installation, since there are many ways to configure the same thing (to solve a problem).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105100""></a>
  <div class="note">
   <strong class="user">Steve in Weston-Super-Mare</strong>
   <a href="#105100" class="date">27-Jul-2011 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problems when moving from a version of PHP that used the isapi dll to the fast cgi version. The script to register the script maps compained that there was already a script map in place.<br />
<br />
I went to the IIS control panel, right clicked on websites and removed the php association in the Home Directory | Configuration screen.<br />
<br />
However, the fastcgi script still complained about existing script map. Finally I tracked it down, I had to right click on Default Web Site and clear out the php mappings from there too.<br />
<br />
Then it all worked, except that for some strange reason, the php.ini file that gets picked up is the one from my old PHP directory, not the latest upgrade one. But this can be detected by running phpinfo which shows the loaded php.ini file so I knew which one to amend with the fastcgi options.<br />
<br />
Bit of a hassle to figure it all out but it does work in the end.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103741""></a>
  <div class="note">
   <strong class="user">o dot kochetilov at gmail dot com</strong>
   <a href="#103741" class="date">30-Apr-2011 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that libmySQL.dll in MySQL bin directory should be renamed in order to use right library (that comes with PHP).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99763""></a>
  <div class="note">
   <strong class="user">buzzr515 at gmx dot de</strong>
   <a href="#99763" class="date">03-Sep-2010 09:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i've experienced a similar (if not the same) problem.<br />
<br />
to enable the mysql_... and mysqli_... funtionality, i opened the php.ini file to uncomment the following lines:<br />
;extension=php_mysql.dll<br />
;extension=php_mysqli.dll<br />
;extension=php_pdo_mysql.dll<br />
<br />
but phpinfo() still stated that no mysql extensions were loaded.<br />
i tried the fixes and suggestions above with no success.<br />
so i invoked the windows shell and typed ("Path" environment variable set to the PHP &amp; MySQL directories):<br />
php.exe -m<br />
<br />
this returned the following error: "PHP Startup: Unable to load dynamic library 'C:\php5\php_mysql.dll' - Module not found."<br />
<br />
this told me that PHP didn't recognize what i thought was the extensions directory. it searched all other places first (sys-dir, workin'-dir, the MySQL "bin" dir because of the "Path" variable set, and even a curious directory "C:\php5" that doesn't even exist on my mashine) but not the expected "ext" directory.<br />
<br />
so the fix was to go to "php.ini" again and uncomment the following line:<br />
;extension_dir="ext"<br />
<br />
this fixed it for me.<br />
so if module loading is done improperly, first of all check the "Path" environment variable and the "php.ini" file - especially the "extension_dir" config value - and check if all values are set to their correct values.<br />
<br />
hope this helps any1.<br />
<br />
----------------------------------------<br />
OS: Win7 Ultimate x86<br />
Apache v2.2.16<br />
PHP v5.3.3<br />
MySQL v5.1.50</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97656""></a>
  <div class="note">
   <strong class="user">heneryville at gmail dot com</strong>
   <a href="#97656" class="date">30-Apr-2010 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I believe that this is happens especially with Windows 7.&nbsp; As far I I've been able to tell XP and Vista come with this line enabled, but windows 7 comments it out and notes that the DNS will handle this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91662""></a>
  <div class="note">
   <strong class="user">amatsak at gmail dot com</strong>
   <a href="#91662" class="date">22-Jun-2009 02:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have experienced exactly the same problem as flo_stefi at yahoo dot com below. It appears that instead of loading libmysql.dll that came with the PHP package, the PHP engine was loading libmySQL.dll located in MySQL's bin directory, which was causing Apache to crash.<br />
<br />
I fixed the problem by renaming MySQL's libmySQL.dll into libmySQL_renamed.dll. Now PHP loads the library that came with its package and everything works fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83134""></a>
  <div class="note">
   <strong class="user">jonnus</strong>
   <a href="#83134" class="date">12-May-2008 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In windows systems, the same error "unable to load dynamic library php_mysql.dll" will happen, if there's an old version of the file in the "windows\system32" folder.<br />
Either remove it or update it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
