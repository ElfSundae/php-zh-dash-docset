<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>运行时配置</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="session.installation.html">? 安装</a></li>
      <li style="float: right;"><a href="session.resources.html">资源类型 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="session.setup.html">安装／配置</a></li>
    <li>运行时配置</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="session.configuration" class="section"> 
 <h2 class="title">运行时配置</h2>
 <p class="simpara">
这些函数的行为受 <var class="filename">php.ini</var> 中的设置影响。
</p>
 <p class="para">
 <table class="doctable table">
  <caption><strong>会话配置选项</strong></caption>
  
   <thead>
    <tr>
     <th>名字</th>
     <th>默认</th>
     <th>可修改范围</th>
     <th>更新日志</th>
    </tr>

   </thead>

   <tbody class="tbody">
    <tr>
     <td><a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.name" class="link">session.name</a></td>
     <td>&quot;PHPSESSID&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.save-handler" class="link">session.save_handler</a></td>
     <td>&quot;files&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.auto-start" class="link">session.auto_start</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a></td>
     <td>&quot;100&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-maxlifetime" class="link">session.gc_maxlifetime</a></td>
     <td>&quot;1440&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.serialize-handler" class="link">session.serialize_handler</a></td>
     <td>&quot;php&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-lifetime" class="link">session.cookie_lifetime</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-path" class="link">session.cookie_path</a></td>
     <td>&quot;/&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-domain" class="link">session.cookie_domain</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-secure" class="link">session.cookie_secure</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-httponly" class="link">session.cookie_httponly</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 5.2.0 起有效</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-samesite" class="link">session.cookie_samesite</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.3.0 起有效</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-strict-mode" class="link">session.use_strict_mode</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 5.5.2 起有效</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-cookies" class="link">session.use_cookies</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-only-cookies" class="link">session.use_only_cookies</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.referer-check" class="link">session.referer_check</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cache-limiter" class="link">session.cache_limiter</a></td>
     <td>&quot;nocache&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cache-expire" class="link">session.cache_expire</a></td>
     <td>&quot;180&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-trans-sid" class="link">session.use_trans_sid</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.trans-sid-tags" class="link">session.trans_sid_tags</a></td>
     <td>&quot;a=href,area=href,frame=src,form=&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.trans-sid-hosts" class="link">session.trans_sid_hosts</a></td>
     <td><em>$_SERVER[&#039;HTTP_HOST&#039;]</em></td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.sid-length" class="link">session.sid_length</a></td>
     <td>&quot;32&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.sid-bits-per-character" class="link">session.sid_bits_per_character</a></td>
     <td>&quot;4&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.enabled" class="link">session.upload_progress.enabled</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.cleanup" class="link">session.upload_progress.cleanup</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.prefix" class="link">session.upload_progress.prefix</a></td>
     <td>&quot;upload_progress_&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.name" class="link">session.upload_progress.name</a></td>
     <td>&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.freq" class="link">session.upload_progress.freq</a></td>
     <td>&quot;1%&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.min-freq" class="link">session.upload_progress.min_freq</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>自 PHP 5.4.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.lazy-write" class="link">session.lazy_write</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.0.0 起有效。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.url-rewriter.tags" class="link">url_rewriter.tags</a></td>
     <td>&quot;a=href,area=href,frame=src,form=&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起，session 功能不再使用此选项。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-function" class="link">session.hash_function</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起移除。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-bits-per-character" class="link">session.hash_bits_per_character</a></td>
     <td>&quot;4&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起移除。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.entropy-file" class="link">session.entropy_file</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起移除。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.entropy-length" class="link">session.entropy_length</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 7.1.0 起移除。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.bug-compat-42" class="link">session.bug_compat_42</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 5.4.0 起移除。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.bug-compat-warn" class="link">session.bug_compat_warn</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>自 PHP 5.4.0 起移除。</td>
    </tr>

   </tbody>
  
 </table>

 有关 PHP_INI_* 样式的更多详情与定义，见 <a href="configuration.changes.modes.html" class="xref">配置可被设定范围</a>。
 </p>
 <p class="para">
  会话管理系统支持许多配置选项，可以在自己的 <var class="filename">php.ini</var> 文件中设定。这里只是个简短的概览。
 <dl>


  
   <dt id="ini.session.save-handler">
    <code class="parameter">session.save_handler</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.save_handler</em> 定义了来存储和获取与会话关联的数据的处理器的名字。默认为
     <em>files</em>。Note that individual extensions may register
     their own <em>save_handler</em>s; registered handlers can be
     obtained on a per-installation basis by referring to
     <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span>. 参见
     <span class="function"><a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a></span>。
    </span>
   </dd>

  

  
   <dt id="ini.session.save-path">
    <code class="parameter">session.save_path</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.save_path</em> 定义了传递给存储处理器的参数。如果选择了默认的
     files 文件处理器，则此值是创建文件的路径。默认为
     <em>/tmp</em>。参见
     <span class="function"><a href="function.session-save-path.html" class="function">session_save_path()</a></span>。
    </span>
    <p class="para">
     此指令还有一个可选的 <em>N</em> 参数来决定会话文件分布的目录深度。例如，设定为
     <em>&#039;5;/tmp&#039;</em> 将使创建的会话文件和路径类似于
     <em>/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If</em>。要使用
     <em>N</em> 参数，必须在使用前先创建好这些目录。在 <var class="filename">ext/session</var>
     目录下有个小的 shell 脚本名叫 <var class="filename">mod_files.sh</var>，windows 版本是 <var class="filename">mod_files.bat</var>
     可以用来做这件事。此外注意如果使用了 <em>N</em> 参数并且大于
     0，那么将不会执行自动垃圾回收，更多信息见 <var class="filename">php.ini</var>。另外如果用了 <em>N</em>
     参数，要确保将 <em>session.save_path</em> 的值用双引号 &quot;quotes&quot;
     括起来，因为分隔符分号（ <em>;</em>）在 <var class="filename">php.ini</var> 中也是注释符号。
    </p>
    <p class="para">
     文件储存模块默认使用 mode 600 创建文件。通过 修改可选参数 <em>MODE</em> 来改变这种默认行为：
     <em>N;MODE;/path</em> ，其中 <em>MODE</em> 是 mode 的八进制表示。 
      <em>MODE</em> 设置不影响进程的掩码(umask)。
    </p>
    <div class="warning"><strong class="warning">Warning</strong>
     <p class="para">
      如果将此设定为一个全局可读的目录，例如
      <var class="filename">/tmp</var>（默认值），服务器上的其他用户有可能通过该目录的文件列表破解会话。
     </p>
    </div>
    <div class="caution"><strong class="caution">Caution</strong>
     <p class="para">
      使用以上描述的可选目录层级参数 <em>N</em> 时请注意，对于绝大多数站点，大于1或者2的值会不太合适&mdash;&mdash;因为这需要创建大量的目录：例如，值设置为 3 需要在文件系统上创建 <em>64^3</em> 个目录，将浪费很多空间和 inode。
     </p>
     <p class="para">
      仅仅在绝对肯定站点足够大时，才可以设置 <em>N</em> 大于2。
     </p>
    </div>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      在 PHP 4.3.6 之前，Windows 用户必须修改此选项以使用 PHP 的会话函数。必须指定一个合法路径，例如：<var class="filename">c:/temp</var>。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.name">
    <code class="parameter">session.name</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.name</em> 指定会话名以用做 cookie 的名字。只能由字母数字组成，默认为
     <em>PHPSESSID</em>。参见 <span class="function"><a href="function.session-name.html" class="function">session_name()</a></span>。
    </span>
   </dd>

  
  
  
   <dt id="ini.session.auto-start">
    <code class="parameter">session.auto_start</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.auto_start</em> 指定会话模块是否在请求开始时自动启动一个会话。默认为
     <em>0</em>（不启动）。
    </span>
   </dd>

  

  
   <dt id="ini.session.serialize-handler">
    <code class="parameter">session.serialize_handler</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.serialize_handler</em> 定义用来序列化／解序列化的处理器名字。
     当前支持 PHP 序列化格式 (名为 <em>php_serialize</em>)、 PHP
      PHP 内部格式 (名为 <em>php</em> 及
     <em>php_binary</em>) 和 WDDX  (名为
     <em>wddx</em>)。
     
     如果 PHP 编译时加入了 <a href="ref.wddx.html" class="link">WDDX
     支持</a>，则只能用 WDDX。
     自 PHP 5.5.4 起可以使用 <em>php_serialize</em>。 <em>php_serialize</em> 在内部简单地直接使用 
     serialize/unserialize 函数，并且不会有 <em>php</em>
     和 <em>php_binary</em> 所具有的限制。
     
     使用较旧的序列化处理器导致 $_SESSION 的索引既不能是数字也不能包含特殊字符(<em>|</em> and <em>!</em>) 。
     
     使用 <em>php_serialize</em> 避免脚本退出时，数字及特殊字符索引导致出错。
     
     默认使用
      <em>php</em>。
    </span>
   </dd>

  

  
   <dt id="ini.session.gc-probability">
    <code class="parameter">session.gc_probability</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_probability</em> 与
     <em>session.gc_divisor</em> 合起来用来管理 gc（garbage collection
     垃圾回收）进程启动的概率。默认为 <em>1</em>。详见 <a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a>。
    </span>
   </dd>

  

  
   <dt id="ini.session.gc-divisor">
    <code class="parameter">session.gc_divisor</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_divisor</em> 与
     <em>session.gc_probability</em> 合起来定义了在每个会话初始化时启动
     gc（garbage collection 垃圾回收）进程的概率。此概率用
     gc_probability/gc_divisor 计算得来。例如 1/100
     意味着在每个请求中有 1% 的概率启动 gc 进程。<em>session.gc_divisor</em>
     默认为 <em>100</em>。
    </span>
   </dd>

  
  
  
   <dt id="ini.session.gc-maxlifetime">
    <code class="parameter">session.gc_maxlifetime</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_maxlifetime</em> 指定过了多少秒之后数据就会被视为"垃圾"并被清除。
    垃圾搜集可能会在 session 启动的时候开始（
     取决于<a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a> 和
     <a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a>）。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      如果不同的脚本具有不同的
      <em>session.gc_maxlifetime</em>
      数值但是共享了同一个地方存储会话数据，则具有最小数值的脚本会清理数据。此情况下，与
      <a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a> 一起使用本指令。
     </p>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.referer-check">
    <code class="parameter">session.referer_check</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.referer_check</em> 包含有用来检查每个 HTTP
     Referer 的子串。如果客户端发送了 Referer
     信息但是在其中并未找到该子串，则嵌入的会话 ID 会被标记为无效。默认为空字符串。
    </span>
   </dd>

  

  
   <dt id="ini.session.entropy-file">
    <code class="parameter">session.entropy_file</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.entropy_file</em> 给出了一个到外部资源（文件）的路径，该资源将在会话
     ID 创建进程中被用作附加的熵值资源。例如在许多 Unix 系统下都可以用
     <em>/dev/random</em> 或 <em>/dev/urandom</em>。
    </span>
    <span class="simpara">
     在 Windows 上自 PHP 5.3.3 起加入了此功能。
     设置  <em>session.entropy_length</em> 为非零的值将使 PHP 使用 Windows Random API 作为熵值源。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      自 PHP 5.4.0 起，默认情况下， <em>session.entropy_file</em> 在 <em>/dev/urandom</em> 或 <em>/dev/arandom</em> 可用的时候使用它们。
      在 PHP 5.3.0 中此指令默认留空。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.entropy-length">
    <code class="parameter">session.entropy_length</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.entropy_length</em> 指定了从上面的文件中读取的字节数。默认为
     <em>0</em>（禁用）。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-strict-mode">
    <code class="parameter">session.use_strict_mode</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_strict_mode</em> specifies whether the
     module will use strict session id mode. If this mode is enabled,
     the module does not accept uninitialized session ID. If uninitialized
     session ID is sent from browser, new session ID is sent to browser.
     Applications are protected from session fixation via session adoption
     with strict mode.
     Defaults to <em>0</em> (disabled).
    </span>
   </dd>

  

  
   <dt id="ini.session.use-cookies">
    <code class="parameter">session.use_cookies</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_cookies</em> 指定是否在客户端用
     cookie 来存放会话 ID。默认为 <em>1</em>（启用）。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-only-cookies">
    <code class="parameter">session.use_only_cookies</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_only_cookies</em> 指定是否在客户端<em class="emphasis">仅仅</em>使用 cookie 来存放会话 ID。。启用此设定可以防止有关通过
     URL 传递会话 ID 的攻击。自PHP 5.3.0开始，默认值为<em>1</em>（启用）
    </span>
   </dd>

  


  
   <dt id="ini.session.cookie-lifetime">
    <code class="parameter">session.cookie_lifetime</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_lifetime</em> 以秒数指定了发送到浏览器的
     cookie 的生命周期。值为 0
     表示"直到关闭浏览器"。默认为
     <em>0</em>。参见
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> 和
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para"> 
      The expiration timestamp is set relative to the server time, which is
      not necessarily the same as the time in the client&#039;s browser.
     </p>
    </p></blockquote> 
   </dd>

  

  
   <dt id="ini.session.cookie-path">
    <code class="parameter">session.cookie_path</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_path</em> 指定了要设定会话 cookie 的路径。默认为
     <em>/</em>。参见
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> 和
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-domain">
    <code class="parameter">session.cookie_domain</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_domain</em> 指定了要设定会话 cookie
     的域名。默认为无，表示根据 cookie 规范产生 cookie 的主机名。参见
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> 和
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-secure">
    <code class="parameter">session.cookie_secure</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_secure</em> 指定是否仅通过安全连接发送
     cookie。默认为 <em>off</em>。此设定是 PHP 4.0.4 添加的。参见
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> 和
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-httponly">
    <code class="parameter">session.cookie_httponly</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     Marks the cookie as accessible only through the HTTP protocol. This means
     that the cookie won&#039;t be accessible by scripting languages, such as
     JavaScript. This setting can effectively help to reduce identity theft
     through XSS attacks (although it is not supported by all browsers).
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-samesite">
    <code class="parameter">session.cookie_samesite</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     Allows servers to assert that a cookie ought not to be sent along with
     cross-site requests. This assertion allows user agents to mitigate the risk
     of cross-origin information leakage, and provides some protection against
     cross-site request forgery attacks. Note that this is not supported by all
     browsers.
     An empty value means that no SameSite cookie attribute will be set.
     <em>Lax</em> and <em>Strict</em> mean that the cookie
     will not be sent cross-domain for POST requests; <em>Lax</em>
     will sent the cookie for cross-domain GET requests, while <em>Strict</em>
     will not.
    </span>
   </dd>

  

  
   <dt id="ini.session.cache-limiter">
    <code class="parameter">session.cache_limiter</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cache_limiter</em>
     指定会话页面所使用的缓冲控制方法（none/nocache/private/private_no_expire/public）。默认为
     <em>nocache</em>。参见
     <span class="function"><a href="function.session-cache-limiter.html" class="function">session_cache_limiter()</a></span>。
    </span>
   </dd>

  


  
   <dt id="ini.session.cache-expire">
    <code class="parameter">session.cache_expire</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cache_expire</em> 以分钟数指定缓冲的会话页面的存活期，此设定对
     nocache 缓冲控制方法无效。默认为 <em>180</em>。参见
     <span class="function"><a href="function.session-cache-expire.html" class="function">session_cache_expire()</a></span>。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-trans-sid">
    <code class="parameter">session.use_trans_sid</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_trans_sid</em> 指定是否启用透明 SID
     支持。默认为 <em>0</em>（禁用）。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      基于 URL 的会话管理比基于 cookie 的会话管理有更多安全风险。例如用户有可能通过
      email 将一个包含有效的会话 ID 的 URL 发给他的朋友，或者用户总是有可能在收藏夹中存有一个包含会话
      ID 的 URL 来以同样的会话 ID 去访问站点。
     </span>
     <span class="simpara">
      自 PHP 7.1.0 开始，透明 SID 开始使用完整的 URL 绝对路径，例如 https://php.net/。
      在此之前 PHP 只会使用相对路径。使用 <a href="session.configuration.html#ini.session.trans-sid-hosts" class="link">session.trans_sid_hosts</a> 定义重写的目标 host。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.trans-sid-tags">
    <code class="parameter">session.trans_sid_tags</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.trans_sid_tags</em> specifies which HTML tags
     are rewritten to include session id when transparent sid support
     is enabled. Defaults to
     <em>a=href,area=href,frame=src,input=src,form=</em>
    </span>
    <span class="simpara">
     <em>form</em> is special tag. <em>&lt;input hidden=&quot;session_id&quot; name=&quot;session_name&quot;&gt;</em>
     is added as form variable.
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      Before PHP 7.1.0, <a href="session.configuration.html#ini.url-rewriter.tags" class="link">url_rewriter.tags</a>
      was used for this purpose. Since PHP 7.1.0, <em>fieldset</em> 
      is no longer considered as special tag.
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.trans-sid-hosts">
    <code class="parameter">session.trans_sid_hosts</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.trans_sid_hosts</em> specifies which hosts
     are rewritten to include session id when transparent sid support
     is enabled. Defaults to <em>$_SERVER[&#039;HTTP_HOST&#039;]</em>
     Multiple hosts can be specified by &quot;,&quot;, no space is allowed
     between hosts. e.g. <em>php.net,wiki.php.net,bugs.php.net</em>
    </span>
   </dd>

  
  
  
   <dt id="ini.session.bug-compat-42">
    <code class="parameter">session.bug_compat_42</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     PHP 4.2.3 以及更低版本有一个未公开的特性／错误，它允许用户在
     <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
     被禁用的情况下在全局范围内初始化一个会话变量。PHP 4.3.0
     及更高版本会在使用此特性时并且启用了
     <a href="session.configuration.html#ini.session.bug-compat-warn" class="link">session.bug_compat_warn</a>
     时发出警告。此特性／错误可以通过关闭此选项而禁用。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
       PHP 5.4.0 中已经移除。
     </span>
    </p></blockquote>
   </dd>

  
  
  
   <dt id="ini.session.bug-compat-warn">
    <code class="parameter">session.bug_compat_warn</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     PHP 4.2.3 以及更低版本有一个未公开的特性／错误，它允许用户在
     <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
     被禁用的情况下在全局范围内初始化一个会话变量。PHP 4.3.0
     及更高版本会在使用此特性时并且同时启用了
     <a href="session.configuration.html#ini.session.bug-compat-42" class="link">session.bug_compat_42</a> 和
     <a href="session.configuration.html#ini.session.bug-compat-warn" class="link">session.bug_compat_warn</a>
     时发出警告。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
       PHP 5.4.0 中已经移除。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.sid-length">
    <code class="parameter">session.sid_length</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.sid_length</em> allows you to specify the
     length of session ID string. Session ID length can be between 22
     to 256.
    </span>
    <span class="simpara">
     The default is 32. If you need compatibility you may specify 32,
     40, etc. Longer session ID is harder to guess. At least 32 chars
     are recommended.
    </span>
    <div class="tip"><strong class="tip">Tip</strong>
     <p class="para">
      Compatibility Note: Use 32 instead of
      <em>session.hash_function</em>=0 (MD5) and
      <em>session.hash_bits_per_character</em>=4,
      <em>session.hash_function</em>=1 (SHA1) and
      <em>session.hash_bits_per_character</em>=6. Use 26 instead of
      <em>session.hash_function</em>=0 (MD5) and
      <em>session.hash_bits_per_character</em>=5. Use 22 instead of
      <em>session.hash_function</em>=0 (MD5) and
      <em>session.hash_bits_per_character</em>=6. You must
      configure INI values to have at least 128 bits in session ID. Do
      not forget to set an appropriate value for
      <em>session.sid_bits_per_character</em>, otherwise you
      will have weaker session ID.
     </p>
    </div> 
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      This setting is introduced in PHP 7.1.0.
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.sid-bits-per-character">
    <code class="parameter">session.sid_bits_per_character</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.sid_per_character</em> allows you to specify the
     number of bits in encoded session ID character. The possible values are 
     &#039;4&#039; (0-9, a-f), &#039;5&#039; (0-9, a-v), and &#039;6&#039; (0-9, a-z, A-Z, &quot;-&quot;, &quot;,&quot;).
    </span>
    <span class="simpara">
     The default is 4. The more bits results in stronger session ID. 5 is
     recommended value for most environments.
    </span>
    <p class="para">
    </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      This setting is introduced in PHP 7.1.0.
     </span>
    </p></blockquote>
   </dd>

  


  
   <dt id="ini.url-rewriter.tags">
    <code class="parameter">url_rewriter.tags</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>url_rewriter.tags</em> 指定在使用透明 SID 支持时哪些 HTML
     标记会被修改以加入会话 ID。默认为
     <em>a=href,area=href,frame=src,input=src,form=fakeentry,fieldset=</em>。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      如果要符合 XHTML，去掉 <em>form</em> 项并在表单字段前后加上
      &lt;fieldset&gt; 标记。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.hash-function">
    <code class="parameter">session.hash_function</code>
    <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.hash_function</em> 允许用户指定生成会话
     ID 的散列算法。&#039;0&#039; 表示 MD5（128 位），&#039;1&#039; 表示 SHA-1（160 位）。
    </span>
    <p class="para">
     Since PHP 5.3.0 it is also possible to specify any of the algorithms
     provided by the <a href="ref.hash.html" class="link">hash extension</a> (if it is
     available), like <em>sha512</em> or
     <em>whirlpool</em>. A complete list of supported algorithms can
     be obtained with the <span class="function"><a href="function.hash-algos.html" class="function">hash_algos()</a></span> function.
    </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      这是 PHP 5 引进的。
     </p>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.hash-bits-per-character">
    <code class="parameter">session.hash_bits_per_character</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.hash_bits_per_character</em>
     允许用户定义将二进制散列数据转换为可读的格式时每个字符存放多少个比特。可能值为
     &#039;4&#039;（0-9，a-f），&#039;5&#039;（0-9，a-v），以及 &#039;6&#039;（0-9，a-z，A-Z，&quot;-&quot;，&quot;,&quot;）。
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      这是 PHP 5 引进的。
     </p>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.upload-progress.enabled">
    <code class="parameter">session.upload_progress.enabled</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     Enables upload progress tracking, populating the <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> variable.
     Defaults to 1, enabled.
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.cleanup">
    <code class="parameter">session.upload_progress.cleanup</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     Cleanup the progress information as soon as all POST data has been read
     (i.e. upload completed). Defaults to 1, enabled.
    </span>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <span class="simpara">
      It is highly recommended to keep this feature enabled.
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.upload-progress.prefix">
    <code class="parameter">session.upload_progress.prefix</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     A prefix used for the upload progress key in the <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var>.
     This key will be concatenated with the value of
     <em>$_POST[ini_get(&quot;session.upload_progress.name&quot;)]</em> to
     provide a unique index.
    </span>
    <span class="simpara">
     Defaults to &quot;upload_progress_&quot;.
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.name">
    <code class="parameter">session.upload_progress.name</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     The name of the key to be used in <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> storing
     the progress information. See also
     <a href="session.configuration.html#ini.session.upload-progress.prefix" class="link">session.upload_progress.prefix</a>.
    </span>
    <span class="simpara">
     If <em>$_POST[ini_get(&quot;session.upload_progress.name&quot;)]</em>
     is not passed or available, upload progressing will not be recorded.
    </span>
    <span class="simpara">
     Defaults to &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;.
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.freq">
    <code class="parameter">session.upload_progress.freq</code>
    <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span>
   </dt>

   <dd>

    <span class="simpara">
     Defines how often the upload progress information should be updated.
     This can be defined in bytes (i.e. &quot;update progress information after every 100 bytes&quot;), or in percentages (i.e. &quot;update progress information after receiving every 1% of the whole filesize&quot;).
    </span>
    <span class="simpara">
     Defaults to &quot;1%&quot;.
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.min-freq">
    <code class="parameter">session.upload_progress.min_freq</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     The minimum delay between updates, in seconds.
     Defaults to &quot;1&quot; (one second).
    </span>
   </dd>

  

  
   <dt id="ini.session.lazy-write">
    <code class="parameter">session.lazy_write</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.lazy_write</em>, when set to 1, means that session
     data is only rewritten if it changes. Defaults to 1, enabled.
    </span>
   </dd>

  

 </dl>

 </p>

 <p class="para"><a href="ini.core.html#ini.register-globals" class="link"><em>register_globals</em></a>
  配置选项影响到会话变量是怎样存储和恢复的。
 </p>

 <p class="para">
  Upload progress will not be registered unless
  session.upload_progress.enabled is enabled, and the
  $_POST[ini_get(&quot;session.upload_progress.name&quot;)] variable is set.
  See <a href="session.upload-progress.html" class="link">Session Upload Progress</a> for mor details on this functionality.
 </p>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123598""></a>
  <div class="note">
   <strong class="user">boan dot web at outlook dot com</strong>
   <a href="#123598" class="date">10-Feb-2019 12:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
session.cache_limiter may be empty string to disable cache headers entirely. <br />
<br />
Quote:<br />
&gt; Setting the cache limiter to '' will turn off automatic sending of cache headers entirely.<br />
<br />
<a href="http://php.net/manual/en/function.session-cache-limiter.php" rel="nofollow" target="_blank">http://php.net/manual/en/function.session-cache-limiter.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122042""></a>
  <div class="note">
   <strong class="user">li-lingjie</strong>
   <a href="#122042" class="date">19-Dec-2017 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use SessionHandlerInterface interface Custom redis session, found the following:<br />
<br />
Use ini_set ('session.save_path', "tcp: //127.0.0.1: 6379? Auth = password"); will be reported:<br />
<br />
PHP Fatal error: session_start (): Failed to initialize storage module: user (path: tcp: //127.0.0.1: 6379? Auth = password);<br />
<br />
Using session_save_path ("tcp: //127.0.0.1: 6379? Auth = password") will not</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122038""></a>
  <div class="note">
   <strong class="user">white-gandalf at web dot de</strong>
   <a href="#122038" class="date">18-Dec-2017 05:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
session.use_strict_mode does very little to strengthen your security: only one very specific variant of attack is migitated by this (where the attacker hands an "empty" sid to the victim to adapt his own browser to that session later) - versus for example the case where he pre-opens a session, handing the sid of that one to the victim, so the victim gets adapted to the pre-opened session. In the latter case this flag does nothing to help. In every other scenario with other vulnerabilities where the session id gets leaked, the flag helps nigher.<br />
<br />
But this flag renders the php function session_id() useless in its parameterized variant, thus preventing any php functionality that builds upon this function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121913""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#121913" class="date">25-Nov-2017 04:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You should take more care configuring session.gc_maxlifetime when virtual hosts share the same session-saving directory. One host's session data may be gc'ed when another host runs php.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120047""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#120047" class="date">14-Oct-2016 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to this comment: <a href="http://php.net/manual/en/session.configuration.php#107990 where it is claimed that gc_maxlifetime values larger than 65535 break the session system. I cannot reproduce this." rel="nofollow" target="_blank">http://php.net/manual/en/session.configuration.php#107990 where it is claimed that gc_maxlifetime values larger than 65535 break the session system. I cannot reproduce this.</a><br />
<br />
I've set gc_maxlifetime to 31536000 (1 year) and the session system works just fine. I haven't tried how long a session lasts now (I'm in the process of testing this), but it certainly doesn't break PHP sessions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117668""></a>
  <div class="note">
   <strong class="user">info at thimbleopensource dot com</strong>
   <a href="#117668" class="date">19-Jul-2015 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found out that if you need to set custom session settings, you only need to do it once when session starts. Then session maintains its settings, even if you use ini_set and change them, original session still will use it's original setting until it expires.<br />
<br />
Just thought it might be useful to someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115913""></a>
  <div class="note">
   <strong class="user">GreenReaper</strong>
   <a href="#115913" class="date">14-Oct-2014 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We found a session.save_path depth of 3 led to excessive wastage of inodes and in fact disk space in storing the directory tree. dir_indexes option on ext2/3/4 makes larger directories more feasible anyway, so we decided to move to a depth of 2 instead.<br />
<br />
It took a little puzzling to figure out how to move the existing PHP sessions up one directory tree, but we ended up running this in the root sessions directory:<br />
<br />
#!/bin/sh<br />
for a in ./* ; do<br />
&nbsp;&nbsp;&nbsp; cd ./$a<br />
&nbsp;&nbsp;&nbsp; pwd<br />
&nbsp;&nbsp;&nbsp; for b in ./* ; do<br />
&nbsp;&nbsp; &nbsp;&nbsp; cd ./$b<br />
&nbsp;&nbsp; &nbsp;&nbsp; pwd<br />
&nbsp;&nbsp; &nbsp;&nbsp; # Move existing sessions out<br />
&nbsp;&nbsp; &nbsp;&nbsp; find ./* -xdev -type f -print0 | xargs -0 mv -t .<br />
&nbsp;&nbsp; &nbsp;&nbsp; # Remove subdirectories<br />
&nbsp;&nbsp; &nbsp;&nbsp; find ./* -xdev -type d -print0 | xargs -0 rmdir<br />
&nbsp;&nbsp; &nbsp;&nbsp; cd ..<br />
&nbsp; done<br />
&nbsp; cd ..<br />
done<br />
<br />
This script may not be the best way to do it, but it got the job done fast. You can modify it for different depths by adding or removing "for" loops.<br />
<br />
The documentation gives a depth of 5 as an example, but five is right out. If you're going beyond 2, you're at the scale where you may want to to look at a large memcached or redis instance instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115842""></a>
  <div class="note">
   <strong class="user">Christopher Kramer</strong>
   <a href="#115842" class="date">02-Oct-2014 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime).<br />
<br />
You can adjust the global value in your php.ini (usually /etc/php5/apache2/php.ini). Or you can change the session.save_path so debian's cronjob will not clean up your sessions anymore. Then you need to either do your own garbage collection with your own cronjob or enable PHP's garbage collection (php then needs sufficient privileges on the save_path).<br />
<br />
Why does Debian not use PHP's garbarage collection?<br />
For security reasons, they store session data in a place (/var/lib/php5) with very stringent permissions. With the sticky bit set, only root is allowed to rename or delete files there, so PHP itself cannot clean up old session data. See https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=267720 .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111451""></a>
  <div class="note">
   <strong class="user">jlevene at etisoftware dot com</strong>
   <a href="#111451" class="date">21-Feb-2013 01:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Being unable to find an actual copy of mod_files.sh, and seeing lots of complaints/bug fix requests for it, here's one that works.&nbsp; It gets all its parameters from PHP.INI, so you don't have the opportunity to mess up:<br />
<br />
#!/bin/bash<br />
#<br />
# Creates directories for PHP session storage.<br />
# Replaces the one that "comes with" PHP, which (a) doesn't always come with it<br />
# and (b) doesn't work so great.<br />
#<br />
# This version takes no parameters, and uses the values in PHP.INI (if it<br />
# can find it).<br />
#<br />
# Works in OS-X and CentOS (and probably all other) Linux.<br />
#<br />
# Feb '13 by Jeff Levene.<br />
<br />
[[ $# -gt 0 ]] &amp;&amp; echo "$0 requires NO command-line parameters.<br />
It gets does whatever is called for in the PHP.INI file (if it can find it).<br />
" &amp;&amp; exit 1<br />
<br />
# Find the PHP.INI file, if possible:<br />
phpIni=/usr/local/lib/php.ini&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Default PHP.INI location<br />
[[ ! -f "$phpIni" ]] &amp;&amp; phpIni=/etc/php.ini&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Secondary location<br />
[[ ! -f "$phpIni" ]] &amp;&amp; phpIni=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Found it?<br />
<br />
# Outputs the given (as $1) parameter from the PHP.INI file:<br />
# The "empty" brackets have a SPACE and a TAB in them.<br />
#<br />
PhpConfigParam() {<br />
&nbsp;&nbsp;&nbsp; [[ ! "$phpIni" ]] &amp;&amp; return<br />
&nbsp;&nbsp;&nbsp; # Get the line from the INI file:<br />
&nbsp;&nbsp;&nbsp; varLine=`grep "^[&nbsp; &nbsp;&nbsp; ]*$1[&nbsp; &nbsp;&nbsp; ]*=" "$phpIni"`<br />
<br />
&nbsp;&nbsp;&nbsp; # Extract the value:<br />
&nbsp;&nbsp;&nbsp; value=`expr "$varLine" : ".*$1[&nbsp; &nbsp;&nbsp; ]*=[&nbsp; &nbsp;&nbsp; ]*['\"]*\([^'\"]*\)"`<br />
&nbsp;&nbsp;&nbsp; echo "$value"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
if [[ "$phpIni" ]]<br />
then<br />
&nbsp;&nbsp;&nbsp; savePath=`PhpConfigParam session.save_path`<br />
&nbsp;&nbsp;&nbsp; # If there's a number and semicolon at the front, remove them:<br />
&nbsp;&nbsp;&nbsp; dirDepth=`expr "$savePath" : '\([0-9]*\)'`<br />
&nbsp;&nbsp;&nbsp; [[ "$dirDepth" ]] &amp;&amp; savePath=`expr "$savePath" : '[0-9]*;\(.*\)'` || dirDepth=0<br />
&nbsp;&nbsp;&nbsp; bits=`PhpConfigParam session.hash_bits_per_character`<br />
&nbsp;&nbsp;&nbsp; case "x$bits" in<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x)&nbsp; &nbsp; echo "hash_bits_per_character not defined.&nbsp; Not running." ; exit 2 ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x4) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f' ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x5) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v' ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x6) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; alphabet="$alphabet w x y z A B C D E F G H I J K L M N O P Q R S T U V W"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; alphabet="$alphabet X Y Z - ,"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; *)&nbsp; &nbsp; echo "unrecognized hash_bits_per_character.&nbsp; Not running." ; exit 2 ;;<br />
&nbsp;&nbsp;&nbsp; esac<br />
else<br />
&nbsp;&nbsp;&nbsp; echo "Cannot find the PHP.INI file.&nbsp; Not running.&nbsp; Sorry."<br />
&nbsp;&nbsp;&nbsp; exit 2<br />
fi<br />
<br />
# The depth of directories to create is $1.&nbsp; 0 means just create the named<br />
# directory.&nbsp; Directory to start with is $2.<br />
#<br />
# Used recursively, so variables must be "local".<br />
<br />
doDir() {<br />
&nbsp;&nbsp;&nbsp; local dir="$2"<br />
&nbsp;&nbsp;&nbsp; if [[ -d "$dir" ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "Directory '$dir' already exists.&nbsp; No problem."<br />
&nbsp;&nbsp;&nbsp; elif [[ -f "$dir" ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "FILE '$dir' exists.&nbsp; Aborting." ; exit 2<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if mkdir "$dir"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Directory '$dir' created."<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Cannot create directory '$dir'.&nbsp; Aborting." ; exit 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; chmod a+rwx "$dir"<br />
&nbsp;&nbsp;&nbsp; if [[ $1 -gt 0 ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; local depth=$(( $1 - 1 ))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for letter in $alphabet<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do&nbsp; &nbsp; doDir $depth "$dir/$letter"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; done<br />
&nbsp;&nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
echo "Running with savePath='$savePath', dirDepth=$dirDepth, and bitsPerCharacter=$bits."<br />
sleep 3<br />
<br />
doDir $dirDepth "$savePath"<br />
<br />
exit 0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107990""></a>
  <div class="note">
   <strong class="user">hassankhodadadeh at NOSPAM dot gmail dot com</strong>
   <a href="#107990" class="date">20-Mar-2012 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
max value for "session.gc_maxlifetime" is 65535. values bigger than this may cause&nbsp; php session stops working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100855""></a>
  <div class="note">
   <strong class="user">AskApache</strong>
   <a href="#100855" class="date">10-Nov-2010 10:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is how I set my session.save_path<br />
session.save_path = "1;/home/askapache/tmp/s" <br />
So to create the folder structure you can use this compatible shell script, if you want to create with 777 permissions change the umask to 0000;<br />
sh -o braceexpand -c "umask 0077;mkdir -p s/{0..9}/{a..z} s/{a..z}/{0..9}"<br />
<br />
Then you can create a cronjob to clean the session folder by adding this to your crontab which deletes any session files older than an hour:<br />
@daily find /home/askapache/tmp/s -type f -mmin +60 -exec rm -f {} \; &amp;&gt;/dev/null<br />
<br />
That will create sessions in folder like:<br />
&nbsp;/home/askapache/tmp/s/b/sess_b1aba5q6io4lv01bpc6t52h0ift227j6<br />
<br />
I don't think any non-mega site will need to go more than 1 levels deep.&nbsp; Otherwise you create so many directories that it slows the performance gained by this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99671""></a>
  <div class="note">
   <strong class="user">orbill</strong>
   <a href="#99671" class="date">30-Aug-2010 05:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
apparently the default value for session.use_only_cookies has changed in 5.3.3 from 0 to 1. If you haven't set this in your php.ini or your code to 0 transparent sessions won't work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99619""></a>
  <div class="note">
   <strong class="user">Nicholas</strong>
   <a href="#99619" class="date">26-Aug-2010 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Transient sessions do not appear to be working in 5.3.3<br />
<br />
E.g.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; ini_set</span><span class="keyword">(</span><span class="string">"session.use_cookies"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.use_trans_sid"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Foo: " </span><span class="keyword">. </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">] = </span><span class="string">"Bar"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;a href=?" </span><span class="keyword">. </span><span class="default">session_name</span><span class="keyword">() . </span><span class="string">"=" </span><span class="keyword">. </span><span class="default">session_id</span><span class="keyword">() . </span><span class="string">"&gt;Begin test&lt;/a&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
This works in 5.2.5, but not 5.3.3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97979""></a>
  <div class="note">
   <strong class="user">Wouter</strong>
   <a href="#97979" class="date">19-May-2010 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When setting the session.cookie_lifetime directive in a .htaccess use string format like;<br />
<br />
php_value session.cookie_lifetime "123456"<br />
<br />
and not<br />
<br />
php_value session.cookie_lifetime 123456<br />
<br />
Using a integer as stated above dit not work in my case (Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.5 with Suhosin-Patch mod_ssl/2.2.11 OpenSSL/0.9.8g)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88552""></a>
  <div class="note">
   <strong class="user">mikaelkael at php dot net</strong>
   <a href="#88552" class="date">28-Jan-2009 12:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Recently, I needed to change the session save_path in my program under Windows. With an ini_set('session.save_path', '../data/sessions'); (and session.gc_divisor = 1 for test), I always obtain 'Error #8 session_start(): ps_files_cleanup_dir: opendir(../data/sessions) failed: Result too large'.<br />
<br />
I corrected this by changing with ini_set('session.save_path', realpath('../data/sessions'));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86403""></a>
  <div class="note">
   <strong class="user">sony-santos at bol dot com dot br</strong>
   <a href="#86403" class="date">16-Oct-2008 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to 00 at f00n, this very page explains:<br />
<br />
"(...) if N is used and greater than 0 then automatic garbage collection will not be performed (...)"<br />
<br />
So you can actually use custom save_path with automatic garbage collection, since you don't use the subdirectory option (that N subdirectory levels).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84045""></a>
  <div class="note">
   <strong class="user">00 at f00n dot com</strong>
   <a href="#84045" class="date">25-Jun-2008 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After having many problems with garbage collection not clearing my sessions I have resolved it through the following.<br />
<br />
First I found this in the php.ini (not something i noticed as i use phpinfo(); to see my hosting ini).<br />
<br />
; NOTE: If you are using the subdirectory option for storing session files<br />
;&nbsp; &nbsp; &nbsp;&nbsp; (see session.save_path above), then garbage collection does *not*<br />
;&nbsp; &nbsp; &nbsp;&nbsp; happen automatically.&nbsp; You will need to do your own garbage<br />
<br />
; collection through a shell script, cron entry, or some other method. ;&nbsp; &nbsp; &nbsp;&nbsp; For example, the following script would is the equivalent of<br />
;&nbsp; &nbsp; &nbsp;&nbsp; setting session.gc_maxlifetime to 1440 (1440 seconds = 24 minutes):<br />
;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cd /path/to/sessions; find -cmin +24 | xargs rm<br />
<br />
With this is mind there are options.<br />
<br />
1. dont use a custom save_path.<br />
** This means if your isp hasnt defaulted your session temp to something safer than install default or you are using a shared directory for session data then you would be wise to use named sessions to keep your session from being viewable in other people's scripts.&nbsp; Creating a unique_id name for this is the common method. **<br />
<br />
2. use your custom folder but write a garbage collection script.<br />
<br />
3. use a custom handler and a database</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84020""></a>
  <div class="note">
   <strong class="user">phpforcharity dot 5 dot pistos at geoshell dot com</strong>
   <a href="#84020" class="date">24-Jun-2008 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get session IDs to show up in URIs, and not get stored via cookies, you must not only set session.use_cookies to 0, but also set session.use_trans_sid to 1.&nbsp; Otherwise, the session ID goes neither in a cookie nor in URIs!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
