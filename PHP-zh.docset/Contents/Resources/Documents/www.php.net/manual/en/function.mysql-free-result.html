<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>释放结果内存</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysql-field-type.html">? mysql_field_type</a></li>
      <li style="float: right;"><a href="function.mysql-get-client-info.html">mysql_get_client_info ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysql.html">MySQL 函数</a></li>
    <li>释放结果内存</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysql-free-result" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">mysql_free_result</h1>
    <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_free_result</span> &mdash; <span class="dc-title">释放结果内存</span></p>

   </div>
 <div class="refsect1 description" id="refsect1-function.mysql-free-result-description">
  <h3 class="title">说明</h3>
     <div class="methodsynopsis dc-description">
      <span class="methodname"><strong>mysql_free_result</strong></span>
       ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
      ) : <span class="type">bool</span></div>

    <p class="para rdfs-comment">
     <span class="function"><strong>mysql_free_result()</strong></span> 将释放所有与结果标识符
     <code class="parameter">result</code> 所关联的内存。
    </p>
    <p class="para">
     <span class="function"><strong>mysql_free_result()</strong></span>
     仅需要在考虑到返回很大的结果集时会占用多少内存时调用。在脚本结束后所有关联的内存都会被自动释放。
     
    </p>
    <p class="para">
     成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
    </p>
    <p class="para">
     为向下兼容仍然可以使用
     <span class="function"><strong>mysql_freeresult()</strong></span>，但反对这样做。
    </p>
   </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-free-result-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">
result</code></dt>
<dd>
<p class="para"><span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
型的结果集。此结果集来自对 <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>
的调用。</p></dd>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-free-result-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
  <p class="para">
   If a non-resource is used for the <code class="parameter">result</code>, an
   error of level E_WARNING will be emitted.  It&#039;s worth noting that
   <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span> only returns a <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
   for SELECT, SHOW, EXPLAIN, and DESCRIBE queries.
  </p>
 </div>

 
  <div class="refsect1 examples" id="refsect1-function.mysql-free-result-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2180">
    <p><strong>Example #1 A <span class="function"><strong>mysql_free_result()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;id,email&nbsp;FROM&nbsp;people&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;'42'"</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$result</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Could&nbsp;not&nbsp;run&nbsp;query:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /></span><span style="color: #FF8000">/*&nbsp;Use&nbsp;the&nbsp;result,&nbsp;assuming&nbsp;we're&nbsp;done&nbsp;with&nbsp;it&nbsp;afterwards&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Now&nbsp;we&nbsp;free&nbsp;up&nbsp;the&nbsp;result&nbsp;and&nbsp;continue&nbsp;on&nbsp;with&nbsp;our&nbsp;script&nbsp;*/<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-free-result-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    为了向下兼容，可以使用下列已废弃的别名：
    <span class="function"><strong>mysql_freeresult()</strong></span>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-free-result-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - 发送一条 MySQL 查询</span></li>
    <li class="member"><span class="function"><a href="function.is-resource.html" class="function" rel="rdfs-seeAlso">is_resource()</a> - 检测变量是否为资源类型</span></li>
   </ul>
  </p>
 </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102949""></a>
  <div class="note">
   <strong class="user">webmaster at bluesting dot co dot za</strong>
   <a href="#102949" class="date">16-Mar-2011 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mysql_query() also returns a resource for "OPTIMIZE TABLE" statements!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81891""></a>
  <div class="note">
   <strong class="user">admin at ifyouwantblood dot de</strong>
   <a href="#81891" class="date">18-Mar-2008 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
yes this function may increase the memory usage if you use unbuffered querys and if you have not fetched all the data from mysql. in this case the mysql api has a problem: you want to free the result but do not want to close the connection. now mysql will only accept another query if all data has been fetched, so the api now must fetch the rest of the data when calling mysql_free_result().<br />
<br />
so only use unbuffered querys if you fetch all the data (and need it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71289""></a>
  <div class="note">
   
   <a href="#71289" class="date">21-Nov-2006 02:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're seeing warnings like "Warning: Unknown: 6 result set(s) not freed. Use mysql_free_result to free result sets which were requested using mysql_query() in Unknown on line 0" and want to turn them off, set mysql.trace_mode = Off in your php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
