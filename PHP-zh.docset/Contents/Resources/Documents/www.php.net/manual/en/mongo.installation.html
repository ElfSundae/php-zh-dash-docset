<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mongo.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="mongo.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mongo.setup.html">安装／配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mongo.installation" class="section">
 <h2 class="title">安装</h2>
 
 <div class="warning"><strong class="warning">Warning</strong>
  <p class="para">This extension is deprecated. Instead,
the <a href="set.mongodb.html" class="link">MongoDB</a> extension should be
used.</p>
 </div>

 <p class="para">
  MongoDB 的 PHP 驱动程序可以工作在几乎任何系统上：Windows、Mac OS X、Unix 和 Linux；大端或小端字节序（little/big-endian）；32位和64位的机器；PHP 5.3-5.6(1.6之前的版本同时支持 PHP5.2)。
 </p>
 <p class="para">
  此 <a href="https://pecl.php.net/" class="link external" title="Link : https://pecl.php.net/">&raquo;&nbsp;PECL</a> 扩展未与
PHP 捆绑。 
 </p>

<ul class="simplelist">
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.manual" class="xref">手动安装</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.nix" class="xref">在 *NIX 上安装</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.windows" class="xref">在 Windows 上安装</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.osx" class="xref">OS X</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.gentoo" class="xref">Gentoo</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.fedora" class="xref">Red Hat</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.thirdparty" class="xref">第三方安装说明</a>
  </li>
 </ul>
 
 <div class="section" id="mongo.installation.manual">
  <h2 class="title">手动安装</h2>

  <p class="para">
  驱动开发人员和对最新 bug 修复感兴趣的人，可以从 <a href="https://github.com/mongodb/mongo-php-driver-legacy" class="link external" title="Link : https://github.com/mongodb/mongo-php-driver-legacy">&raquo;&nbsp;Github</a> 上获取最新源码来编译驱动。
   前往 Github 并点击 &quot;download&quot; 按钮。然后运行：
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;
$ phpize
$ ./configure
$ make all
$ sudo make install</pre>
</div>
   </div>

  </p>

  <p class="para">
   并按以下说明修改 php.ini：
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
    确保 <em class="emphasis">extension_dir</em> 变量指向了 <em class="emphasis">mongo.so</em> 的位置。
     编译时会显示安装 PHP 驱动的位置，比如输出：
     <div class="example-contents">
<div class="txtcode"><pre class="txtcode">Installing &#039;/usr/lib/php/extensions/no-debug-non-zts-20060613/mongo.so&#039;</pre>
</div>
     </div>


      确保和运行的 PHP 是同一个扩展目录：

     <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -i | grep extension_dir
  extension_dir =&gt; /usr/lib/php/extensions/no-debug-non-zts-20060613 =&gt;
                   /usr/lib/php/extensions/no-debug-non-zts-20060613</pre>
</div>
     </div>

    如果不一致，则需要修改 php.ini 里的 <em class="emphasis">extension_dir</em>，或者把 <em class="emphasis">mongo.so</em> 移过去。
    </p>
   </li>
   
   
   
   <li class="listitem">
    <p class="para">
    要在 PHP 启动的时候加载这个扩展，添加一行：

     <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=mongo.so</pre>
</div>
     </div>


    </p>
   </li>
  </ul>

 <div class="section" id="mongo.installation.nix">
  <h2 class="title">在 *NIX 上安装</h2>

  <p class="para">
   执行:
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo pecl install mongo</pre>
</div>
   </div>

  </p>

  <p class="para">
   将以下内容添加到 php.ini 文件:
   <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=mongo.so</pre>
</div>
   </div>

  </p>

  <p class="para">
   如果 pecl 运行时超出了内存限制，请确认在 php.ini 中的 memory_limit 的设置至少有 128MB。
  </p>
 </div>

 <div class="section" id="mongo.installation.windows">
  <h2 class="title">在 Windows 上安装</h2>

  <p class="para">
   针对不同线程安全、VC版本的 PHP 发行版，可从 <a href="https://pecl.php.net/package/mongo" class="link external" title="Link : https://pecl.php.net/package/mongo">&raquo;&nbsp;PECL</a> 获取到预编译的二进制文件。
   解压，并把 php_mongo.dll 放到 PHP 扩展目录（默认是 "ext"）。
  </p>

  <p class="para">
   将以下内容添加到 php.ini 文件:
   <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=php_mongo.dll</pre>
</div>
   </div>

  </p>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>为 Windows 用户添加额外的依赖 DLL</strong><br />
   <p class="para">
    为了使此扩展生效，
<acronym title="Dynamic Link Library">DLL</acronym> 文件必须能在 Windows 系统的
<em>PATH</em> 指示的路径下找到。如何操作的信息，请参见题为"<a href="faq.installation.html#faq.installation.addtopath" class="link">如何在 Windows 中将 PHP
目录加到 PATH 中</a>"的<acronym title="Frequently Asked Questions">FAQ</acronym>。虽然将
DLL 文件从 PHP 文件夹复制到 Windows 系统目录也行，但不建议这样做。
<em class="emphasis">此扩展需要下列文件在 <em>PATH</em> 路径中：</em>
    <var class="filename">libsasl.dll</var>
   </p>
  </p></blockquote>
 </div>

  <div class="section" id="mongo.installation.osx">
   <h2 class="title">OS X</h2>
   <p class="para">
   大部分情况下，从 pecl 安装最简单：
    <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo pecl install mongo</pre>
</div>
    </div>

   </p>
   <p class="para">
   如果用的是 <a href="https://github.com/Homebrew/homebrew-php" class="link external" title="Link : https://github.com/Homebrew/homebrew-php">&raquo;&nbsp;Homebrew</a>，PHP 包含了驱动安装的方案。比如，安装 PHP 5.6 的驱动，可以使用以下命令：
    <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ brew install php56-mongo</pre>
</div>
    </div>

   </p>
   <p class="para">
    如果使用的是 <a href="https://www.apachefriends.org/" class="link external" title="Link : https://www.apachefriends.org/">&raquo;&nbsp;XAMPP</a>，请注意它有自己的 pecl 二进制文件和 php.ini 配置。
    你可以通过以下命令安装驱动：
    <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo /Applications/XAMPP/xamppfiles/bin/pecl install mongo</pre>
</div>
    </div>

   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>在 OS X 上编译时的 Xcode 依赖</strong><br />
   <p class="para">
    在 OS X 上编译驱动需要 Xcode 开发工具，可以通过 <code class="code">xcode-select --install</code> 安装。
    如果命令无效，也许应该先安装
    <a href="https://developer.apple.com/downloads/index.action?name=Command%20Line%20Tools" class="link external" title="Link : https://developer.apple.com/downloads/index.action?name=Command%20Line%20Tools">&raquo;&nbsp;Command Line Tools</a> 包。
   </p>
  </p></blockquote>
  </div>

  <div class="section" id="mongo.installation.gentoo">
   <h2 class="title">Gentoo</h2>
   <p class="para">
    Gentoo 有一个 PHP 驱动的包，叫做 dev-php/pecl-mongo，可以通过以下命令安装：
   </p>
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo emerge -va dev-php5/mongo</pre>
</div>
   </div>


   <p class="para">如果你使用了 PECL，你可能得到 libtool 版本不正确的错误。
    从源码编译，你需要运行 aclocal 和 autoconf。
   </p>
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ phpize &amp;&amp; aclocal &amp;&amp; autoconf &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install</pre>
</div>
   </div>

  </div>
  <div class="section" id="mongo.installation.fedora">
   <h2 class="title">Red Hat</h2>
   <p class="para">
    同时包括 Fedora 和 CentOS。
   </p>
   <p class="para">
    这些系统上默认的 Apache 设置禁止请求产生网络连接，意味着当连接到数据库，驱动会得到一个 &quot;Permission denied&quot;
    错误。当遇到这个问题，可以试试运行：
    <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ /usr/sbin/setsebool -P httpd_can_network_connect 1</pre>
</div>
    </div>

    然后重启 Apache。（在 SELinux 下也会产生这个问题。）
   </p>
  </div>
 </div>

 <div class="section" id="mongo.installation.thirdparty">
  <h2 class="title">第三方安装说明</h2>
  
  <p class="para">
   很多人撰写了安装 PHP 驱动的极好教程。
  </p>

  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     <a href="http://justinhileman.info/article/reinstalling-php-on-mac-os-x/" class="link external" title="Link : http://justinhileman.info/article/reinstalling-php-on-mac-os-x/">&raquo;&nbsp;
      在 Mac OS X 上安装或重装 PHP 
     </a>
    </p>
    <p class="para">
     Justin Hileman 撰写的文章详细描述了在 OS X 上使用 Homebrew 安装 PHP 和额外的扩展（extension）。
     此文补充了早些时候此页上用 Homebrew 安装驱动的说明。
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="https://www.vimeo.com/8005503" class="link external" title="Link : https://www.vimeo.com/8005503">&raquo;&nbsp;
     
       Ubuntu 9.10 / Apache 2.2 下，附带 Xdebug, MongoDB 和 Lithium 的 PHP 5.3.1。
     </a>
    </p>
    <p class="para">
    Jon Adams 的视频录像演示了如何在 Ubuntu 9.1 的 Apache 下快速设置运行 PHP 5.3.1，Xdebug 和 MongoDB。
    </p>
   </li>
  </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116471""></a>
  <div class="note">
   <strong class="user">brick</strong>
   <a href="#116471" class="date">08-Jan-2015 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Apache 2.4.10 win32 from apachelounge with php 5.6.4 VC11 x86 Thread Safe on windows7 sp1.<br />
The 5.6 Thread Safe (TS) x86 mongo.dll i downloaded from <a href="http://pecl.php.net/package/mongo/1.5.8/windows " rel="nofollow" target="_blank">http://pecl.php.net/package/mongo/1.5.8/windows </a><br />
I kept getting the following error<br />
PHP Startup: Unable to load dynamic library mongo.dll<br />
The specified module could not be found. <br />
I fixed this by adding the php and the php/ext to the windows path and rebooting(log off didn't cut it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112022""></a>
  <div class="note">
   <strong class="user">bradley dot henke at colorado dot edu</strong>
   <a href="#112022" class="date">23-Apr-2013 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instructions for Manually Installing MongoDB for PHP for use with "XAMPP for Linux":<br />
<br />
There were two gotchas that I ran into. "XAMPP for Linux" needs 32 bit libraries, and the php API version must match the php API version of "XAMPP for Linux".<br />
Hopefully this will save someone else time figuring this all out!<br />
<br />
1) Install "XAMPP for Linux" AND the "XAMPP for Linux Development Files".<br />
<br />
2) Grab the source code from github (in the manual instructions above)<br />
$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz<br />
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;<br />
<br />
There are now some smalls deviation from the manual instructions...<br />
3) PHPize<br />
$ sudo /opt/lampp/bin/phpize<br />
<br />
4) Configure<br />
$ ./configure<br />
<br />
5) Make changes to the Makefile (XAMPP requires a 32-bit compilation)<br />
- Choose your favorite text editor and open "Makefile"<br />
- Make the following changes:<br />
Line 20: prefix = /opt/lampp<br />
Line 23: prefix = /opt/lampp<br />
Line 25: phpincludedir = /opt/lampp/include/php<br />
Line 27: CFLAGS = -g -O2 -m32<br />
Line 34: EXTENSION_DIR = /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
Line 35: PHP_EXECUTABLE = /opt/lampp/bin/php<br />
<br />
Make sure you replace &lt;/path/to/mongo-php-driver-master&gt;<br />
Line 38: INCLUDES = -I/opt/lampp/include/php -I/opt/lampp/include/php/main -I/opt/lampp/include/php/TSRM -I/opt/lampp/include/php/Zend -I/opt/lampp/include/php/ext -I/opt/lampp/include/php/ext/date/lib -I&lt;/path/to/mongo-php-driver-master&gt;/util -I&lt;/path/to/mongo-php-driver-master&gt;/exceptions -I&lt;/path/to/mongo-php-driver-master&gt;/gridfs -I&lt;/path/to/mongo-php-driver-master&gt;/types -I&lt;/path/to/mongo-php-driver-master&gt;/mcon<br />
<br />
6) Compile<br />
$ sudo make all<br />
<br />
7) Copy the static object into the extension directory<br />
$ sudo cp modules/mongo.so /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
<br />
9) Update your php.ini file<br />
- Grab you favorite text editor and open /opt/lampp/etc/php.ini (you'll probably need to use sudo).<br />
- Add the line: extension=mongo.so<br />
<br />
10) Restart "XAMPP for Linux". You should now be able to see Mongo listed in your phpinfo() page! Installation Complete!!!<br />
<br />
Good Luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111083""></a>
  <div class="note">
   <strong class="user">Hanakaze</strong>
   <a href="#111083" class="date">12-Jan-2013 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To install the Mongo driver on Windows 7 x64 with EasyPHP, you have to use the x86 driver (instead of x64) and non nts :<br />
php_mongo-1.3.2RC1-5.4-vc9.dll actually</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104223""></a>
  <div class="note">
   <strong class="user">Andrey</strong>
   <a href="#104223" class="date">01-Jun-2011 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On windows installation check for VC compilator version inside phpinfo(), if you install incorrect one it wouldn't work.<br />
I tried to run on Apache2 with VC6, and always get folowing error:<br />
<br />
Fatal error: Class 'Mongo' not found<br />
<br />
Until I look into phpinfo and found MSVC9, after that<br />
I install VC9 dll files and it solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100606""></a>
  <div class="note">
   <strong class="user">poorpuer at gmail dot com</strong>
   <a href="#100606" class="date">26-Oct-2010 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're running IIS under Windows 7 and have PHP manager installed you'll also need to manually enable the extension. Start IIS Manager, select PHP Manager, under the section labeled PHP Extensions click on Enable or disable an extension, then enable the php_mongo.dll extension, and restart IIS.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96435""></a>
  <div class="note">
   <strong class="user">cap at unagon dot com</strong>
   <a href="#96435" class="date">26-Feb-2010 01:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Debian users: apt-get install php5-dev will install phpize for you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
