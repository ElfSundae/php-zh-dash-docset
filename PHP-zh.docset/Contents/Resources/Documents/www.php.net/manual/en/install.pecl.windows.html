<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>在 Windows 上安装 PHP 扩展</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.pecl.downloads.html">? 下载 PECL 扩展库</a></li>
      <li style="float: right;"><a href="install.pecl.pear.html">用 PEAR 编译共享 PECL 扩展库 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.pecl.html">PECL 扩展库安装</a></li>
    <li>在 Windows 上安装 PHP 扩展</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.pecl.windows" class="sect1">
  <h2 class="title">在 Windows 上安装 PHP 扩展</h2>
  <p class="para">
   在 Windows 上有两种加载 PHP 扩展的方式：把扩展编译进 PHP，或者加载 DLL。加载预编译的扩展是更简单更被推荐的方式。
  </p>
  <p class="para">
   要加载某扩展，需要在系统中有其相对应的 ".dll" 文件。所有扩展都会由
   PHP 小组定期自动编译（如何下载见下节）。
  </p>
  <p class="para">
   要将一扩展编译入 PHP，请参考 <a href="install.windows.legacy.index.html#install.windows.legacy.building" class="link">从源程序编译</a> 一章。
  </p>
  <p class="para">
   要编译一个独立的扩展（即 DLL 文件），请参考 <a href="install.windows.legacy.index.html#install.windows.legacy.building" class="link">从源程序编译</a> 一章。如果在
   PHP 发行包和 PCEL 中都没有某 DLL 文件，那可能需要自己编译之后才能使用该扩展。
  </p>
  
  


  <div class="sect2" id="install.pecl.windows.find">
   <h3 class="title">去哪里找扩展库？</h3>
   <p class="para">
    PHP 扩展库通常称为"php_*.dll"（其中星号代表具体某扩展的名字），位于"PHP\ext"目录下。
   </p>
   <p class="para">
    PHP 发行包中包括了大多数开发者最常用到的扩展库。这些被称为"核心"扩展库。
   </p>
   <p class="para">
    不过呢，如果用户所需要的功能并没有被任何核心扩展提供，那还是有可能在
    PECL 中找到。PHP Extension Community Library（PECL，PHP 扩展社区库）是个
    PHP 扩展的储存室，提供了对于所有已知扩展的下载及开发途径的指南。
   </p>
   <p class="para">
    如果用户开发了一个自己使用的扩展，可以考虑将其发布到 PECL
    中以便于其他有相同需求的用户使用。一个很好的副作用是可以得到其他用户的反馈，感谢，错误报告甚至修正／更新。不过在向
    PECL 发布扩展之前，请先阅读
    <a href="https://pecl.php.net/package-new.php" class="link external" title="Link : https://pecl.php.net/package-new.php">&raquo;&nbsp;PECL 提交指南</a>。
   </p>
  </div>
  
  



  <div class="sect2" id="install.pecl.windows.which">
   <h3 class="title">下载哪个扩展？</h3>
   <p class="para">
    <em class="emphasis">用户常常会发现每个 DLL 都有好几个版本：</em>
    <ul class="itemizedlist">
     <li class="listitem">
      <span class="simpara">
       不同的版本号（至少前两个数字要一致）
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       不同的线程安全性设定
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       不同的处理器体系（x86，x64，...)
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       不同的排错设定
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       <code class="literal">其它</code>
      </span>
     </li>
    </ul>
   </p>
   <p class="para">
    请记住用户的扩展设定应该与所使用的 PHP 可执行文件的设定都保持一致。以下脚本可以显示<em class="emphasis">所有</em>
    PHP 设定：
   </p>
   <p class="para">
    <div class="example" id="example-35">
     <p><strong>Example #1 <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> call</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />phpinfo</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    或者在命令行运行：
    <div class="example-contents screen">
<div class="cdata"><pre>
drive:\\path\to\php\executable\php.exe -i
</pre></div>
    </div>
   </p>
  </div>
  
  <div class="sect2" id="install.pecl.windows.loading">
   <h3 class="title">载入一个扩展</h3>
   <p class="para">
    最常见的方式是在 <var class="filename">php.ini</var> 配置文件里包含一个 PHP
    扩展。请注意很多扩展已经在 <var class="filename">php.ini</var> 里了，仅需要移除分号来激活它们。
   </p>
   <p class="para">
    需要注意，从 PHP 7.2.0 开始，可以直接用扩展的名称，来替代扩展的文件名。这样配置文件就跟操作系统解耦了，也更容易理解。我们推荐采用此方式加载扩展。为了与之前的版本保持兼容，直接写扩展名的方式会仍然支持。
   </p>
    <div class="example-contents screen">
<div class="cdata"><pre>
;extension=php_extname.dll
</pre></div>
    </div>
    <div class="example-contents screen">
<div class="cdata"><pre>
extension=php_extname.dll
</pre></div>
    </div>
    <div class="example-contents screen">
<div class="cdata"><pre>
; PHP version 7.2 开始的推荐写法：
extension=extname
zend_extension=another_extension
</pre></div>
    </div>
   <p class="para">
    不过呢，有些 web 服务器会搞混，因为其并不一定使用和 PHP
    可执行文件处于同一目录下的 <var class="filename">php.ini</var>
    文件。要搞清楚具体使用了哪一个 <var class="filename">php.ini</var>
    文件，在 <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> 的输出中查看：
    <div class="example-contents screen">
<div class="cdata"><pre>
Configuration File (php.ini) Path  C:\WINDOWS
</pre></div>
    </div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Loaded Configuration File   C:\Program Files\PHP\5.2\php.ini
</pre></div>
    </div>
   </p>
   <p class="para">
    激活一个扩展后，保存 <var class="filename">php.ini</var>
    文件并重启动 web 服务器，然后用
    <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> 再次查看确定。新的扩展应该有其自己的一节。
   </p>
  </div>
  
  <div class="sect2" id="install.pecl.windows.problemsolving">
   <h3 class="title">解决问题</h3>
   <p class="para">
    如果某扩展并未在 <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span>
    中显示，应该查看日志以确定问题出在哪里。
   </p>
   <p class="para">
    如果是在命令行使用 PHP（CLI），扩展加载出错信息会直接在屏幕显示。
   </p>
   <p class="para">
    如果在 web 服务器中使用 PHP，则日志文件的位置与格式各不相同。请阅读所使用的
    web 服务器之文档以确定日志文件的位置，这与 PHP 本身并无关系。
   </p>
   <p class="para">
    最常见的问题是 DLL 文件的位置，<var class="filename">php.ini</var>
    中"<a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a>"设定的值，以及编译时的设置不匹配。
   </p>
   <p class="para">
    如果问题出在编译时设置不匹配，那可能所下载的 DLL
    文件不对。可以尝试重新下载一个设置匹配的扩展。此外，<span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span>
    可以起到很大帮助。
   </p>
  </div>
  
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125200""></a>
  <div class="note">
   <strong class="user">peteb at airpost dot net</strong>
   <a href="#125200" class="date">21-Jul-2020 03:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is not really true all the time:<br />
<br />
"However, some web servers are confusing because they do not use the php.ini located alongside your PHP executable. To find out where your actual php.ini resides, look for its path in phpinfo():<br />
<br />
Configuration File (php.ini) Path&nbsp; C:\WINDOWS"<br />
<br />
Ignore the path being C:\windows<br />
This issue goes back over a decade.&nbsp; <br />
Php is hardwired to display "C:\windows" even though there is not any php.ini at that location.&nbsp; <br />
Moving php.ini to C:\windows will accomplish nothing.&nbsp; <br />
I have seen many posts about folks complaining that they can't get it to stop displaying "Path C:\windows".&nbsp; I have not seen anything posted that fixes this and a few posts that claim it is hardwired to display this.&nbsp; <br />
I have both working and broken php setups on various windows machines and they all say this same "c:\windows" even though my php.ini file is in c:\php.&nbsp; <br />
I know apache is using the file c:\php\php.ini and not the windows directory because there is no php.ini in windows directory and changes to my php.ini file work fine even though the info from phpinfo is wrong on this line.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122837""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#122837" class="date">15-Jun-2018 09:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In xampp. After removing the semicolon from the php.ini file, I had to stop the the apache server from the xampp GUI and restart it. Then I used the following code to view all the loaded extentions and my extension was shown there as well.<br />
<br />
print_r(get_loaded_extensions());<br />
<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122732""></a>
  <div class="note">
   <strong class="user">Robert Dinion</strong>
   <a href="#122732" class="date">15-May-2018 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Windows try setting the&nbsp; extension_dir set to a complete path if you have an error. <br />
&nbsp;Only having <br />
extension_dir ="ext" <br />
did not work for me. <br />
The Apache error log showed it looking for ext\\&lt;extension.dll&gt; and unable to find it.<br />
; Directory in which the loadable extensions (modules) reside.<br />
; <a href="http://php.net/extension-dir" rel="nofollow" target="_blank">http://php.net/extension-dir</a><br />
; extension_dir = "./"<br />
; On windows:<br />
extension_dir = "C:\php\ext"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
