<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Microsoft Windows 下的 Apache 2.x</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.windows.commandline.html">? PHP 在 Microsoft Windows 下的命令行方式</a></li>
      <li style="float: right;"><a href="install.windows.troubleshooting.html">Windows 下 PHP 故障排除 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.windows.html">Windows 系统下的安装</a></li>
    <li>Microsoft Windows 下的 Apache 2.x</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.windows.apache2" class="sect1">
 <h2 class="title">Microsoft Windows 下的 Apache 2.x</h2>
 <p class="para">
  本节包括在 Microsoft Windows 系统中针对 Apache 2.x 安装 PHP 的指导与说明。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   请先阅读<a href="install.windows.manual.html" class="link">手工安装步骤</a>！
  </p>
 </p></blockquote>
 <p class="para">
  强烈建议阅读 <a href="http://httpd.apache.org/docs/current/" class="link external" title="Link : http://httpd.apache.org/docs/current/">&raquo;&nbsp;Apache 文档</a> 来加深对
  Apache 2.x 服务器的基本理解。此外在继续下去之前考虑先阅读一下 Apache 2.x 的 
  <a href="http://httpd.apache.org/docs/current/platform/windows.html" class="link external" title="Link : http://httpd.apache.org/docs/current/platform/windows.html">&raquo;&nbsp;Windows 下使用说明</a>。
 </p>

 <p class="para">
  下载最新版本的 <a href="https://www.apachelounge.com/download/" class="link external" title="Link : https://www.apachelounge.com/download/">&raquo;&nbsp;Apache 2.x</a>
  以及适合的 PHP 版本。先完成<a href="install.windows.manual.html" class="link">手工安装步骤</a>后再回来继续将
  PHP 集成入 Apache。
 </p>
 
 <p class="para">
  Windows 下有三种方法使 PHP 工作于 Apache 2.x 之中。可以以 handler、CGI、或者 FastCGI 方式运行 PHP。
 </p>

 <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">记住当在
Windows 环境下的 Apache 配置文件中添加路径值时，所有的反斜线，如
<var class="filename">c:\directory\file.ext</var>，应转换为正斜线：
<var class="filename">c:/directory/file.ext</var>。对目录来说，也必须由斜线结尾。</span></p></blockquote>

 <div class="sect2" id="install.windows.apache2.module">
  <h3 class="title">以 Apache handler 方式安装</h3>
  <p class="para">
   需要将以下几行加入到 Apache 的 <var class="filename">httpd.conf</var> 配置文件中以加载 Apache 2.x 的 PHP 模块：
   <div class="example" id="example-21">
    <p><strong>Example #1 PHP 在 Apache 2.x 中作为 handler</strong></p>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 在 PHP 8.0.0 之前，模块的名称是 php7_module
LoadModule php_module &quot;c:/php/php8apache2_4.dll&quot;
&lt;FilesMatch \.php$&gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
# 配置 php.ini 的路径
PHPIniDir &quot;C:/php&quot;</pre>
</div>
    </div>

   </div>
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    必须使用实际的 PHP 路径替换掉上例中的 <var class="filename">c:/php/</var>。
    确保在 <code class="literal">LoadModule</code> 指令中引用的文件位于所指定的位置。
    PHP 7 使用 <var class="filename">php7apache2_4.dll</var>，
    PHP 8 使用  <var class="filename">php8apache2_4.dll</var>。
   </span>
  </p></blockquote>
 </div>

 <div class="sect2" id="install.windows.apache2.cgi">
  <h3 class="title">以 CGI 方式运行 PHP</h3>
  <p class="para">
   要更好地理解在 Apache 下运行 CGI，请参阅
   <a href="http://httpd.apache.org/docs/current/howto/cgi.html" class="link external" title="Link : http://httpd.apache.org/docs/current/howto/cgi.html">&raquo;&nbsp;Apache CGI 文档</a>。
  </p>
  <p class="para">
   要将 PHP 以 CGI 方式运行，需要将 php-cgi 文件放入到用
   ScriptAlias 指令所指定的 CGI 目录中。
  </p>
  <p class="para">
   然后需要给 PHP 文件中添加 <code class="literal">#!</code> 的一行来指明 PHP 可执行文件的位置：
   <div class="example" id="example-22">
    <p><strong>Example #2 Apache 2.x 下 CGI 方式的 PHP</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
#!C:/php/php.exe
&lt;?php
  phpinfo();
?&gt;
</pre></div>
    </div>

   </div>
  </p>
  <div class="warning"><strong class="warning">Warning</strong><p class="para">服务器使用 CGI 方式进行部署可能存在几个公开的缺陷。请阅读
<a href="security.cgi-bin.html" class="link">CGI 安全</a>一章 以学习 如何抵御这些攻击。</p></div>
 </div>

 <div class="sect2" id="install.windows.apache2.fastcgi">
  <h3 class="title">以 FastCGI 方式运行 PHP</h3>

  <p class="para">
   以 FastCGI 方式运行 PHP 比起 CGI 方式有很多优点。设定的方式很直接：
  </p>
  <p class="para">
   从 <a href="https://www.apachelounge.com/download/" class="link external" title="Link : https://www.apachelounge.com/download/">&raquo;&nbsp;https://www.apachelounge.com</a>
   取得 <code class="literal">mod_fcgid</code>，该站点有 Win32 可执行文件的下载。按照下载文件中的指示安装此模块。
  </p>
  <p class="para">
   按以下方法配置 web 服务器，注意用自己系统上的路径替换其中相应的内容：
   
   <div class="example" id="example-23">
    <p><strong>Example #3 配置 Apache 以 FastCGI 方式运行 PHP</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
LoadModule fcgid_module modules/mod_fcgid.so  

# php.ini 文件的位置
FcgidInitialEnv PHPRC        &quot;c:/php&quot; 

&lt;FilesMatch \.php$&gt;
    SetHandler fcgid-script
&lt;/FilesMatch&gt;
FcgidWrapper &quot;c:/php/php-cgi.exe&quot; .php  
</pre></div>
   </div>

   </div>
   此时具有 .php 后缀的文件将被 PHP FastCGI 所解析执行。
  </p>
 </div>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="129524""></a>
  <div class="note">
   <strong class="user">horica78 at yahoo dot com</strong>
   <a href="#129524" class="date">26-May-2024 06:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This for the fastest architecture of Apache on Windows faster than as module for php<br />
<br />
Enable mod_proxy and mod_proxy_fcgi in httpd.conf and run <br />
setx PHP_FCGI_CHILDREN "15" /m<br />
setx PHP_FCGI_MAX_REQUESTS "1000" /m<br />
and download <br />
RunHiddenConsole.exe&nbsp; and start php with c:\hidden\RunHiddenConsole.exe C:\PHP\php-cgi.exe -b 127.0.0.1:9000 and set on VirtualHost :<br />
&lt;Files ~ "\.(php|phtml)$"&gt; <br />
&nbsp;&nbsp;&nbsp; SetHandler "proxy:fcgi://127.0.0.1:9000#"<br />
&nbsp;&nbsp;&nbsp; ProxyFCGIBackendType GENERIC<br />
&nbsp;&nbsp;&nbsp; ProxyFCGISetEnvIf "true" SCRIPT_FILENAME "C:%{reqenv:SCRIPT_FILENAME}" <br />
&nbsp;&nbsp;&nbsp; &lt;/Files&gt;<br />
retar the Apache service and have fun. Cheers from one huge fan of</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118522""></a>
  <div class="note">
   <strong class="user">a user</strong>
   <a href="#118522" class="date">20-Dec-2015 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having issues getting the PHPIniDir or LoadModule directives to work and all the suggestions already given do not help, double-check if you are not using fancy quotes around your paths (' '&nbsp; " ").<br />
<br />
This happened to me because I copied the statements from a random website. In my text editor the difference was barely noticeable, but to Apache it certainly is!<br />
<br />
For example, this will not work:<br />
PHPIniDir "C:/PHP7"<br />
<br />
But this will work:<br />
PHPIniDir "C:/PHP7"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115155""></a>
  <div class="note">
   <strong class="user">kynetikmedia at gmail dot com</strong>
   <a href="#115155" class="date">04-Jun-2014 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
****Installed and Working 1- Fell Swoop - UPDATED****<br />
Installed on Windows 8.1 XPS 12 - Dell 8GB RAM 128GB SSD - <br />
Notes - Complications due to Apache latest version causes issues with the PHP handler on install.&nbsp; Following below will get it run right off the bat.&nbsp; <br />
<br />
Getting and installing Apache<br />
<br />
1&nbsp; In your browser go to h t t p : / / h t t p d . a p a c h e . o r g / d o w n l o a d . c g i<br />
&nbsp;&nbsp; (without the spaces) - You will need to go 'Other Files' , 'Binaries' , 'W32', and then your installer MSI will be listed as below.&nbsp; <br />
2&nbsp; Click on&nbsp; httpd-2.2.25-win32-x86-no_ssl.msi<br />
&nbsp;&nbsp; (this is a self-installing executable file without crypto ... no Secure Socket Layer)<br />
&nbsp;&nbsp; (2.2.25was the latest version on June 4, 2014)<br />
3&nbsp; Click on the httpd-2.2.25-win32-x86-no_ssl.msi file after it downloads <br />
&nbsp;&nbsp; (single click on the file tab in Chrome or double click on the actual file in Downloads)<br />
4&nbsp; Click Next<br />
5&nbsp; Click I accept the terms in the license agreement<br />
6&nbsp; Click Next<br />
7&nbsp; Click Next<br />
8&nbsp; Type localhost in the top box<br />
9&nbsp; Type localhost in the middle box<br />
10 Type admin@localhost.com in the bottom box<br />
11 Click Next<br />
12 Click Next<br />
13 Click Next<br />
14 Click Install and wait<br />
15 Cick Yes to allow the program to make changes<br />
16 Click Finish<br />
<br />
Testing Apache<br />
<br />
1&nbsp; Type localhost in your browser location box (I use Chrome) or type h t t p : / / l o c a l h o s t<br />
&nbsp;&nbsp; (without the spaces)<br />
2&nbsp; The message It works! should appear.<br />
<br />
Getting and installing PHP<br />
<br />
1&nbsp; In your browser go to h t t p : / / w i n d o w s . p h p . n e t / d o w n l o a d /<br />
&nbsp;&nbsp; (without the spaces)<br />
2&nbsp; Click on the Installer link under PHP 5.3 (5.3.10)&nbsp;&nbsp; VC9 x86 Thread Safe<br />
&nbsp;&nbsp; (Ignore the Do NOT use VC9 version with apache.org binaries comment on the side panel)<br />
3&nbsp; Click on the php-5.3.10-Win32-VC9-x86.msi file after in downloads<br />
&nbsp;&nbsp; (single click on the file tab in Chrome or double click on the actual file in Downloads)<br />
4&nbsp; Click Next<br />
5&nbsp; Click I accept the terms in the License Agreement<br />
6&nbsp; Click Next<br />
7&nbsp; Click Next<br />
8&nbsp; Click Apache 2.2.x Module<br />
9&nbsp; Click Next<br />
10 Click Browse<br />
11 Double click Apache Software Foundation<br />
12 Double click Apache 2.2<br />
13 Double click conf<br />
14 Click OK<br />
15 Click Next<br />
16 Click Next<br />
17 Click Install and wait<br />
18 Cick Yes to allow the program to make changes<br />
19 Click Finish<br />
<br />
Testing PHP with Apache<br />
<br />
1&nbsp; Open Notepad<br />
2&nbsp; Type 'left bracket character'?php phpinfo(); ?'right bracket character'<br />
3&nbsp; Save the file to C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs as test.php<br />
4&nbsp; Type localhost/test.php in your browser location box (I use Chrome) or type h t t p : / / l o c a l h o s t / t e s t . p h p<br />
5&nbsp; A table with title PHP Version ... should appear<br />
<br />
DONE</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114118""></a>
  <div class="note">
   <strong class="user">wolfeh1994 at yahoo dot com</strong>
   <a href="#114118" class="date">13-Jan-2014 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please for the love of god, download the threaded version. I spent over an hour trying to figure out why php5apache2.dll could not be found, and while desperately looking through manuals I went into the php 5 structure and found that it doesn't exist in the non-threaded version.<br />
<br />
This really could use a mention somewhere other than the PHP 5 structure, like the paragraph to the left of the homepage which talks about which PHP version to choose, or this part of the manual which covers Apache... Anywhere but structure, seriously. I would have never guessed to look there.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111787""></a>
  <div class="note">
   <strong class="user">Amaroq</strong>
   <a href="#111787" class="date">28-Mar-2013 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Like someone else mentioned, on the Windows download page for PHP, ignore the warning about not downloading the VC9 compiled installers for the Apache.org version of Apache.<br />
<br />
Whoever wrote that is guaranteeing that people install a PHP that breaks their Apache server. (On Windows 7 anyway.) The installer failed to write the correct path info to httpd.conf, and even after fixing that manually, Apache wouldn't start because of missing dlls.<br />
<br />
Ignore that dumb warning and get the newest installer anyway. Everything just plain works with no hassle and no hunting down dll files over google.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108429""></a>
  <div class="note">
   <strong class="user">a solution for simpletons like me</strong>
   <a href="#108429" class="date">25-Apr-2012 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Installing Apache and PHP on Windows 7 Home Premium on a Gateway NV75S laptop with a quad AMD A6-3400M<br />
<br />
All I need to do with these programs is to test my website out on my laptop.&nbsp; I have HTML and PHP files. I do not need MySQL as I use html5 storage.<br />
<br />
Getting and installing Apache<br />
<br />
1&nbsp; In your browser go to h t t p : / / h t t p d . a p a c h e . o r g / d o w n l o a d . c g i<br />
&nbsp;&nbsp; (without the spaces)<br />
2&nbsp; Click on&nbsp; httpd-2.2.22-win32-x86-no_ssl.msi<br />
&nbsp;&nbsp; (this is a self-installing executable file without crypto ... no Secure Socket Layer)<br />
&nbsp;&nbsp; (2.2.22 was the latest version on April 25, 2012)<br />
3&nbsp; Click on the httpd-2.2.22-win32-x86-no_ssl.msi file after it downloads <br />
&nbsp;&nbsp; (single click on the file tab in Chrome or double click on the actual file in Downloads)<br />
4&nbsp; Click Next<br />
5&nbsp; Click I accept the terms in the license agreement<br />
6&nbsp; Click Next<br />
7&nbsp; Click Next<br />
8&nbsp; Type localhost in the top box<br />
9&nbsp; Type localhost in the middle box<br />
10 Type admin@localhost.com in the bottom box<br />
11 Click Next<br />
12 Click Next<br />
13 Click Next<br />
14 Click Install and wait<br />
15 Cick Yes to allow the program to make changes<br />
16 Click Finish<br />
<br />
Testing Apache<br />
<br />
1&nbsp; Type localhost in your browser location box (I use Chrome) or type h t t p : / / l o c a l h o s t<br />
&nbsp;&nbsp; (without the spaces)<br />
2&nbsp; The message It works! should appear.<br />
<br />
Getting and installing PHP<br />
<br />
1&nbsp; In your browser go to h t t p : / / w i n d o w s . p h p . n e t / d o w n l o a d /<br />
&nbsp;&nbsp; (without the spaces)<br />
2&nbsp; Click on the Installer link under PHP 5.3 (5.3.10)&nbsp;&nbsp; VC9 x86 Thread Safe<br />
&nbsp;&nbsp; (Ignore the Do NOT use VC9 version with apache.org binaries comment on the side panel)<br />
3&nbsp; Click on the php-5.3.10-Win32-VC9-x86.msi file after in downloads<br />
&nbsp;&nbsp; (single click on the file tab in Chrome or double click on the actual file in Downloads)<br />
4&nbsp; Click Next<br />
5&nbsp; Click I accept the terms in the License Agreement<br />
6&nbsp; Click Next<br />
7&nbsp; Click Next<br />
8&nbsp; Click Apache 2.2.x Module<br />
9&nbsp; Click Next<br />
10 Click Browse<br />
11 Double click Apache Software Foundation<br />
12 Double click Apache 2.2<br />
13 Double click conf<br />
14 Click OK<br />
15 Click Next<br />
16 Click Next<br />
17 Click Install and wait<br />
18 Cick Yes to allow the program to make changes<br />
19 Click Finish<br />
<br />
Testing PHP with Apache<br />
<br />
1&nbsp; Open Notepad<br />
2&nbsp; Type 'left bracket character'?php phpinfo(); ?'right bracket character'<br />
3&nbsp; Save the file to C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs as test.php<br />
4&nbsp; Type localhost/test.php in your browser location box (I use Chrome) or type h t t p : / / l o c a l h o s t / t e s t . p h p<br />
5&nbsp; A table with title PHP Version ... should appear<br />
<br />
DONE</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101019""></a>
  <div class="note">
   <strong class="user">farinspace</strong>
   <a href="#101019" class="date">20-Nov-2010 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running PHP under FastCGI:<br />
<br />
Besides the following in your httpd.conf<br />
<br />
&nbsp;&nbsp;&nbsp; LoadModule fcgid_module modules/mod_fcgid.so&nbsp; <br />
&nbsp;&nbsp;&nbsp; FcgidInitialEnv PHPRC "c:/php" <br />
&nbsp;&nbsp;&nbsp; AddHandler fcgid-script .php&nbsp; <br />
&nbsp;&nbsp;&nbsp; FcgidWrapper "c:/php/php-cgi.exe" .php<br />
<br />
Remember to add the following to the default &lt;Directory "C:/apache/htdocs"&gt; block (or virtual host blocks):<br />
<br />
&nbsp;&nbsp;&nbsp; Options ExecCGI</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95039""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#95039" class="date">10-Dec-2009 01:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If anybody here encounters an error regarding PHPIniDir, change PHPIniDir "C:/php/" to PHPIniDir "C:\php\".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
