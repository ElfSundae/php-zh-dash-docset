<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>将 Unix 时间戳转换为儒略日数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.juliantojd.html">? juliantojd</a></li>
      <li style="float: right;"><a href="book.datetime.html">日期/时间 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.calendar.html">Calendar 函数</a></li>
    <li>将 Unix 时间戳转换为儒略日数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.unixtojd" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">unixtojd</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">unixtojd</span> &mdash; <span class="dc-title">将 Unix 时间戳转换为儒略日数</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.unixtojd-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>unixtojd</strong></span>(<span class="methodparam"><span class="type"><span class="type"><a href="language.types.null.html" class="type null">?</a></span><span class="type"><a href="language.types.integer.html" class="type int">int</a></span></span> <code class="parameter">$timestamp</code><span class="initializer"> = <strong><code><a href="reserved.constants.html#constant.null">null</a></code></strong></span></span>): <span class="type"><span class="type"><a href="language.types.integer.html" class="type int">int</a></span>|<span class="type"><a href="language.types.value.html" class="type false">false</a></span></span></div>

  <p class="para rdfs-comment">
   根据指定的 Unix <code class="parameter">timestamp</code> （自 1970 年 1 月 1 日以来的秒数）返回儒略日数。如果没有指定时间戳则返回当前日期的儒略日数。
   无论哪种方式，时间都被视为当地时间（不是 UTC）。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.unixtojd-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt><code class="parameter">timestamp</code></dt>
     <dd>
      <p class="para">
       用于转换的 unix 时间戳。
      </p>
     </dd>
    
   </dl>
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.unixtojd-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   int 类型的儒略日数， 或者在失败时返回 <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.unixtojd-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">timestamp</code> 现在可以为 null。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 seealso" id="refsect1-function.unixtojd-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.jdtounix.html" class="function" rel="rdfs-seeAlso">jdtounix()</a> - 将儒略日数转换为 Unix 时间戳</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="129274""></a>
  <div class="note">
   <strong class="user">unixtojd at isslow dot com</strong>
   <a href="#129274" class="date">24-Feb-2024 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
unixtojd is slow.<br />
Direct arithmetics calculations are faster and still coherent with original unixtojd.<br />
<br />
Feel free to add a test on $timestamp to set it to time() when $timestamp is null.<br />
<br />
function fast_unixtojd($timestamp){<br />
&nbsp;&nbsp;&nbsp; return intval($timestamp / 86400 + 2440588);<br />
}<br />
<br />
$time = time();<br />
$t_unixtojd = 0;<br />
$t_fast_unixtojd = 0;<br />
for ($t = $time - 240 * 3600; $t &lt; $time; $t++) {<br />
&nbsp;&nbsp;&nbsp; $time1 = microtime(true);<br />
&nbsp;&nbsp;&nbsp; $a = unixtojd($t);<br />
&nbsp;&nbsp;&nbsp; $time2 = microtime(true);<br />
&nbsp;&nbsp;&nbsp; $b = fast_unixtojd($t);<br />
&nbsp;&nbsp;&nbsp; $time3 = microtime(true);<br />
&nbsp;&nbsp;&nbsp; if ($a != $b) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "$a $b $t\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $t_unixtojd += $time2 - $time1;<br />
&nbsp;&nbsp;&nbsp; $t_fast_unixtojd += $time3 - $time2;<br />
}<br />
echo "unixtojd: $t_unixtojd sec\nfast_unixtojd: $t_fast_unixtojd sec\n";<br />
<br />
unixtojd: 0.42854166030884 sec<br />
fast_unixtojd: 0.13218021392822 sec</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74196""></a>
  <div class="note">
   <strong class="user">hrabi at linuxwaves dot com</strong>
   <a href="#74196" class="date">29-Mar-2007 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
according to <a href="http://www.decimaltime.hynes.net/dates.html#jd and reading " rel="nofollow" target="_blank">http://www.decimaltime.hynes.net/dates.html#jd and reading </a>"X. Calendar Functions" on this side, it seems that php "jd" is precisely mean as "Chronological Julian Day" (should it be named cjd, and primarily strictly mentioned - isn't it?), used for covnersion between calendar systems. Than it's ok (but Incomplete manual is strongly confusing here IMHO).<br />
Even that, cJD is adjusted to a local time, so... I am rather babeled now, so nothing else :-).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74194""></a>
  <div class="note">
   <strong class="user">hrabi at linuxwaves dot com</strong>
   <a href="#74194" class="date">29-Mar-2007 03:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is unusable. Julian Day start at noon, not midnight. It's better to use Fabio solution (however there is a lurk problem with leap second).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mmd</span><span class="keyword">(</span><span class="default">$txt</span><span class="keyword">, </span><span class="default">$str_time</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$str_time</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$j </span><span class="keyword">= </span><span class="default">unixtojd</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">gmstrftime</span><span class="keyword">(</span><span class="string">'%D %T %Z'</span><span class="keyword">, </span><span class="default">$t</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$j_fabio </span><span class="keyword">= </span><span class="default">$t </span><span class="keyword">/ </span><span class="default">86400 </span><span class="keyword">+ </span><span class="default">2440587.5</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"</span><span class="keyword">${</span><span class="default">txt</span><span class="keyword">}</span><span class="string"> =&gt; (%s) %s, %s U, %s J, or %s J&lt;br&gt;\n"</span><span class="keyword">, </span><span class="default">$str_time</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">, </span><span class="default">$t</span><span class="keyword">, </span><span class="default">$j</span><span class="keyword">, </span><span class="default">$j_fabio</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">//$xt = strtotime("1.1.1970 15:00.00 GMT");<br />
</span><span class="default">$sam </span><span class="keyword">= </span><span class="string">"9.10.1995 02:00.01 GMT"</span><span class="keyword">;<br />
</span><span class="default">$spm </span><span class="keyword">= </span><span class="string">"9.10.1995 22:00.01 GMT"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// unixtojd for $spm returns 2450000 (OK), but for $sam returns 2450000 too! (it is wrong).<br />
</span><span class="default">mmd</span><span class="keyword">(</span><span class="string">"am"</span><span class="keyword">, </span><span class="default">$sam</span><span class="keyword">);&nbsp; </span><span class="comment">// should be 2449999 (+ 0.58334)<br />
</span><span class="default">mmd</span><span class="keyword">(</span><span class="string">"pm"</span><span class="keyword">, </span><span class="default">$spm</span><span class="keyword">);&nbsp; </span><span class="comment">// should be 2450000 (+ 0.41668)<br />
</span><span class="default">?&gt;<br />
</span><br />
reference<br />
unix time, and UTC, TAI, ntp, ... problems: <a href="http://en.wikipedia.org/wiki/Unix_time" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Unix_time</a><br />
Julian Date Converter: <a href="http://aa.usno.navy.mil/data/docs/JulianDate.html" rel="nofollow" target="_blank">http://aa.usno.navy.mil/data/docs/JulianDate.html</a><br />
history overview: <a href="http://parris.josh.com.au/humour/work/17Nov1858.shtml" rel="nofollow" target="_blank">http://parris.josh.com.au/humour/work/17Nov1858.shtml</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69310""></a>
  <div class="note">
   <strong class="user">fabio at llgp dot org</strong>
   <a href="#69310" class="date">31-Aug-2006 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need an easy way to convert an unix timestamp to a decimal julian day you can use:<br />
<br />
$julianDay = $unixTimeStamp / 86400 + 2440587.5;<br />
<br />
86400 is the number of seconds in a day;<br />
2440587.5 is the julian day at 1/1/1970 0:00 UTC.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68798""></a>
  <div class="note">
   
   <a href="#68798" class="date">10-Aug-2006 07:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Its clearly stated that this function returns the Julian Day, not Julian Day + time.<br />
<br />
If you want the time with it you will have to do something like:<br />
<br />
$t=time();<br />
$jd=unixtojd($t)+($t%60*60*24)/60*60*24;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37559""></a>
  <div class="note">
   <strong class="user">johnston at capsaicin dot ca</strong>
   <a href="#37559" class="date">19-Nov-2003 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also note that epoch is in UTC time (epoch is a specific point in time - epoch is not different for every time zone), so be aware of timezone complexities.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
