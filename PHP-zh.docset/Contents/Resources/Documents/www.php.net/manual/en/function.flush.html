<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>冲刷系统输出缓冲区</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ref.outcontrol.html">? 输出控制 函数</a></li>
      <li style="float: right;"><a href="function.ob-clean.html">ob_clean ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.outcontrol.html">输出控制 函数</a></li>
    <li>冲刷系统输出缓冲区</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.flush" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">flush</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">flush</span> &mdash; <span class="dc-title">冲刷系统输出缓冲区</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.flush-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>flush</strong></span>(): <span class="type"><a href="language.types.void.html" class="type void">void</a></span></div>

  <p class="para rdfs-comment">
   冲刷 PHP 的系统写入缓冲区以及 PHP 使用的后端（CGI、Web 服务器）。在命令行环境中，<span class="function"><strong>flush()</strong></span>
   将仅尝试冲刷缓冲区的内容，而在 Web 上下文中，将冲刷 header 和缓冲区的内容。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    <span class="function"><strong>flush()</strong></span> 可能无法重写 Web 服务器的缓冲方案，并且它对浏览器中的任何客户端缓冲没有影响。
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    此函数对用户级输出处理程序（例如由 <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> 或 <span class="function"><a href="function.output-add-rewrite-var.html" class="function">output_add_rewrite_var()</a></span>
    启动的处理程序）没有任何影响。
   </span>
  </p></blockquote>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    <span class="function"><strong>flush()</strong></span> 会干扰在 Web 上下文中设置和发送 header 的输出处理程序（例如
    <span class="function"><a href="function.ob-gzhandler.html" class="function">ob_gzhandler()</a></span>），因为它会在这些处理程序之前发送 header。
   </p>
  </div>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.flush-parameters">
  <h3 class="title">参数</h3>
  <p class="para">此函数没有参数。</p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.flush-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   没有返回值。
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.flush-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.ob-flush.html" class="function" rel="rdfs-seeAlso">ob_flush()</a> - 冲刷（发送）活动输出处理程序的返回值</span></li>
    <li><span class="function"><a href="function.ob-clean.html" class="function" rel="rdfs-seeAlso">ob_clean()</a> - 清空（擦掉）活动输出缓冲区的内容</span></li>
    <li><span class="function"><a href="function.ob-end-flush.html" class="function" rel="rdfs-seeAlso">ob_end_flush()</a> - 冲刷（发送）活动输出处理程序的返回值，并关闭活动输出缓冲区</span></li>
    <li><span class="function"><a href="function.ob-end-clean.html" class="function" rel="rdfs-seeAlso">ob_end_clean()</a> - 清空（擦除）活动缓冲区的内容并关闭它</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="129259""></a>
  <div class="note">
   <strong class="user">remco dot pc at outlook dot com</strong>
   <a href="#129259" class="date">18-Feb-2024 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
on php8.3-fpm with apache 2.4.57<br />
<br />
In order flush to work in the browser you need to send some more data (at least 4096 bytes / flush) and you need to add a setting for that site to the virtual host of your apache2 configuration:<br />
<br />
&lt;FilesMatch \.php$&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; SetHandler "proxy:unix:/run/php/php8.3-fpm.sock|fcgi://localhost"<br />
&lt;/FilesMatch&gt;<br />
&lt;Proxy fcgi://localhost/"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ProxySet enablereuse=on flushpackets=on<br />
&lt;/Proxy&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125306""></a>
  <div class="note">
   <strong class="user">fran at fran dot cr</strong>
   <a href="#125306" class="date">28-Aug-2020 03:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to make flush work when using php-fpm from Apache httpd with mod_proxy_fcgi, since 2.4.31 you can append flushpackets=on to enable flushing, which is instant by default, and and flushwait=n where n is in milliseconds to delay the flushing time for performance seconds.<br />
<br />
These values can be appended to the &lt;Proxy&gt; directive, e.g. &lt;Proxy "fcgi://localhost/" flushpackets=on flushwait=500&gt; or in ProxyPass and ProxyPassMatch lines.<br />
<br />
The mod_proxy_fcgi documentation for 2.4 does not document this, but it is available in the 2.5 or trunk documentation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124861""></a>
  <div class="note">
   <strong class="user">glafarge</strong>
   <a href="#124861" class="date">27-Mar-2020 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using PHP with mode CGI/FastCGI there is a new buffer (initiated by mod_fcgid with a default size of 65536 bytes). That causes `flush()` and `ob_flush()` not working as expected with implicit_flush(true).<br />
Setting "OutputBufferSize 0" in mod_fcgid config resolves the issue.<br />
Hope it helps !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124096""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#124096" class="date">07-Aug-2019 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding buffering by browser you can use:<br />
<br />
$out=str_pad($yourMessage.'&lt;br/&gt;',1024);<br />
print($out);<br />
ob_flush();<br />
flush();<br />
<br />
Works for me in Firefox 60 ESR.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118116""></a>
  <div class="note">
   <strong class="user">php nospace juju ta ggooggle mail</strong>
   <a href="#118116" class="date">06-Oct-2015 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
combining some ideas i was finally able to get a long running script to give me real time feedback on what it was doing.&nbsp; this was a wamp setup with php running as cgi.&nbsp; i'm pretty sure that apache just wasn't sending any of the buffered output because it was trying to be helpful. also trying to be helpful, i hope this example solution helps someone.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// thx mandor at mandor<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'max_execution_time'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'implicit_flush'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">ob_implicit_flush</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
<br />
echo </span><span class="string">'doing something'</span><span class="keyword">;&nbsp; </span><span class="default">my_flush</span><span class="keyword">();<br />
</span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo </span><span class="string">'doing something else'</span><span class="keyword">; </span><span class="default">my_flush</span><span class="keyword">();<br />
</span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
echo </span><span class="string">'finally done - hooray'</span><span class="keyword">;<br />
<br />
function </span><span class="default">my_flush</span><span class="keyword">() {<br />
&nbsp; </span><span class="comment">// following matt at hevanet's lead<br />
&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">10000</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) echo </span><span class="string">' '</span><span class="keyword">;<br />
&nbsp; </span><span class="default">ob_flush</span><span class="keyword">();<br />
&nbsp; </span><span class="default">flush</span><span class="keyword">();<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113360""></a>
  <div class="note">
   <strong class="user">php at stelio dot net</strong>
   <a href="#113360" class="date">01-Oct-2013 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For a Windows system using IIS, the ResponseBufferLimit takes precedence over PHP's output_buffering settings. So you must also set the ResponseBufferLimit to be something lower than its default value.<br />
<br />
For IIS versions older than 7, the setting can be found in the %windir%\System32\inetsrv\fcgiext.ini file (the FastCGI config file). You can set the appropriate line to:<br />
&nbsp; ResponseBufferLimit=0<br />
<br />
For IIS 7+, the settings are stored in %windir%\System32\inetsrv\config. Edit the applicationHost.config file and search for PHP_via_FastCGI (assuming that you have installed PHP as a FastCGI module, as per the installation instructions, with the name PHP_via_FastCGI). Within the add tag, place the following setting at the end:<br />
&nbsp; responseBufferLimit="0"<br />
So the entire line will look something like:<br />
&nbsp; &lt;add name="PHP_via_FastCGI" path="*.php" verb="*" modules="FastCgiModule" scriptProcessor="C:\PHP\php-cgi.exe" resourceType="Either" responseBufferLimit="0" /&gt;<br />
Alternatively you can insert the setting using the following command:<br />
&nbsp; %windir%\system32\inetsrv\appcmd.exe set config /section:handlers "/[name='PHP_via_FastCGI'].ResponseBufferLimit:0"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109239""></a>
  <div class="note">
   <strong class="user">Kris</strong>
   <a href="#109239" class="date">29-Jun-2012 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a bunch of problems trying to get flush working on my windows box, I finally found a solution after reading everyones here and it not working.<br />
<br />
1) Set output_buffering = 0<br />
2) Set zlib.output_compression = 0<br />
<br />
I then used Wireshark to monitor network packets, and indeed the server was pusing the data, but the browser was not displaying it.. So it was a browser buffer issue (I am on Firefox 13)<br />
<br />
For me I needed to send about 1k of data before it would display the data. To do this I added more header information.. <br />
&nbsp;In php.ini I set default_charset = "utf-8"<br />
And that was enough to give me enough for the buffer issue.<br />
<br />
You can also try doing <br />
echo str_repeat(" ", 1024), "\n";<br />
at the start of the script.<br />
<br />
hope this helps</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99988""></a>
  <div class="note">
   <strong class="user">seb dot field at gmail dot com</strong>
   <a href="#99988" class="date">18-Sep-2010 03:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If flush() function does not work. You must set next options in php.ini like:<br />
<br />
--[code]--<br />
&nbsp;output_buffering = Off&nbsp; <br />
&nbsp;;output_handler =&nbsp;&nbsp; <br />
&nbsp;zlib.output_compression = Off&nbsp; <br />
&nbsp;;zlib.output_handler =&nbsp;&nbsp; <br />
--[^code^]--<br />
<br />
If things does not work you must view headers from the server and check `Server` string.<br />
In my case, as the frontend was Nginx webserver and Apache work as backend.<br />
Accordingly, buffering must be disabled in Nginx config file.<br />
To stop buffering you must add next string to config file:<br />
<br />
--[code]--<br />
proxy_buffering off;<br />
--[^code^]--<br />
<br />
and restart Nginx daemon.&nbsp; More information about&nbsp; configuration you find in documentation on the nginx website.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87807""></a>
  <div class="note">
   <strong class="user">mandor at mandor dot net</strong>
   <a href="#87807" class="date">22-Dec-2008 07:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is what I use to turn off pretty much anything that could cause unwanted output buffering and turn on implicit flush:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">@</span><span class="default">apache_setenv</span><span class="keyword">(</span><span class="string">'no-gzip'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'zlib.output_compression'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'implicit_flush'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">ob_get_level</span><span class="keyword">(); </span><span class="default">$i</span><span class="keyword">++) { </span><span class="default">ob_end_flush</span><span class="keyword">(); }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ob_implicit_flush</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
If it still fails though, keep in mind that Internet Explorer and Safari have a 1k buffer before incremental rendering kicks in, so you'll want to output some padding as well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87040""></a>
  <div class="note">
   <strong class="user">Arerano</strong>
   <a href="#87040" class="date">16-Nov-2008 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This helped me getting flushing to work.<br />
Using apache with deflate.<br />
<br />
Turning compression off for this script: (add it somewhere at the top of the script)<br />
apache_setenv('no-gzip', '1');<br />
<br />
However, this only works if php is running as a module rather than a cgi-extension and safe mode must be disabled.<br />
<br />
You can also turn the compression off for a directory by making a .htaccess file and adding the following entry:<br />
mod_gzip_on Off<br />
<br />
However that affects the whole directory.<br />
Hope I could help.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83037""></a>
  <div class="note">
   <strong class="user">David</strong>
   <a href="#83037" class="date">07-May-2008 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mod_security 2.x core rules will also prevent flush() from working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75115""></a>
  <div class="note">
   <strong class="user">mbilliet at gmail dot com</strong>
   <a href="#75115" class="date">13-May-2007 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
I had the same problems with sending a javascript after the &lt;body&gt;&lt;/body&gt; content has been sent to the browser (the script updates the content of an iframe).<br />
<br />
Two solutions work for me:<br />
&nbsp;&nbsp; - add enough data (i.e.: extra dummy text like spaces) or,<br />
&nbsp;&nbsp; - echo the '&lt;/body&gt;' tag at the end of the page<br />
<br />
Note, that for the latter to work one should:<br />
&nbsp;&nbsp; - turn of output_buffering in php.ini and either:<br />
&nbsp;&nbsp; &nbsp;&nbsp; * turn on implicit_flush in its php.ini or,<br />
&nbsp;&nbsp; &nbsp;&nbsp; * call ob_implicit_flush(); at the beginning of a script<br />
<br />
I preferr echoing the '&lt;/body&gt;' tag at the end as it doesn't require any extra data to be sent over the wire and its much a neater coding technique.<br />
<br />
Notes:<br />
&nbsp;&nbsp; - these worakarounds aren't needed when using perl and cgi,... .<br />
&nbsp;&nbsp; - you can leave the zlib.output_compression in your php.ini switched on<br />
<br />
Kind regards and hoped this is of any help.<br />
<br />
Maurits</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74222""></a>
  <div class="note">
   <strong class="user">Leon</strong>
   <a href="#74222" class="date">30-Mar-2007 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've spent days trying to figure out why flush didn't work all of a sudden, while it used to work perfectly. Apparently, it was McAfee Spamkiller that caused problems. Disabling it didn't work, I had to completely remove it. Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72985""></a>
  <div class="note">
   <strong class="user">Kirk</strong>
   <a href="#72985" class="date">06-Feb-2007 12:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're not explictly using the buffering functions, then ob_flush() is only necessary if output buffering is turned on in your php.ini file.<br />
<br />
flush() is only necessary if implicit_flush is turned off in your php.ini file. Setting implicit_flush to on will remove the need for all these flush() calls, but it's generally only good in an extremely controlled environment. Turning on implicit_flush in a production environment can be bad.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68620""></a>
  <div class="note">
   <strong class="user">no at spam dot com</strong>
   <a href="#68620" class="date">03-Aug-2006 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ob_flush();flush();<br />
<br />
Not the other way around, because it wont work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57398""></a>
  <div class="note">
   <strong class="user">mikael at oebb dot net</strong>
   <a href="#57398" class="date">03-Oct-2005 01:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi all.<br />
Been scratching my head over data NOT flushed to IE (6) even though I tried strpad 4096 chars, all headers OK,&nbsp; TABLE and no TABLE, flush and ob_flush - still a blank page. Tried adding a sleep(1) before flushing - and everything worked as a charm.&nbsp; <br />
<br />
/Mikael</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54841""></a>
  <div class="note">
   <strong class="user">js at jeansebastien dot com</strong>
   <a href="#54841" class="date">16-Jul-2005 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will show each line at a time with a pause of 2 seconds.<br />
(Tested under IEx and Firefox)<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (</span><span class="default">ob_get_level</span><span class="keyword">() == </span><span class="default">0</span><span class="keyword">) </span><span class="default">ob_start</span><span class="keyword">();<br />
<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">10</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br&gt; Line to show."</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">,</span><span class="default">4096</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ob_flush</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">flush</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">);<br />
}<br />
<br />
echo </span><span class="string">"Done."</span><span class="keyword">;<br />
<br />
</span><span class="default">ob_end_flush</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52863""></a>
  <div class="note">
   <strong class="user">MOELZE ?T GMX DOt DE   (Michael)</strong>
   <a href="#52863" class="date">15-May-2005 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is a bit complicated to work with the funktion flush() and you have to experiment with it a bit.
<br />
So if you design a site which has a timeloop at the end that calls a other site via a form data input (Data Submit) you have
<br />
to give something out to the buffer to get that new site loaden quick.
<br />

<br />
For example:
<br />

<br />
<span class="default">&lt;?php
<br />
$instant</span><span class="keyword">=</span><span class="default">gettimeofday</span><span class="keyword">();
<br />
</span><span class="default">$timenow</span><span class="keyword">=</span><span class="default">$instant</span><span class="keyword">[</span><span class="string">"sec"</span><span class="keyword">];</span><span class="comment">//Start Time
<br />

<br />
//timeloop(e.g. for security_save after 30 min)
<br />
</span><span class="keyword">while (</span><span class="default">1</span><span class="keyword">) { echo </span><span class="string">"&lt;b&gt;&lt;/b&gt;"</span><span class="keyword">;</span><span class="comment">//Useless (only to quickload next
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //or same Site when do a switch)
<br />
</span><span class="default">flush</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//giveout buffer
<br />
</span><span class="default">$instant</span><span class="keyword">=</span><span class="default">gettimeofday</span><span class="keyword">();
<br />
</span><span class="default">$timeactual</span><span class="keyword">=</span><span class="default">$instant</span><span class="keyword">[</span><span class="string">"sec"</span><span class="keyword">]; </span><span class="comment">//get Actual Time in Secs
<br />
</span><span class="default">$flag</span><span class="keyword">=((</span><span class="default">$timeactual</span><span class="keyword">&gt;</span><span class="default">$timenow</span><span class="keyword">+</span><span class="default">$diff</span><span class="keyword">)? </span><span class="default">1</span><span class="keyword">:</span><span class="default">0</span><span class="keyword">);</span><span class="comment">//$diff=switchTime
<br />
</span><span class="keyword">if (</span><span class="default">$flag</span><span class="keyword">) { </span><span class="default">what_do_at_switch_Time</span><span class="keyword">();</span><span class="comment">//Sec.Save etc.etc.
<br />
</span><span class="default">$timenow</span><span class="keyword">=</span><span class="default">$timeactual</span><span class="keyword">; } </span><span class="comment">//Set new Start Time
<br />
</span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">); </span><span class="comment">//Or so...(Important)
<br />
</span><span class="keyword">} </span><span class="comment">//End of while-Loop
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
So you can programm a security save or other function in your site and if you do a switch the upload of the new or same site (the called site) works...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51920""></a>
  <div class="note">
   <strong class="user">Marty</strong>
   <a href="#51920" class="date">14-Apr-2005 08:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an extention of Rusty's comment below: <br />
<br />
After sitting here for hours trying to make IE6 flush data out in the middle of a page (with it working perfectly in Firefox), I finally figured out the problem. IE will not display flushed data (even if it has it) unless the table that contains it is complete.<br />
<br />
Every new element you want IE to display must not be in ANY kind of table at all. You must end all your tables.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51679""></a>
  <div class="note">
   <strong class="user">Ghostshaw at spymac dot com</strong>
   <a href="#51679" class="date">07-Apr-2005 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to point out that there is a function to replace ob_flush and flush. If you set ob_implicit_flush(true); at the top of the page it will automatically flush any echo or print you do in the rest of the script.<br />
<br />
Note that you still need a minimum amount of data to come through the browser filter. I would advice using str_pad($text,4096); since this automatically lenghtens the text with spaces to 4 KB which is the minimum limit when using FireFox and linux.<br />
<br />
I hope this helps you all out a bit.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51143""></a>
  <div class="note">
   <strong class="user">matt at nospamplease dot hevanet dot com</strong>
   <a href="#51143" class="date">21-Mar-2005 10:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Like IE, Safari needs a fair amount of data before it'll display anything, actually more than explorer.&nbsp; The following code works for me in Firefox and Safari, and should work in IE as well.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">40000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
{<br />
echo </span><span class="string">' '</span><span class="keyword">; </span><span class="comment">// extra spaces<br />
</span><span class="keyword">}<br />
</span><span class="comment">// keeps it flowing to the browser?<br />
</span><span class="default">flush</span><span class="keyword">();<br />
</span><span class="comment">// 50000 microseconds keeps things flowing in safari, IE, firefox, etc<br />
</span><span class="default">usleep</span><span class="keyword">(</span><span class="default">50000</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This code came from a comment on a blog discussing browser functionality with flush();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50624""></a>
  <div class="note">
   <strong class="user">crmacd at yahoo dot com</strong>
   <a href="#50624" class="date">04-Mar-2005 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I figured out a way to create a simple progress bar that is for the most part cross platform. Seeing as I got my ideas from this site it's only share to give back to the community.<br />
<br />
Note: Something interesting about browser buffering... you have to have the &lt;html&gt;&lt;body&gt; for Firefox and some other browsers to recognize items by their id in Javascript. So I recommend using some sort of header function before calling this function.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">fn_progress_bar</span><span class="keyword">(</span><span class="default">$intCurrentCount </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">, </span><span class="default">$intTotalCount </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$intNumberRuns </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$intDisplayedCurrentPercent </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strProgressBar </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dblPercentIncrease </span><span class="keyword">= (</span><span class="default">100 </span><span class="keyword">/ </span><span class="default">$intTotalCount</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$intCurrentPercent </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$intCurrentCount </span><span class="keyword">* </span><span class="default">$dblPercentIncrease</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$intNumberRuns</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">1 </span><span class="keyword">== </span><span class="default">$intNumberRuns</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strProgressBar </span><span class="keyword">= &lt;&lt;&lt; BAR<br />
</span><span class="string">&lt;table width='50%' id='progress_bar' summary='progress_bar' align='center'&gt;&lt;tbody&gt;&lt;tr&gt;<br />
&lt;td id='progress_bar_complete' width='0%' align='center' style='background:#CCFFCC;'&gt;&amp;nbsp;&lt;/td&gt;<br />
&lt;td style='background:#FFCCCC;'&gt;&amp;nbsp;&lt;/td&gt;<br />
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br />
&lt;script type='text/javascript' language='javascript'&gt;<br />
function dhd_fn_progress_bar_update(intCurrentPercent)<br />
{<br />
&nbsp;&nbsp;&nbsp; document.getElementById('progress_bar_complete').style.width = intCurrentPercent+'%';<br />
&nbsp;&nbsp;&nbsp; document.getElementById('progress_bar_complete').innerHTML = intCurrentPercent+'%';<br />
}<br />
&lt;/script&gt;<br />
</span><span class="keyword">BAR;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else if(</span><span class="default">$intDisplayedCurrentPercent </span><span class="keyword">&lt;&gt; </span><span class="default">$intCurrentPercent</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$intDisplayedCurrentPercent </span><span class="keyword">= </span><span class="default">$intCurrentPercent</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strProgressBar </span><span class="keyword">= &lt;&lt;&lt; BAR<br />
</span><span class="string">&lt;script type='text/javascript' language='javascript'&gt;<br />
dhd_fn_progress_bar_update(</span><span class="default">$intCurrentPercent</span><span class="string">);<br />
&lt;/script&gt;<br />
</span><span class="keyword">BAR;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">100 </span><span class="keyword">&lt;= </span><span class="default">$intCurrentPercent</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$intNumberRuns </span><span class="keyword">= </span><span class="default">$intDisplayedCurrentPercent </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strProgressBar </span><span class="keyword">= &lt;&lt;&lt; BAR<br />
</span><span class="string">&lt;script type='text/javascript' language='javascript'&gt;<br />
document.getElementById('progress_bar').style.visibility='hidden';<br />
&lt;/script&gt;<br />
</span><span class="keyword">BAR;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$strProgressBar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">flush</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ob_flush</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50610""></a>
  <div class="note">
   <strong class="user">siggi AT june systems DOT com</strong>
   <a href="#50610" class="date">04-Mar-2005 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After searching through the PHP site, google and various forums, not finding a solution to my script not outputting anything while calling flush and ob_flush, I thought of trying to tell PHP to call:<br />
<br />
session_write_close();<br />
<br />
before starting echo'ing. It worked like a charm. I couldn't find any references to this, so I hope this note will help someone in the future.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36206""></a>
  <div class="note">
   <strong class="user">scottmacvicar at ntlworld dot com</strong>
   <a href="#36206" class="date">30-Sep-2003 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding Apache2<br />
flush() will produce the same results as ob_flush() when output buffering is involved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
