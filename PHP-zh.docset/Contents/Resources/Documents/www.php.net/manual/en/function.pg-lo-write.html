<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>向大型对象写入数据</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.pg-lo-unlink.html">? pg_lo_unlink</a></li>
      <li style="float: right;"><a href="function.pg-meta-data.html">pg_meta_data ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.pgsql.html">PostgreSQL 函数</a></li>
    <li>向大型对象写入数据</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.pg-lo-write" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">pg_lo_write</h1>
    <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">pg_lo_write</span> &mdash; <span class="dc-title">向大型对象写入数据</span></p>

   </div>
   <div class="refsect1 unknown-seealsp" id="refsect1-function.pg-lo-write-unknown-seealsp">
    <h3 class="title">说明</h3>
     <div class="methodsynopsis dc-description">
      <span class="methodname"><strong>pg_lo_write</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$large_object</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>): <span class="type">int</span></div>

    <p class="para rdfs-comment">
     <span class="function"><strong>pg_lo_write()</strong></span> 把 <code class="parameter">data</code> 参数中的数据尽可能多地写入大型对象并返回实际写入的字节数。如果出错则返回 <strong><code>false</code></strong>。<code class="parameter">large_object</code> 参数是 <span class="function"><a href="function.pg-lo-open.html" class="function">pg_lo_open()</a></span> 函数所返回的大型对象资源号。
    </p>
    <p class="para">
     要使用大型对象（lo）接口，需要将其放置在事务块中。
    </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      本函数以前的名字为 <code class="literal">pg_lo_write()</code>。
     </p>
    </p></blockquote>
    <p class="para">
     参见 <span class="function"><a href="function.pg-lo-create.html" class="function">pg_lo_create()</a></span> 和 <span class="function"><a href="function.pg-lo-open.html" class="function">pg_lo_open()</a></span>。
    </p>
   </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="32732""></a>
  <div class="note">
   <strong class="user">nandrews at logictree dot co dot uk</strong>
   <a href="#32732" class="date">05-Jun-2003 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using php 4.3.0 and PostgreSQL 7.3.1<br />
<br />
I can write a simple script in which pg_lo_write seems to always return 1 and not the number of bytes written, as evidenced by extracting the data through another means.<br />
<br />
Further more, I can make this pg_lo_write fail, or at least fail to write all the data it's pretty difficult to tell without the number of bytes written being returned, and not return the false value. In addition to this, the lo resource has been adjusted so that the oid it contains is 0.<br />
<br />
Unfortunately, I do not know what exactly the failure mode is, it does seem to be in the ip network communication side of PostgreSQL, which is odd since the unix domain comms works fine for this. However, it would have been useful to have the pg_lo_write() function return as advertised, it would have saved some of the 2 man hours me and the dev. team put into diagnosing this problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12663""></a>
  <div class="note">
   <strong class="user">cedric at isoca.com</strong>
   <a href="#12663" class="date">27-Apr-2001 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware when you modify a lo with pg_lowrite() to remove first the old one : if the new lo is smaller than the one before, it only overwrite the begining and you keep the end of the old lo (open with "w" parameter, PHP 4.04 Linux RH).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
