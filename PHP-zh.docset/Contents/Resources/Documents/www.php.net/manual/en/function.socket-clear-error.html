<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>清除套接字或者最后的错误代码上的错误</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.socket-bind.html">? socket_bind</a></li>
      <li style="float: right;"><a href="function.socket-close.html">socket_close ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.sockets.html">Socket 函数</a></li>
    <li>清除套接字或者最后的错误代码上的错误</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.socket-clear-error" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">socket_clear_error</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">socket_clear_error</span> &mdash; <span class="dc-title">清除套接字或者最后的错误代码上的错误</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.socket-clear-error-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>socket_clear_error</strong></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type"><a href="class.socket.html" class="type Socket">Socket</a></span><span class="type"></span></span> <code class="parameter">$socket</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type void">void</span></span></div>

  <p class="para rdfs-comment">
   这个函数清除给定的套接字上的错误代码或是最后一个全局的套接字如果套接字没有指定的话。
  </p>
  <p class="para">
   这个函数允许明确的重置错误代码值 不论是一个套接字或者最后全局错误代码的扩展，
   这对在检测应用的一部分是否有错误发生是十分有用的。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.socket-clear-error-parameters">
   <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">socket</code></dt>

     <dd>

      <p class="para">
       用 <span class="function"><a href="function.socket-create.html" class="function">socket_create()</a></span> 创建的 <span class="classname"><a href="class.socket.html" class="classname">Socket</a></span> 实例。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.socket-clear-error-returnvalues">
 <h3 class="title">返回值</h3>
  <p class="para">
   没有返回值。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.socket-clear-error-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
  <td>8.0.0</td>
  <td>
   现在 <code class="parameter">socket</code> 是 <span class="classname"><a href="class.socket.html" class="classname">Socket</a></span> 实例，
   之前是 <span class="type">resource</span>。
  </td>
 </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       参数 <code class="parameter">socket</code> 可以为 null。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 seealso" id="refsect1-function.socket-clear-error-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.socket-last-error.html" class="function" rel="rdfs-seeAlso">socket_last_error()</a> - Returns the last error on the socket</span></li>
    <li class="member"><span class="function"><a href="function.socket-strerror.html" class="function" rel="rdfs-seeAlso">socket_strerror()</a> - Return a string describing a socket error</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="105105""></a>
  <div class="note">
   <strong class="user">raphael at engenhosweb dot com dot br</strong>
   <a href="#105105" class="date">27-Jul-2011 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can do this too, with anonymous function:<br />
<span class="default">&lt;?php<br />
$socket </span><span class="keyword">= @</span><span class="default">socket_create</span><span class="keyword">(</span><span class="default">AF_INET</span><span class="keyword">, </span><span class="default">SOCK_STREAM</span><span class="keyword">, </span><span class="default">SOL_TCP</span><span class="keyword">) or function() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$errstr </span><span class="keyword">= </span><span class="default">socket_strerror</span><span class="keyword">(</span><span class="default">socket_last_error</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo (</span><span class="string">"Failed to create socket: " </span><span class="keyword">. </span><span class="default">$errstr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">socket_clear_error</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66481""></a>
  <div class="note">
   <strong class="user">ludvig dot ericson at gmail dot com</strong>
   <a href="#66481" class="date">23-May-2006 04:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to clear your error in a small amount of code, do a similar hack as to what most people do in SQL query checking,<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">) or die(</span><span class="comment">/* Whatever code */</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
It could look like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!(</span><span class="default">$socket </span><span class="keyword">= </span><span class="default">socket_create</span><span class="keyword">(</span><span class="comment">/* Whatever code */</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo (</span><span class="string">"Failed to create socket: " </span><span class="keyword">. </span><span class="default">socket_strerror</span><span class="keyword">(</span><span class="default">socket_last_error</span><span class="keyword">()) and </span><span class="default">socket_clear_error</span><span class="keyword">());<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
As you can see, I use "and" here instead of "or" since the first part will always return true, thus if you use or PHP's lazy boolean checking will not execute the last part, which it will with an and if the first part is true.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
