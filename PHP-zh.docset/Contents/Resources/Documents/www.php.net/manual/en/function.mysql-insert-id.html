<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>取得上一条查询生成的 ID</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysql-info.html">? mysql_info</a></li>
      <li style="float: right;"><a href="function.mysql-list-dbs.html">mysql_list_dbs ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysql.html">MySQL 函数</a></li>
    <li>取得上一条查询生成的 ID</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysql-insert-id" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_insert_id</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_insert_id</span> &mdash; <span class="dc-title">取得上一条查询生成的 ID</span></p>

 </div>

 <div id="function.mysql-insert-id-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">本扩展自 PHP 5.5.0
起已废弃，并在自 PHP 7.0.0 开始被移除。应使用 <a href="book.mysqli.html" class="link">MySQLi</a>
或 <a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> 扩展来替换之。参见 <a href="mysqlinfo.api.choosing.html" class="link">MySQL：选择 API</a> 
指南来获取更多信息。用以替代本函数的有：</p>
   <ul class="simplelist">
    <li><span class="function"><a href="mysqli.insert-id.html" class="function">mysqli_insert_id()</a></span></li>
    <li><span class="methodname"><a href="pdo.lastinsertid.html" class="methodname">PDO::lastInsertId()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-insert-id-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mysql_insert_id</strong></span>(<span class="methodparam"><span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> <code class="parameter">$link_identifier</code><span class="initializer"> = NULL</span></span>): <span class="type"><a href="language.types.integer.html" class="type int">int</a></span></div>

  <p class="para rdfs-comment">
   检索通过之前查询（通常是 INSERT）中 AUTO_INCREMENT 列生成的 ID。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-insert-id-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    <dt>
<code class="parameter">link_identifier</code></dt><dd><p class="para">MySQL
连接。如不指定连接标识，则使用由 <span class="function"><a href="function.mysql-connect.html" class="function">mysql_connect()</a></span>
最近打开的连接。如果没有找到该连接，会尝试不带参数调用
<span class="function"><a href="function.mysql-connect.html" class="function">mysql_connect()</a></span>
来创建。如没有找到连接或无法建立连接，则会生成
<strong><code><a href="errorfunc.constants.html#constant.e-warning">E_WARNING</a></code></strong> 级别的错误。</p></dd>

   </dl>
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-insert-id-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回通过之前查询中 AUTO_INCREMENT 列生成的 ID，如果之前查询没有生成 AUTO_INCREMENT
   值，则为 <code class="literal">0</code>。如果没有建立 MySQL 连接，则为 <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysql-insert-id-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-1771">
    <p><strong>Example #1 <span class="function"><strong>mysql_insert_id()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$link </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">, </span><span style="color: #DD0000">'mysql_user'</span><span style="color: #007700">, </span><span style="color: #DD0000">'mysql_password'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$link</span><span style="color: #007700">) {<br />    die(</span><span style="color: #DD0000">'Could not connect: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">());<br />}<br /></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">'mydb'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO mytable (product) values ('kossu')"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Last inserted record has id %d\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">mysql_insert_id</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-insert-id-notes">
  <h3 class="title">注释</h3>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    <span class="function"><strong>mysql_insert_id()</strong></span> will convert the return type of the
    native MySQL C API function <code class="literal">mysql_insert_id()</code> to a type
    of <code class="literal">long</code> (named <span class="type"><a href="language.types.integer.html" class="type int">int</a></span> in PHP). If your
    AUTO_INCREMENT column has a column type of BIGINT (64 bits) the
    conversion may result in an incorrect value. Instead, use the internal
    MySQL SQL function LAST_INSERT_ID() in an SQL query. For more information
    about PHP&#039;s maximum integer values, please see the
    <a href="language.types.integer.html" class="link">integer</a> documentation.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Because <span class="function"><strong>mysql_insert_id()</strong></span> acts on the last performed
    query, be sure to call <span class="function"><strong>mysql_insert_id()</strong></span> immediately 
    after the query that generates the value.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    The value of the MySQL SQL function
    <code class="literal">LAST_INSERT_ID()</code> always contains the most
    recently generated AUTO_INCREMENT value, and is not reset
    between queries.
  </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-insert-id-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - 发送一条 MySQL 查询</span></li>
    <li><span class="function"><a href="function.mysql-info.html" class="function" rel="rdfs-seeAlso">mysql_info()</a> - 获取最近查询的有关信息</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121703""></a>
  <div class="note">
   <strong class="user">dhiraj dot webdeveloper at gmail dot com</strong>
   <a href="#121703" class="date">28-Sep-2017 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
MySQLi Procedural<br />
//---------------------------------------------<br />
$last_id = mysqli_insert_id($conn);<br />
<br />
//---------------------------------------------<br />
&nbsp;<span class="default">&lt;?php<br />
$servername </span><span class="keyword">= </span><span class="string">"localhost"</span><span class="keyword">;<br />
</span><span class="default">$username </span><span class="keyword">= </span><span class="string">"username"</span><span class="keyword">;<br />
</span><span class="default">$password </span><span class="keyword">= </span><span class="string">"password"</span><span class="keyword">;<br />
</span><span class="default">$dbname </span><span class="keyword">= </span><span class="string">"myDB"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Create connection<br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">mysqli_connect</span><span class="keyword">(</span><span class="default">$servername</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">$dbname</span><span class="keyword">);<br />
</span><span class="comment">// Check connection<br />
</span><span class="keyword">if (!</span><span class="default">$conn</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">"Connection failed: " </span><span class="keyword">. </span><span class="default">mysqli_connect_error</span><span class="keyword">());<br />
}<br />
<br />
</span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"INSERT INTO MyGuests (firstname, lastname, email)<br />
VALUES ('John', 'Doe', 'john@example.com')"</span><span class="keyword">;<br />
<br />
if (</span><span class="default">mysqli_query</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_id </span><span class="keyword">= </span><span class="default">mysqli_insert_id</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"New record created successfully. Last inserted ID is: " </span><span class="keyword">. </span><span class="default">$last_id</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Error: " </span><span class="keyword">. </span><span class="default">$sql </span><span class="keyword">. </span><span class="string">"&lt;br&gt;" </span><span class="keyword">. </span><span class="default">mysqli_error</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">mysqli_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112686""></a>
  <div class="note">
   <strong class="user">hoangvu4000 at gmail dot com</strong>
   <a href="#112686" class="date">12-Jul-2013 05:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to get ID of the last updated row in MySQL?<br />
<br />
75<br />
down vote<br />
I've found an answer to this problem :)<br />
<br />
by Pomyk<br />
<br />
SET @update_id := 0;<br />
UPDATE some_table SET row = 'value', id = (SELECT @update_id := id)<br />
WHERE some_other_row = 'blah' LIMIT 1; <br />
SELECT @update_id;<br />
EDIT by aefxx<br />
<br />
This technique can be further expanded to retrieve the ID of every row affected by an update statement:<br />
<br />
SET @uids := null;<br />
UPDATE footable<br />
&nbsp;&nbsp; SET foo = 'bar'<br />
&nbsp;WHERE fooid &gt; 5<br />
&nbsp;&nbsp; AND ( SELECT @uids := CONCAT_WS(',', fooid, @uids) );<br />
SELECT @uids;<br />
This will return a string with all the IDs concatenated by a colon.<br />
<br />
(questions: 1388025&nbsp; form stackoverflow)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93745""></a>
  <div class="note">
   <strong class="user">bargainbatman at gmail dot com</strong>
   <a href="#93745" class="date">25-Sep-2009 06:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I thought this would be relevant to all the people using mysqli and looking for the ID after INSERT command :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">insert_join</span><span class="keyword">(</span><span class="default">$catid</span><span class="keyword">, </span><span class="default">$disc_id</span><span class="keyword">) {<br />
</span><span class="comment">// insert a new item into the database<br />
&nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= </span><span class="default">db_connect</span><span class="keyword">();<br />
&nbsp;&nbsp; </span><span class="comment">// insert new item<br />
&nbsp;&nbsp; </span><span class="default">$demande </span><span class="keyword">= </span><span class="string">"insert into categories_disc values ('', '"</span><span class="keyword">.</span><span class="default">$catid</span><span class="keyword">.</span><span class="string">"', '"</span><span class="keyword">.</span><span class="default">$disc_id</span><span class="keyword">.</span><span class="string">"')"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$resultat </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$demande</span><span class="keyword">);<br />
&nbsp;&nbsp; if (!</span><span class="default">$resultat</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">insert_id</span><span class="keyword">; </span><span class="comment">// function will now return the ID instead of true. <br />
</span><span class="keyword">}<br />
<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Then, on the other side, let us call this function as follows :<br />
<br />
<span class="default">&lt;?php<br />
$cat_id </span><span class="keyword">= </span><span class="default">insert_join</span><span class="keyword">(</span><span class="default">$catid</span><span class="keyword">, </span><span class="default">$disc_id</span><span class="keyword">);<br />
if(</span><span class="default">$cat_id </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;p&gt;Category stuff was added to the database as follows : &lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;hr&gt;ID de la category : "</span><span class="keyword">.</span><span class="default">$cat_id</span><span class="keyword">.</span><span class="string">"&lt;/p&gt;&lt;hr&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82367""></a>
  <div class="note">
   <strong class="user">elinor dot hurst at REMOVETHIS dot gmail dot com</strong>
   <a href="#82367" class="date">08-Apr-2008 07:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I don't get all the fuss around this.<br />
<br />
I read:<br />
"The value of mysql_insert_id() is affected only by statements issued within the current client connection. It is not affected by statements issued by other clients."<br />
<br />
See: <a href="http://dev.mysql.com/doc/refman/5.0/es/mysql-insert-id.html" rel="nofollow" target="_blank">http://dev.mysql.com/doc/refman/5.0/es/mysql-insert-id.html</a><br />
<br />
I can't really see what's inaccurate about that.<br />
<br />
"In the case of a multiple-row INSERT statement, mysql_insert_id() returns the first automatically generated AUTO_INCREMENT value; if no such value is generated, it returns the last last explicit value inserted into the AUTO_INCREMENT column."<br />
<br />
I must be missing something here but why would you insert multiple rows and then only handle the last one with some favoured behaviour? You could just as well insert them one at a time and then handle each row separately with the latest id.<br />
<br />
I can't see what's wrong with that.<br />
<br />
However I can see what's wrong with simply using max(my_table.id_column) because of the concurrent access issues this would imply.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81351""></a>
  <div class="note">
   <strong class="user">Alfred Nony Mouse</strong>
   <a href="#81351" class="date">23-Feb-2008 05:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's nothing inherently wrong with using auto-increment fields. There's also nothing wrong with the main competetive idea, which is for the database to supply a primitive sequence of non-repeating identifiers, typically integers. This is rather like which side of the road you drive on.<br />
<br />
The bigger problem is when people don't understand what they are doing with database access. It's like driving a car without really knowing the rules of the road. Such people wind up making bad decisions without realizing it, and then, eventually, something breaks.<br />
<br />
Databases are complex beasts, and worth taking the time to really understand. Learn about the implications and limitations of different approaches to solving problems. Then, you will be prepared to pick a solution based on what has to work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77059""></a>
  <div class="note">
   <strong class="user">louis at intoplay dot com</strong>
   <a href="#77059" class="date">13-Aug-2007 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If mysql_insert_id() returns 0 or null, check your auto increment field is not being set by your sql query, also if you have multiple db connections like I did, the solution is to create a seperate db connection for this query.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76815""></a>
  <div class="note">
   <strong class="user">foros (_AT_) anthalia.com</strong>
   <a href="#76815" class="date">31-Jul-2007 02:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Forget about using MAX to get the last inserted id. Race conditions like other users inserting between your SELECT MAX(.. and your INSERT may render your id unusable.<br />
<br />
The WAY to get the id is by using mysql_insert_id() or the mysql SQL function LAST_INSERT_ID(). <br />
<br />
Take care, if using mysql_insert_id() you should provide the resource returned by the mysql_connect, not the resultset returned by mysql_query.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59718""></a>
  <div class="note">
   <strong class="user">heiligkind at yahoo dot de</strong>
   <a href="#59718" class="date">14-Dec-2005 01:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you insert a data row by using the ON DUPLICATE KEY UPDATE clause in an INSERT-statement, the mysql_insert_id() function will return not the same results as if you directly use LAST_INSERT_ID() in MySQL.<br />
<br />
See the following example:<br />
<br />
&lt;?<br />
&nbsp;&nbsp; // insert a datarow, primary key is auto_increment<br />
&nbsp;&nbsp; // value is a unique key<br />
&nbsp;&nbsp; $query = "INSERT INTO test (value) VALUES ('test')";<br />
&nbsp;&nbsp; mysql_query( $query );<br />
<br />
&nbsp;&nbsp; echo 'LAST_INSERT_ID: ',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mysql_query( "SELECT LAST_INSERT_ID()" ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; '&lt;br&gt;mysql_insert_id: ',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mysql_insert_id();<br />
<br />
?&gt;<br />
<br />
This will print:<br />
<br />
LAST_INSERT_ID: 1<br />
mysql_insert_id: 1<br />
<br />
In this case the function returns the same as the MySQL-Statement.<br />
But see the insert on an existing key:<br />
<br />
&lt;?<br />
&nbsp;&nbsp; $query = "INSERT INTO test (value) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; VALUES ('test')<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ON DUPLICATE KEY UPDATE value = 'test2'";<br />
&nbsp;&nbsp; mysql_query( $query );<br />
<br />
&nbsp;&nbsp; echo 'LAST_INSERT_ID: ',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mysql_query( "SELECT LAST_INSERT_ID()" ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; '&lt;br&gt;mysql_insert_id: ',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mysql_insert_id();<br />
<br />
?&gt;<br />
<br />
This will print:<br />
<br />
LAST_INSERT_ID: 2<br />
mysql_insert_id: 1<br />
<br />
By using the ON DUPLICATE KEY UPDATE clause, only the old datarow will be modified, if the INSERT statement causes a duplicate entry, but the LAST_INSERT_ID() function returns the next auto_increment value for the primary key, which is by the way not set as the next auto_increment value in the database.<br />
<br />
The mysql_insert_id() function returns the primary key of the old (and changed) data row. For me this is the right operation method, because the LAST_INSERT_ID() function returns a value which is not referenced to a data row at all.<br />
<br />
Greets from Munich.<br />
<br />
heiligkind</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59313""></a>
  <div class="note">
   
   <a href="#59313" class="date">02-Dec-2005 10:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Take care of setting an empty value for the AUTO_INCREMENT Field else you never get a value except zero returned from mysq_insert_id() ....<br />
<br />
Ciao Ephraim</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54995""></a>
  <div class="note">
   <strong class="user">athies at gmail dot com</strong>
   <a href="#54995" class="date">21-Jul-2005 02:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note. mysql_insert_id() does work with REPLACE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43529""></a>
  <div class="note">
   <strong class="user">Steve Bond</strong>
   <a href="#43529" class="date">24-Jun-2004 11:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use this function after doing an INSERT ... SELECT to insert multiple rows at once, you get the autonumber ID of the *first* row added by the INSERT.<br />
<br />
e.g. if there are 4 records in table 'init' that have column 'type' = 2<br />
I want to add these 4 records to table 'game'<br />
Table game has an autonumber column 'game_id' that is currently at 32.<br />
<br />
If I do this query:<br />
<br />
INSERT INTO game (type, players, rounds)<br />
SELECT type, players, rounds FROM init<br />
WHERE type = 2<br />
<br />
Then mysql_insert_id() will return 33, not 36.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="2649""></a>
  <div class="note">
   <strong class="user">vksgeneric at hotmail dot com</strong>
   <a href="#2649" class="date">09-Dec-1999 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can't do an INSERT DELAYED and expect to get anything but zero, for it runs in a separate thread, and mysql_insert_id() is tied to the current thread.
<br />
Vlad</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
