<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>HTTP Request 变量</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="reserved.variables.files.html">? $_FILES</a></li>
      <li style="float: right;"><a href="reserved.variables.session.html">$_SESSION ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="reserved.variables.html">预定义变量</a></li>
    <li>HTTP Request 变量</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="reserved.variables.request" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">$_REQUEST</h1>
  <p class="refpurpose"><span class="refname">$_REQUEST</span> &mdash; <span class="dc-title">HTTP Request 变量</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-reserved.variables.request-description">
  <h3 class="title">说明</h3>
  <p class="para">
   默认情况下包含了 <var class="varname"><a href="reserved.variables.get.html" class="classname">$_GET</a></var>，<var class="varname"><a href="reserved.variables.post.html" class="classname">$_POST</a></var>  和  <var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var> 的<span class="type"><span class="type 数组">数组</span></span>。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-reserved.variables.request-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <p class="para">"Superglobal"也称为自动化的全局变量。这就表示其在脚本的所有作用域中都是可用的。不需要在函数或方法中用
<strong class="command">global $variable;</strong> 来访问它。</p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    以<a href="features.commandline.html" class="link">命令行</a>方式运行时，将<em class="emphasis">不</em>包含 <a href="reserved.variables.argv.html" class="link">argv</a> 和 <a href="reserved.variables.argc.html" class="link">argc</a> 信息；它们将存在于 <var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var> <span class="type"><span class="type 数组">数组</span></span>。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    由于 <var class="varname">$_REQUEST</var> 中的变量通过 GET，POST 和 COOKIE 输入机制传递给脚本文件，因此可以被远程用户篡改而并不可信。这个数组的项目及其顺序依赖于 PHP 的 
    <a href="ini.core.html#ini.request-order" class="link">request_order</a> 和 <a href="ini.core.html#ini.variables-order" class="link">variables_order</a> 指令的配置。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-reserved.variables.request-seealso">
  <h3 class="title">参见</h3>
  <ul class="simplelist">
   <li class="member"><a href="language.variables.external.html" class="link">处理外部变量</a></li>
   <li class="member"><a href="book.filter.html" class="link">过滤器扩展</a></li>
  </ul>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125436""></a>
  <div class="note">
   <strong class="user">codeblog.pro</strong>
   <a href="#125436" class="date">13-Oct-2020 12:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In PHP version 7.0 with the default settings.+, $_REQUEST array does not contain cookies.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125405""></a>
  <div class="note">
   <strong class="user">Filomena</strong>
   <a href="#125405" class="date">02-Oct-2020 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning:<br />
<br />
The way $_REQUEST is populated by default can lead to strange bugs because of the unfortunate default setting of the configuration directive 'variables_order'.<br />
<br />
Example: In an e-shop you want to display prices based on user preference. User can either switch the currency or the previous selection is used. By defaut, the following code WILL NOT WORK as expected:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'currency'</span><span class="keyword">]) </span><span class="comment"># change currency on user request<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currency </span><span class="keyword">= </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'currency'</span><span class="keyword">]; </span><span class="comment"># use it<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'currency'</span><span class="keyword">, </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'currency'</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="string">'eshop.php'</span><span class="keyword">); </span><span class="comment"># store it<br />
</span><span class="keyword">}<br />
else </span><span class="comment"># use default currency<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currency </span><span class="keyword">= </span><span class="string">'USD'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment"># display shop contents with user selected currency<br />
</span><span class="keyword">echo </span><span class="string">'All prices are shown in '</span><span class="keyword">, </span><span class="default">$currency</span><span class="keyword">;<br />
<br />
</span><span class="comment"># let the user switch currency<br />
</span><span class="keyword">echo </span><span class="string">'&lt;a href="eshop.php?currency=USD"&gt;Switch to USD&lt;/a&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;a href="eshop.php?currency=EUR"&gt;Switch to EUR&lt;/a&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Regardless of the user choice, the cookie value is used, so unless you change the default 'request_order' or 'variables_order' the $_REQUEST[something] variable is stuck with the cookie value forever regardless of the user 'REQUEST'.<br />
<br />
Fix 1:<br />
<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'request_order'</span><span class="keyword">, </span><span class="string">'CGP'</span><span class="keyword">); </span><span class="comment"># use previous value (stored in cookie) or new value upon user request<br />
</span><span class="keyword">.<br />
.<br />
.<br />
</span><span class="default">?&gt;<br />
</span><br />
Fix 2:<br />
Be very careful and patient and go with $_GET, $_POST and $_COOKIE instead of the convenient $_REQUEST. Good luck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119368""></a>
  <div class="note">
   <strong class="user">Luke Madhanga</strong>
   <a href="#119368" class="date">22-May-2016 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To access $_POST, $_GET, etc, use the function filter_input(TYPE, varname, filter) to ensure that your data is clean. <br />
<br />
Also, I was brought up to believe that modifying superglobals is a BAD idea. I stand by this belief and would recommend you do too</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96696""></a>
  <div class="note">
   <strong class="user">mike o.</strong>
   <a href="#96696" class="date">11-Mar-2010 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The default php.ini on your system as of in PHP 5.3.0 may exclude cookies from $_REQUEST.&nbsp; The request_order ini directive specifies what goes in the $_REQUEST array; if that does not exist, then the variables_order directive does.&nbsp; Your distribution's php.ini may exclude cookies by default, so beware.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94985""></a>
  <div class="note">
   <strong class="user">John Galt</strong>
   <a href="#94985" class="date">06-Dec-2009 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a function because I found it inconvenient if I needed to change a particular parameter (get) while preserving the others. For example, I want to make a hyperlink on a web page with the URL <a href="http://www.example.com/script.php?id=1&amp;blah=blah+blah&amp;page=1 and change the value of " rel="nofollow" target="_blank">http://www.example.com/script.php?id=1&amp;blah=blah+blah&amp;page=1 and change the value of </a>"page" to 2 without getting rid of the other parameters.
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;</span><span class="keyword">function </span><span class="default">add_or_change_parameter</span><span class="keyword">(</span><span class="default">$parameter</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;{
<br />
&nbsp; </span><span class="default">$params </span><span class="keyword">= array();
<br />
&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">"?"</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$firstRun </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp; foreach(</span><span class="default">$_GET </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)
<br />
&nbsp; {
<br />
&nbsp;&nbsp; if(</span><span class="default">$key </span><span class="keyword">!= </span><span class="default">$parameter</span><span class="keyword">)
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$firstRun</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&amp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$firstRun </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);
<br />
&nbsp;&nbsp; }
<br />
&nbsp; }
<br />
&nbsp; if(!</span><span class="default">$firstRun</span><span class="keyword">)
<br />
&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&amp;"</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$parameter</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp; return </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">);
<br />
&nbsp;}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Now, I can add a hyperlink to the page (<a href="http://www.example.com/script.php?id=1&amp;blah=blah+blah&amp;page=1" rel="nofollow" target="_blank">http://www.example.com/script.php?id=1&amp;blah=blah+blah&amp;page=1</a>) like this:
<br />
&lt;a href="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">add_or_change_parameter</span><span class="keyword">(</span><span class="string">"page"</span><span class="keyword">, </span><span class="string">"2"</span><span class="keyword">); </span><span class="default">?&gt;</span>"&gt;Click to go to page 2&lt;/a&gt;
<br />

<br />
The above code will output
<br />
&lt;a href="?id=1&amp;amp;blah=blah+blah&amp;amp;page=2"&gt;Click to go to page 2&lt;/a&gt;
<br />

<br />
Also, if I was setting "page" to a string rather than just "2", the value would be urlencode()'d.
<br />
&lt;a href="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">add_or_change_parameter</span><span class="keyword">(</span><span class="string">"page"</span><span class="keyword">, </span><span class="string">"banana+split!"</span><span class="keyword">); </span><span class="default">?&gt;</span>"&gt;Click to go to page banana split!&lt;/a&gt;
<br />
would become
<br />
&lt;a href="?id=1&amp;amp;blah=blah+blah&amp;amp;page=banana+split%21"&gt;Click to go to page banana split!&lt;/a&gt;
<br />

<br />
[EDIT BY danbrown AT php DOT net: Contains a bugfix provided by (theogony AT gmail DOT com), which adds missing `echo` instructions to the HREF tags.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84527""></a>
  <div class="note">
   <strong class="user">strata_ranger at hotmail dot com</strong>
   <a href="#84527" class="date">17-Jul-2008 08:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't forget, because $_REQUEST is a different variable than $_GET and $_POST, it is treated as such in PHP -- modifying $_GET or $_POST elements at runtime will not affect the ellements in $_REQUEST, nor vice versa.<br />
<br />
e.g:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$_GET</span><span class="keyword">[</span><span class="string">'foo'</span><span class="keyword">] = </span><span class="string">'a'</span><span class="keyword">;<br />
</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'bar'</span><span class="keyword">] = </span><span class="string">'b'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">); </span><span class="comment">// Element 'foo' is string(1) "a"<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">); </span><span class="comment">// Element 'bar' is string(1) "b"<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">); </span><span class="comment">// Does not contain elements 'foo' or 'bar'<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
If you want to evaluate $_GET and $_POST variables by a single token without including $_COOKIE in the mix, use&nbsp; $_SERVER['REQUEST_METHOD'] to identify the method used and set up a switch block accordingly, e.g:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">switch(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_METHOD'</span><span class="keyword">])<br />
{<br />
case </span><span class="string">'GET'</span><span class="keyword">: </span><span class="default">$the_request </span><span class="keyword">= &amp;</span><span class="default">$_GET</span><span class="keyword">; break;<br />
case </span><span class="string">'POST'</span><span class="keyword">: </span><span class="default">$the_request </span><span class="keyword">= &amp;</span><span class="default">$_POST</span><span class="keyword">; break;<br />
.<br />
. </span><span class="comment">// Etc.<br />
</span><span class="keyword">.<br />
default:<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
