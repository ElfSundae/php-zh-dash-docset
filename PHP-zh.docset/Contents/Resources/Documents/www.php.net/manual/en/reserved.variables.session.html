<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Session 变量</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="reserved.variables.request.html">? $_REQUEST</a></li>
      <li style="float: right;"><a href="reserved.variables.environment.html">$_ENV ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="reserved.variables.html">预定义变量</a></li>
    <li>Session 变量</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="reserved.variables.session" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">$_SESSION</h1>
  <p class="refpurpose"><span class="refname">$_SESSION</span> &mdash; <span class="dc-title">Session 变量</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-reserved.variables.session-description">
  <h3 class="title">说明</h3>
  <p class="para">
   当前脚本可用 SESSION 变量的数组。更多关于如何使用的信息，参见 <a href="ref.session.html" class="link">Session 函数</a> 文档。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-reserved.variables.session-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <p class="para">"Superglobal"也称为自动化的全局变量。这就表示其在脚本的所有作用域中都是可用的。不需要在函数或方法中用
<strong class="command">global $variable;</strong> 来访问它。</p></p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-reserved.variables.session-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.session-start.html" class="function" rel="rdfs-seeAlso">session_start()</a> - 启动新会话或者重用现有会话</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123546""></a>
  <div class="note">
   <strong class="user">ms at meilenstein dot ms</strong>
   <a href="#123546" class="date">25-Jan-2019 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would be wary to use PHP Sessions for application-critical tasks. So far, I have had very troubling experiences with random loss of session data, as described in these bug reports:<br />
<br />
https://bugs.php.net/bug.php?id=19022<br />
https://bugs.php.net/bug.php?id=19029<br />
https://bugs.php.net/bug.php?id=70584</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116843""></a>
  <div class="note">
   <strong class="user">Tugrul</strong>
   <a href="#116843" class="date">09-Mar-2015 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Creating New Session
<br />
==========================
<br />
<span class="default">&lt;?php 
<br />
session_start</span><span class="keyword">();
<br />
</span><span class="comment">/*session is started if you don't write this line can't use $_Session&nbsp; global variable*/
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]=</span><span class="default">$value</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>Getting Session
<br />
==========================
<br />
<span class="default">&lt;?php 
<br />
session_start</span><span class="keyword">();
<br />
</span><span class="comment">/*session is started if you don't write this line can't use $_Session&nbsp; global variable*/
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]=</span><span class="default">$value</span><span class="keyword">;
<br />
</span><span class="comment">/*session created*/
<br />
</span><span class="keyword">echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">];
<br />
</span><span class="comment">/*session was getting*/
<br />
</span><span class="default">?&gt;
<br />
</span>Updating Session
<br />
==========================
<br />
<span class="default">&lt;?php 
<br />
session_start</span><span class="keyword">();
<br />
</span><span class="comment">/*session is started if you don't write this line can't use $_Session&nbsp; global variable*/
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]=</span><span class="default">$value</span><span class="keyword">;
<br />
</span><span class="comment">/*it is my new session*/
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]=</span><span class="default">$updatedvalue</span><span class="keyword">;
<br />
</span><span class="comment">/*session updated*/
<br />
</span><span class="default">?&gt;
<br />
</span>Deleting Session
<br />
==========================
<br />
<span class="default">&lt;?php 
<br />
session_start</span><span class="keyword">();
<br />
</span><span class="comment">/*session is started if you don't write this line can't use $_Session&nbsp; global variable*/
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]=</span><span class="default">$value</span><span class="keyword">;
<br />
unset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"newsession"</span><span class="keyword">]);
<br />
</span><span class="comment">/*session deleted. if you try using this you've got an error*/
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113114""></a>
  <div class="note">
   <strong class="user">opajaap at opajaap dot nl</strong>
   <a href="#113114" class="date">31-Aug-2013 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carefull with $_SESSION array elements when you have the same name as a normal global.<br />
<br />
The following example leads to unpredictable behaviour of the $wppa array elements, some are updated by normal code, some not, it is totally unpredictable what happens.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">global </span><span class="default">$wppa</span><span class="keyword">;<br />
</span><span class="default">$wppa </span><span class="keyword">= array( </span><span class="string">'elm1' </span><span class="keyword">=&gt; </span><span class="string">'value1'</span><span class="keyword">, </span><span class="string">'elm2' </span><span class="keyword">=&gt; </span><span class="string">'value2'</span><span class="keyword">, ....</span><span class="default">etc</span><span class="keyword">...);<br />
<br />
if ( ! </span><span class="default">session_id</span><span class="keyword">() ) @ </span><span class="default">session_start</span><span class="keyword">();<br />
if ( ! isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'wppa'</span><span class="keyword">]) </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'wppa'</span><span class="keyword">] = array();<br />
<br />
if ( ! isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'wppa'</span><span class="keyword">][</span><span class="string">'album'</span><span class="keyword">]) ) </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'wppa'</span><span class="keyword">][</span><span class="string">'album'</span><span class="keyword">] = array();<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'wppa'</span><span class="keyword">][</span><span class="string">'album'</span><span class="keyword">][</span><span class="default">1234</span><span class="keyword">] = </span><span class="default">1</span><span class="keyword">;<br />
<br />
</span><span class="default">$wppa</span><span class="keyword">[</span><span class="string">'elm1'</span><span class="keyword">] = </span><span class="string">'newvalue1'</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">); <br />
</span><span class="default">?&gt;<br />
</span>This will most likely display Array ( [wppa] =&gt; Array ( [album] =&gt; Array ( [1234] =&gt; 1 ) [elm1] =&gt; 'newvalue1' [elm2] =&gt; 'value2' ... etc ...<br />
But setting $wppa['elm1'] to another value or referring to it gives unpredictable results, maybe 'value1', or 'newvalue1'. <br />
<br />
The most strange behaviour is that not all elements of $wppa[xx] show up as $_SESSION['wppa'][xx].</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92011""></a>
  <div class="note">
   <strong class="user">charlese at cvs dot com dot au</strong>
   <a href="#92011" class="date">04-Jul-2009 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having troubles with session variables working in some environments and being seriously flaky in others. I was using $_SESSION as an array. It works properly when I used $_SESSION as pointers to arrays. As an example the following code works in some environments and not others.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Trouble if I treate $form_convert and $_SESSION['form_convert'] as unrelated items<br />
</span><span class="default">$form_convert</span><span class="keyword">=array();<br />
if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'form_convert'</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$form_convert</span><span class="keyword">=</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'form_convert'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>The following works well. <br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'form_convert'</span><span class="keyword">])){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$form_convert </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'form_convert'</span><span class="keyword">];<br />
}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$form_convert </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'form_convert'</span><span class="keyword">]=</span><span class="default">$form_convert</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85448""></a>
  <div class="note">
   <strong class="user">bohwaz</strong>
   <a href="#85448" class="date">31-Aug-2008 02:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that if you have register_globals to On, global variables associated to $_SESSION variables are references, so this may lead to some weird situations.<br />
<br />
<span class="default">&lt;?php<br />
<br />
session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="default">42</span><span class="keyword">;<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">43</span><span class="keyword">;<br />
echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Load the page, OK it displays 42, reload the page... it displays 43.<br />
<br />
The solution is to do this after each time you do a session_start() :<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'register_globals'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$_SESSION </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84852""></a>
  <div class="note">
   <strong class="user">jherry at netcourrier dot com</strong>
   <a href="#84852" class="date">01-Aug-2008 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may have trouble if you use '|' in the key:<br />
<br />
$_SESSION["foo|bar"] = "fuzzy";<br />
<br />
This does not work for me. I think it's because the serialisation of session object is using this char so the server reset your session when it cannot read it.<br />
<br />
To make it work I replaced '|' by '_'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
