<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>打开MS SQL server链接</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mssql-close.html">? mssql_close</a></li>
      <li style="float: right;"><a href="function.mssql-data-seek.html">mssql_data_seek ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mssql.html">Mssql 函数</a></li>
    <li>打开MS SQL server链接</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mssql-connect" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mssql_connect</h1>
  <p class="verinfo">(PHP 4, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_connect</span> &mdash; <span class="dc-title">打开MS SQL server链接</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mssql-connect-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mssql_connect</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$servername</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$username</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$new_link</code><span class="initializer"> = false</span></span>
  ]]]] ) : <span class="type">resource</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mssql_connect()</strong></span> 建立一个MS SQL server链接。
  </p>
  <p class="para">
   链接会在程序执行结束之后关闭, 除非在之前已经通过调用<span class="function"><a href="function.mssql-close.html" class="function">mssql_close()</a></span>关闭。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-connect-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">servername</code></dt>

     <dd>

      <p class="para">
       服务器,它可以包含一个端口号 e.g.
       <em>主机:端口号(hostname:port)</em> (Linux), 或 
       <em>主机,端口号(hostname,port)</em> (Windows).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">username</code></dt>

     <dd>

      <p class="para">
       用户名。 
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">password</code></dt>

     <dd>

      <p class="para">
       密码。 
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">new_link</code></dt>

     <dd>

      <p class="para">
       如果第二次调用<span class="function"><strong>mssql_connect()</strong></span>使用相同的参数，
       不会建立新的链接，而是将之前已经打开的链接标识返回。对这个参数的值进行修改，则使得调用 
       <span class="function"><strong>mssql_connect()</strong></span>总是会建立新的链接，
       即便调用<span class="function"><strong>mssql_connect()</strong></span>使用与之前同样的参数。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-connect-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回一个链接视为成功, 或者 <strong><code>FALSE</code></strong> 和错误信息.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mssql-connect-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.1.0</td>
       <td>
        <code class="parameter">new_link</code>参数加入
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-connect-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-1783">
    <p><strong>Example #1 <span class="function"><strong>mssql_connect()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Server&nbsp;in&nbsp;the&nbsp;this&nbsp;format:&nbsp;&lt;computer&gt;\&lt;instance&nbsp;name&gt;&nbsp;or&nbsp;<br />//&nbsp;&lt;server&gt;,&lt;port&gt;&nbsp;when&nbsp;using&nbsp;a&nbsp;non&nbsp;default&nbsp;port&nbsp;number<br /></span><span style="color: #0000BB">$server&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'KALLESPC\SQLEXPRESS'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Connect&nbsp;to&nbsp;MSSQL<br /></span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$server</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sa'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'phpfi'</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">$link</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'Something&nbsp;went&nbsp;wrong&nbsp;while&nbsp;connecting&nbsp;to&nbsp;MSSQL'</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mssql-connect-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mssql-close.html" class="function" rel="rdfs-seeAlso">mssql_close()</a> - 关闭MS SQL Server链接</span></li>
    <li class="member"><span class="function"><a href="function.mssql-pconnect.html" class="function" rel="rdfs-seeAlso">mssql_pconnect()</a> - Open persistent MS SQL connection</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111627""></a>
  <div class="note">
   <strong class="user">parikhnirav dot aits at gmail dot com</strong>
   <a href="#111627" class="date">10-Mar-2013 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Cent OS - Remote SQL server connection<br />
$link = mssql_connect(72.xx.xxx.xxx, username, password);<br />
<br />
If you are not getting success, please check <br />
<br />
There is certainly a php-mssql package available in the extras repository so just a `yum install php-mssql` should sort that out - it pulls in freetds as a dependency too. If you already have those installed but it doesn't seem to be connecting, the one possibility is that you are being blocked by SELinux. To check that run<br />
<br />
# getsebool -a | grep httpd_can_network_connect<br />
httpd_can_network_connect --&gt; on<br />
httpd_can_network_connect_db --&gt; on<br />
<br />
and to enable them if they are not on, do<br />
<br />
setsebool -P httpd_can_network_connect 1<br />
setsebool -P httpd_can_network_connect_db 1<br />
<br />
taken from<br />
https://www.centos.org/modules/newbb/print.php?form=1&amp;topic_id=29646&amp;forum=38&amp;order=DESC&amp;start=0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106718""></a>
  <div class="note">
   <strong class="user">herrwil at gmail dot com</strong>
   <a href="#106718" class="date">30-Nov-2011 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following method: server\instance<br />
does'nt work on unix systems...<br />
<br />
An instance is nothing more than specific port address different than 1433... so just discover the port on mssql server and then try to connect using:<br />
<br />
ip:port<br />
<br />
In unix the port is specified by : not by ,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105132""></a>
  <div class="note">
   <strong class="user">benjamin at mysteriousquilt dot se</strong>
   <a href="#105132" class="date">29-Jul-2011 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If someone encounters the interesting problem in which PHP can connect to a MSSQL server from the command line but not when running as an Apache module: SELinux prevents Apache (and therefore all Apache modules) from making remote connections by default.<br />
<br />
This solved the problem in CentOS:<br />
# setsebool -P httpd_can_network_connect=1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104247""></a>
  <div class="note">
   <strong class="user">ben at adworkshop dot com</strong>
   <a href="#104247" class="date">03-Jun-2011 05:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connecting to a named instance of MSSQL.<br />
Our environment is a Windows 2003 server.<br />
Connecting to a dedicated MSSQL server running two instances of SQL SERVER 2005. The default instance and then a second named instance.<br />
My issue was in finding the syntax to properly identify the port of the named instance server.<br />
I found the answer finally in this thread, where a comma is used to separate the IP and PORT number.<br />
<br />
So, the code:<br />
<br />
mssql_connect('192.0.0.0,3456','USERNAME','PASSWORD');<br />
<br />
In this case we used the internal IP of the server, followed by the static port number assigned to the named instance, in this example 3456. The port number can be dynamic or static, obviously choosing static is the route to take.<br />
<br />
Hope this helps someone!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100066""></a>
  <div class="note">
   <strong class="user">me at pazuzusfate dot de</strong>
   <a href="#100066" class="date">23-Sep-2010 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't get it working with PHP 5.2.9 and MS SQL 2008, so I used this article <a href="http://msdn.microsoft.com/en-us/library/cc793139(SQL.90" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/cc793139(SQL.90</a>).aspx and with SQL login (not Windows authentication!) it works fine!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99862""></a>
  <div class="note">
   <strong class="user">Sarke</strong>
   <a href="#99862" class="date">10-Sep-2010 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
By far the easiest way that I've found to connect to a SQL server is to route it through a ODBC connection.<br />
<br />
1. Administrative Tools -&gt; Data Sources (ODBC)<br />
2. System DNS<br />
3. Add... "SQL Server"<br />
<br />
Then just use odbc_connect("sql_test", "user", "pass") instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98743""></a>
  <div class="note">
   <strong class="user">pgeier AT international-capital DOTcom</strong>
   <a href="#98743" class="date">04-Jul-2010 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have an application which requires MSSQL as interface (and not the new SQLSRV) you have to look for an alternative method. The old (now rightly unsupported) way from Microsoft does not work with PHP 5.3.<br />
After spending several days and nights with trying to connect <br />
here is an easy solution which worked great with all applicatins expecting mssql: FreeTDS for Windows. Here is a great how to with installer links on the Moodle site: <a href="http://docs.moodle.org/en/Installing_MSSQL_for_PHP" rel="nofollow" target="_blank">http://docs.moodle.org/en/Installing_MSSQL_for_PHP</a><br />
<br />
Couple of hints:<br />
- Make sure you have set up a user with "SQL SERVER authentication" who has rights to connect.<br />
- Also make sure after you install and still have problems to run PHPinfo and check that you find the below:<br />
<br />
PHPINFO: mssql<br />
MSSQL Support enabled <br />
...<br />
Library version&nbsp; FreeTDS&nbsp; <br />
<br />
That works perfect for me on Windows 2003 with IIS6 and PHP 5.3 (non threadsafe, VC9).<br />
Hope this is helpful</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96481""></a>
  <div class="note">
   <strong class="user">dju @ work</strong>
   <a href="#96481" class="date">01-Mar-2010 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a windows 2000 server, i have php 2.6 and apache<br />
It's been 2 days i'm trying to connect it to mssql server 2K5.<br />
i tried everything, of course getting the last version of the sql library (ntwdblib.dll), check the permissions, the dll version etc...&nbsp; but no way....<br />
Finally, i installed the last version of MDAC 2.8<br />
(there's an old one on win2000, even with all the updates...)<br />
And now it works perfectly :-))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96134""></a>
  <div class="note">
   <strong class="user">Micio2</strong>
   <a href="#96134" class="date">10-Feb-2010 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you try to connect to SQL Server 2008 Express, you always have to name the instance you are trying to connect to, even if you installed SQL2008express as "Default" instance instead of named instance. If your instance is SQLExpress and server name is myServer, the server parameter must be: "myServer\SQLExpress". If you installed Default instance of Standard (not express) version of SQL2008 instead, you don't need to name the instance. To connect using TCP/IP, you need also to check server network configuration, enable TCP/IP (listen all: yes), then go to addresses tab and setup port 1433 in all addresses you want the server listen on (by default, port is blank and server don't listen). Libraries involved in TCP/IP are ntwdblib.dll and dbnetlib.dll. Have fun!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91559""></a>
  <div class="note">
   <strong class="user">Iuri Jacob</strong>
   <a href="#91559" class="date">16-Jun-2009 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to connect to a remote SQL2000 server (located on Internet, not on the local network), then php always returned an "Unable to connect" error or something.
<br />

<br />
After waste a lot of time, by searching among foruns, blogs and logs, I finally discovered&nbsp; the problem. I was monitoring the TCP connections between the server and my machine when I realized that it wasn't been done. For some reason, my Apache 2.2 was "denying" php module from doing remote connections.
<br />

<br />
So I changed the php configuration on apache to CGI mode rather than as module mode. Well, it worked fine since that.
<br />

<br />
In despite of security holes that it involves, it was the only way I've found to make that remote connection works between Apache2.2/PHP5 and MSSQL Server 2000.
<br />

<br />
Strangely, connections inside local network worked in any case (in CGI or module mode).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89761""></a>
  <div class="note">
   <strong class="user">pesadelo at death dot fm</strong>
   <a href="#89761" class="date">21-Mar-2009 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a remind: Although it is not present here in this page, the parameter **$new_link** holds for mssql_connect() and mssql_pconnect(). The correspondent mysql functions documentation describes it though.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89760""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#89760" class="date">21-Mar-2009 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a remind: Although it is not present here in this page, the parameter **$new_link** holds for mssql_connect() and mssql_pconnect(). The correspondent mysql functions documentation describes it though.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89271""></a>
  <div class="note">
   <strong class="user">b56w</strong>
   <a href="#89271" class="date">28-Feb-2009 03:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a great deal of testing various things I finally found a solution for connecting to a named instance of MS SQL Express.&nbsp; I first had to download version 200.80.194.0 of ntwdblib.dll and overwrite the existing version in c:\PHP.&nbsp; I then tried an instance name that was posted by "chop_01 at yahoo dot com" in this thread.&nbsp; The instance name is ".\SQLEXPRESS".
<br />

<br />
For example:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp; $dbconnect </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">".\SQLEXPRESS"</span><span class="keyword">, </span><span class="default">$dbUser</span><span class="keyword">, </span><span class="default">$dbPass</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88637""></a>
  <div class="note">
   <strong class="user">wwang at moultonlogistics dot com</strong>
   <a href="#88637" class="date">01-Feb-2009 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone who have to connect to crappy SQL SERVER with \\computer_name\instance_name and failed to connect. There are couple of thing you need do.
<br />

<br />
1). There's no needs to install SQL client software in your app server. This would keep your server clean.
<br />
2). run cliconfg.exe setup alias in case you needed
<br />
3). last and most important, do NOT use ntwdblib.dll came with PHP 4.4.x. It's not most current. The version I'm using is: 8.00.194 with 274,489 Bytes. And make sure you put this file in your system32 folder.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85783""></a>
  <div class="note">
   <strong class="user">rcgandara at gmail dot com</strong>
   <a href="#85783" class="date">17-Sep-2008 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your are trying to connect to a MSSQLServer 8 and got this error: Unabled to connect to: [SERVER_NAME] <br />
and u r using Server authentication, make sure 2 set up mssql.secure_connection to Off in da php.ini<br />
<br />
RCGP <br />
<br />
Making this world better everyday... peace out</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85676""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#85676" class="date">11-Sep-2008 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might be obvious to some, but here is a quick tidbit that might save you some time if you're using FreeTDS in Linux:<br />
<br />
Be sure that you have these two lines in freetds.conf:<br />
dump file = /tmp/freetds.log<br />
dump file append = yes<br />
<br />
so you can tail -f it in the background of debugging the problem.&nbsp; This helped me find my issue on on CentOS Linux:&nbsp; <br />
&nbsp;<br />
1) tsql test works<br />
2) php-mssql connection in php also works WHEN RUN FROM THE SHELL<br />
3) running PHP through apache does NOT work.<br />
<br />
my /tmp/freetds.log file told me: <br />
net.c:168:Connecting to MYDBSERVER port MYDBPORT<br />
net.c:237:tds_open_socket: MYDBSERVER:MYDBPORT: Permission denied<br />
<br />
and the answer was my firewall/SELinux was denying the Apache processes access to connect to the remote MSSQL DB port, but my shell accounts were fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84307""></a>
  <div class="note">
   <strong class="user">getzeroedin at hotmail dot com</strong>
   <a href="#84307" class="date">08-Jul-2008 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those trying to connect PHP 5.2 to a 2005 Microsoft SQL Server Analysis Services (SSAS) cube and execute MDX queries, you have to establish a link via a trusted connection from the Database Service to SSAS using a stored procedure, then execute the stored procedure via PHP. <br />
<br />
Here is an example stored procedure that retrieves records from the Adventure Works sample cube that ships with SSAS.&nbsp;&nbsp; <br />
<br />
From SQL Server Query Analyzer, you could test it as:&nbsp; <br />
<br />
exec testMDX <br />
<br />
From PHP, you would execute something like the following:<br />
<br />
$resultset = mssql_query("exec testMDX",$res_id);<br />
<br />
then loop thorugh the result set.<br />
<br />
-- STORED PROCEDURE BEGIN<br />
<br />
set ANSI_NULLS ON -- Must be enabled at time Stored Proc is created<br />
set QUOTED_IDENTIFIER ON -- Must be enabled at time Stored Proc is created<br />
GO<br />
<br />
Create Procedure [dbo].[testMDX] <br />
as<br />
BEGIN<br />
SET ANSI_WARNINGS ON:&nbsp; -- Must be enabled<br />
SET ANSI_NULLS ON; -- Must be enabled<br />
<br />
Declare <br />
@SQL varchar(1200),&nbsp; -- Variable to hold SQL query<br />
@MDX varchar (1000), -- Variable to hold MDX query<br />
;<br />
<br />
-- Establish a link to Analysis Server<br />
exec sp_addlinkedserver <br />
@server='linked_olap', -- Alias used to reference the link<br />
@srvproduct='', -- Not used<br />
@provider='MSOLAP.3', -- OLAP driver<br />
@datasrc='servername', -- Database server name<br />
@catalog='Adventure Works DW Standard Edition' -- Database name<br />
;<br />
<br />
-- Analysis Server requires a TRUSTED connection<br />
exec sp_addlinkedsrvlogin <br />
@rmtsrvname = 'linked_olap', -- Alias used to reference the link<br />
@useself = 'false', -- Use own credentials<br />
@locallogin = NULL, -- Apply to all local logins<br />
@rmtuser = 'domain\username', -- Remote user name<br />
@rmtpassword = 'xyz123' -- Remote user password<br />
;<br />
<br />
-- Create a temporary table that will be used to hold the MDX output<br />
create table #temp_table (column1 text null, column2 text null);<br />
<br />
-- Setup a string to hold the MDX so that the precompiler does not try to validate the syntax<br />
SET @MDX = 'SELECT [Product].[Category].members ON ROWS,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {Measures.[Internet Order Count]} ON COLUMNS&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; FROM [Adventure Works]&nbsp; &nbsp; ' ;<br />
<br />
-- Setup a string to insert the MDX results into the temporary table<br />
SET @SQL = 'Insert into #temp_table SELECT * FROM OpenQuery(linked_olap,'''+@MDX+''')';<br />
<br />
-- Execute the SQL and remote MDX query<br />
EXEC (@SQL) ;<br />
<br />
-- Select the results from the temporary table to return to the calling program<br />
Select column1, column2 from #temp_table ;<br />
<br />
-- Drop the temporary table<br />
drop table #temp_table;<br />
<br />
-- Release the TRUSTED connection <br />
exec sp_droplinkedsrvlogin 'linked_olap', NULL ;<br />
<br />
-- Release the link to the Analysis Server<br />
exec sp_dropserver 'linked_olap' ;<br />
<br />
END<br />
<br />
-- STORED PROCEDURE END</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81780""></a>
  <div class="note">
   <strong class="user">simonhukin at gmail dot com</strong>
   <a href="#81780" class="date">13-Mar-2008 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a couple of days (seems to be the common theme) trying to get my code to connect to our new clustered 2005 SQL server instance. I finally did it. :-)<br />
<br />
For the following setup:<br />
<br />
PHP 5.2.4 (hosted on a Windows Server 2003 box)<br />
connecting to MSSQL 2005 in a clustered environment<br />
(was already connecting to MSSQL 2000 with no problems)<br />
<br />
I was about to get the client tools installed on the server, but this would have required a trip down to the data center by our IT guys (last resort - well actually last resort was to write a data access service in Java, which was connecting fine).<br />
<br />
Anyway, after making sure all the ntwdblib.dll were of the 2000.80.194.0 version. It was still not working.<br />
<br />
The thing which made it work was simply to specify the port.<br />
<br />
yes after 2days of looking into alternatives (incidently freetds - a windows compiled version, was working very intermittently) I found all I had to do was specify the port!<br />
<br />
I guess this is because I needed to connect via TCP/IP, our network admin didn't want named pipes used (as it's non-standard). Although, named pipes were enabled anyway. Specifying the port must have made the default behavour to connect via TCP/IP. Also the port was '1433' which I assumed was default anyway, hence hadn't specified before.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79561""></a>
  <div class="note">
   <strong class="user">edortizq at gmail dot com</strong>
   <a href="#79561" class="date">03-Dec-2007 07:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For connecting Linux + Apache + SQLEXPRESS 2005 take care about it:<br />
<br />
- Don′t use the standard MS-SQL port (1433), use the MS-SQL dinamic port under SQL Server Configuration Manager -&gt; SQL Express Protocols -&gt; TCP/IP properties -&gt; IP Adresses -&gt; IPAll<br />
<br />
- You can do a direct connection (without FreeTDS) using the following statemt:<br />
&nbsp; $db=mssql_connect('192.168.xxx.xxx:1541','usrxxxx','pwdxxxx');<br />
<br />
-You can use FreeTDS configuring the freetds.conf file as follow:<br />
&nbsp; [connect2k5]<br />
&nbsp; host = 192.168.xxx.xxx<br />
&nbsp; port = 1541<br />
&nbsp; tds version = 8.0<br />
With the following PHP statement:<br />
&nbsp; $db=mssql_connect('connect2k5','usrxxxx','pwdxxxx');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77150""></a>
  <div class="note">
   <strong class="user">Colin</strong>
   <a href="#77150" class="date">16-Aug-2007 03:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had lots of issues with trying to get SQL Server '05 (NOT Express) to work with PHP 5.1.2 on Windows Server '03 SP2 running IIS 6. This is what finally worked:<br />
- Uncomment the php_mssql.dll line in php.ini<br />
- Replace the ntwdblib.dll file in /php/ext/ with the (smaller) downloadable file from webzila.com<br />
- Set SQL Server to mix-mode authentication ("Windows and SQL Server Auth")<br />
- Create IUSR_&lt;computer_name&gt; account in SQL Server using Windows authentication<br />
- Grant read/write access to the IUSR_&lt;computer_name&gt; in SQL Server<br />
- Create SQL auth account using SQL authentication<br />
- Grant read/write access to the SQL auth account in SQL Server<br />
- Restart the system<br />
<br />
I'd imagine that creating a way for IUSR to get into the SQL Server is NOT a good idea, but this is the only way I could get it to work. Hopefully, a future update to SQL Server will fix this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76516""></a>
  <div class="note">
   <strong class="user">hao dot wang at outsourcing dot org</strong>
   <a href="#76516" class="date">18-Jul-2007 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those poor people (like myself) who have to use MS SH*T SQL 2005 and cannot connect it.<br />
<br />
I have to use sql server 2005 (another piece of sh*t from MS) at work. It takes me hours to connect this garbage. I end up find I have to enable TCP/IP under "Protocols for MSSQLSERVER". To do this, you need go to <br />
START &gt;&gt; PROGRAMS &gt;&gt; MS Sql server 2005 &gt;&gt; Configuration Tools &gt;&gt; Sql Server configuration Manger <br />
<br />
Click "+" sign next to "Sql server 2005 network configuration" then<br />
click to highlight "Protocols for MSSQLSERVER" then<br />
in right panel right click "TCP/IP" and enable it. <br />
<br />
DO NOT for get restart you sql server service and pray to dear God your company will dump MS one day.<br />
<br />
DO NOT install "ActiveScript engine" as MS suggested. You don't want extra trouble and junk.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69857""></a>
  <div class="note">
   <strong class="user">kamikazie at comcast dot net</strong>
   <a href="#69857" class="date">23-Sep-2006 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ok, so after many many many hours of searching (somewhere around the ballpark of 2 weeks, on and off) and reading these pages, I've found the answer to my unspoken question (although there was much cursing).<br />
<br />
Background:<br />
<br />
A Windows Server 2003 box running as a router and a webserver using IIS6 and the latest PHP 5 as of 23 Sep 2006.<br />
<br />
A Windows Server 2003 box running SQL 2000 Enterprise with one instance<br />
<br />
Using a named pipe, the code to connect was:<br />
"$connection = mssql_connect("\\.\pipe\MSSQL$instance\sql\query", "user", "pass") or die("Message"); "<br />
<br />
I recieved the error that $instance was not a defined variable, so I changed it to<br />
"\\.\pipe\MSSQLinstance\sql\query"<br />
both on the connection string and the SQL server<br />
<br />
When passed on to the server, I still recieved connection errors, so I changed it again, this time to:<br />
"$connection = mssql_connect("\\\\.\pipe\\MSSQLinstance\\sql\\query", "user", "pass") or die("Message"); "<br />
<br />
With this new code, I recieved a successful connection, but a bad login saying that my IUSR_ account did not have permissions on the database, although I used a separate username in the connection string.<br />
<br />
Using SQL, I setup windows authentication for the IUSR_ account and I was able to establish a connection and successfully run a query.<br />
<br />
I still can't find out why it was trying to pass the IUSR_ account as the login though.&nbsp; If anyone has an answer drop me a line.<br />
<br />
Now using windows groups it should be easy to create a login page that uses groups to connect to databases rather than setting up each user individually.<br />
<br />
I just wanted to share with everyone my long awaited success story.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68115""></a>
  <div class="note">
   <strong class="user">munckfish.net</strong>
   <a href="#68115" class="date">13-Jul-2006 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to the following posts on Windows 2003 + PHP5 + SQL Server Express.<br />
<br />
<a href="http://php.net/manual/en/function.mssql-connect.php#58787" rel="nofollow" target="_blank">http://php.net/manual/en/function.mssql-connect.php#58787</a><br />
<a href="http://uk2.php.net/manual/en/function.mssql-connect.php#61971" rel="nofollow" target="_blank">http://uk2.php.net/manual/en/function.mssql-connect.php#61971</a><br />
<br />
I ran into another problem when I updated the version of ntwdblib.dll. I picked up version 2000.80.2039.0 from an SQL Server 2000 installation. However, when I replaced the PHP 5 provided version with this one and restarted IIS, phpinfo() showed that the mssql extension wasn't loading anymore. I couldn't see any errors reported in browser nor the system error logs.<br />
<br />
By chance I decided to run 'php -i' on the command line. This was lucky because running it this way a system error dialog popped up a warning about a missing DLL dependency.<br />
<br />
The problem was that the new ntwdblib.dll had a dependency on MSVCR71.DLL which couldn't be found in IIS' path. I did a search for msvcr*.dll in C:\\WINDOWS and found a copy of this DLL in C:\\WINDOWS\\Microsoft.NET\\Framework\\v1.1.4322\\. I copied it into my PHP install dir and restarted IIS. Then when I ran phpinfo() the extension showed up again.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57880""></a>
  <div class="note">
   <strong class="user">mckoin at example dot com</strong>
   <a href="#57880" class="date">17-Oct-2005 08:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use PHP on Windows with Apache as a web server, you may get problems with authentication to MS SQL Server even when you supply all valid credentials. <br />
<br />
Check your php.ini file:<br />
; Use NT authentication when connecting to the server<br />
mssql.secure_connection = On<br />
<br />
If you have secure_connection = On, make sure that you provide valid credentials in the properties for Apache service in the System Services box. Then you should not send DB username and password from your script to MSSQL Server.<br />
<br />
If you want to use specific credentials from a PHP script, then set mssql.secure_connection = Off in your php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57120""></a>
  <div class="note">
   <strong class="user">j3d</strong>
   <a href="#57120" class="date">24-Sep-2005 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After struggling for 6 hours trying to fix the dreaded "Not associated with a trusted SQL Server connection." error I have finally solved it after following the suggestions presented here: 
<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;839569" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;839569</a>
<br />

<br />
&lt;sarcasm&gt; Who would have thought that microsoft's article would be useful &lt;/sarcasm&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56929""></a>
  <div class="note">
   <strong class="user">dale dot liszka at gmail dot com</strong>
   <a href="#56929" class="date">19-Sep-2005 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to use Sybase and MSSQL on the same WIN32 box you will probably have headaches.&nbsp; There are multiple declaration errors when you enable php_sybase_ct.dll and php_mssql.dll in the php.ini at the same time.<br />
<br />
The specific error for all functions starts like this:<br />
PHP Warning: Function registration failed - duplicate name - mssql_connect<br />
<br />
There is a way around this! On a windows box I have done this successfully several times.<br />
<br />
1. Make a backup copy of php_sybase_ct.dll (never hurts!)<br />
2. Open php_sybase_ct.dll in a HEX editor (fhred is a nice free one <a href="http://www.kibria.de/frhed.html " rel="nofollow" target="_blank">http://www.kibria.de/frhed.html </a>)<br />
3. Replace all instances of 'mssql' with 'sysql'.&nbsp; It doesn't have to be 'sysql', just anything but 'mssql' or 'sybase'.<br />
4. Save the file.&nbsp; (Alternately you could save as something like php_sybase_ct_modified.dll and cite that in your php.ini)<br />
<br />
All the constructs are still declared for the sybase_* functions and now you can use MSSQL and Sybase instead of switching php.ini files, etc.&nbsp; I have had this work under php 4.3+ and php 5.0.5.<br />
<br />
PS. I decided to place this under mssql_connect because its the first error thrown in this case.&nbsp; I believe it should make the information easier to find via google/search/browsing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55211""></a>
  <div class="note">
   <strong class="user">Marcel Laverdet</strong>
   <a href="#55211" class="date">27-Jul-2005 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems connecting to a SQL cluster with mssql_connect, but any other program could connect just fine. I ended up using a PHP ADODB driver to work around the connectivity problem I was having. Later, however, I discovered my problem was a mismatched name in the server table.<br />
<br />
To see if you have this problem, "SELECT * FROM [master].[sysservers]". If the srvname, and datasource don't match the cluster's virtual SQL name... then you will have a problem. My virtual SQL server's name was 'SQL-SERV', however in the sysservers table it was listed as 'SQLSERV'.<br />
<br />
To remedy this problem, simply issue the following queries: "EXECUTE sp_dropserver wrongName" and then "EXECUTE sp_addserver rightName, 'local'". After running these 2 procedures, restart the server and PHP should connect just fine using the native libraries.<br />
<br />
If it still doesn't connect, make sure you update the ntwdblib.dll file as explained in prior comments.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53808""></a>
  <div class="note">
   <strong class="user">Robert at realjax dot com</strong>
   <a href="#53808" class="date">13-Jun-2005 06:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A view that worked fine when queried from any other environment was giving me strange results when queried from PHP.&nbsp; The problem is that the MS SQL database settings are not set to the ANSI defaults as when connecting through Microsoft products.&nbsp; The setting CONCAT_NULL_YIELDS_NULL defaults to ON when connecting with ODBC or SQL Query Analyzer, which complies with the ANSI standard.&nbsp; However, this defaults to OFF when connecting through PHP.&nbsp; There are many other settings which may also need to be explicitly set.<br />
<span class="default">&lt;?php<br />
mssql_query</span><span class="keyword">(</span><span class="string">'SET CONCAT_NULL_YIELDS_NULL ON'</span><span class="keyword">, </span><span class="default">$hd</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52922""></a>
  <div class="note">
   <strong class="user">bass28</strong>
   <a href="#52922" class="date">17-May-2005 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When connecting to a SQL 2000 DB from an Apache/PHP setup on a Windows box you must connect using a SQL user login (type=standard).&nbsp; If you add Windows users or groups to SQL security logins and try connecting using that login the connection will fail.&nbsp; If the connection works for SA but not for your login, this may be your answer (it was for me!).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51783""></a>
  <div class="note">
   <strong class="user">kryltsov at yahoo dot com</strong>
   <a href="#51783" class="date">11-Apr-2005 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you connect to MSSQL and&nbsp; get error 515 (INSERT NULL INTO NOT NULL VALUE). <br />
Execute following statement after connection to DB.<br />
"set ANSI_NULL_DFLT_ON ON". There are lots of code arround where SP creates, for example, temp tables. There is no specification 'NOT NULL' on columns. Many people beleive that it means that nulls will be allowed.<br />
After 5 days of debugging one of the software monsters SQL code I found that PHP connects to MSSQL (at least on my server) without setting "ANSI_NULL_DFLT_ON" which caused SP fired by insert trigger failed with 515 error because temp tables had been created with all columns 'NOT NULL'.<br />
QA and from ASP everything was working just fine.<br />
<br />
After I set ANSI_NULL_DFLT_ON to ON. Everything started working fine.<br />
Hope it wil help.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51346""></a>
  <div class="note">
   <strong class="user">yurtesen at ispro dot net dot tr</strong>
   <a href="#51346" class="date">28-Mar-2005 07:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using FreeBSD you shouldnt forget to copy freetds.conf.dist to freetds.conf and edit. Otherwise you will get:<br />
PHP Warning:&nbsp; mssql_connect(): Unable to connect to server:&nbsp; BLAH in</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50793""></a>
  <div class="note">
   <strong class="user">nospam_bg at pumkinhed dot com</strong>
   <a href="#50793" class="date">09-Mar-2005 07:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On freebsd I edited the Makefile in /usr/ports/lang/php5 and added&nbsp; --with-mssql=/usr/local to the CONFIGURE_ARGS= section (ensure to put a \ in front of the previous line), then it will use tds.h correctly....&nbsp; hth</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48247""></a>
  <div class="note">
   <strong class="user">bartlewis at gmail dot com</strong>
   <a href="#48247" class="date">16-Dec-2004 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am yet another person who had problems getting php[5] to play nicely with SQL Server 2000 [MSDE] on WinXP SP2 w/IIS. Following the notes on this page from previous users did get me closer, but I still could not connect. I was getting an error that said, in essence:<br />
<br />
"MACHINENAME\IUSR_MACHINENAME" could not connect to the server.<br />
<br />
Through some painstaking googeling I was able to resolve the problem by following this MSKB article:<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;319930" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;319930</a><br />
<br />
It seems that my default install of MSDE did NOT "Enable Mixed Mode Authentication" which is required for this kind of connection. To make matters worse, the only way to change this with MSDE is to go mucking with the registry (which always freaks me out a bit). The above article explains how to do this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48150""></a>
  <div class="note">
   <strong class="user">cbunk at arescorporation dot com</strong>
   <a href="#48150" class="date">13-Dec-2004 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems connecting a IIS6 Webserver on a 2003 windows box to a MSSQL Installation running windows 2000.&nbsp; After suspecting ntwdblib.dll I tried updating the file but with no luck.&nbsp; Finally I figured out the problem by noticing that in addition to a copy of the file living in the windows directory there was one in the PHP directory as well (from the zip package).&nbsp; Although I had an up to date version of the file in my windows directory the one in the php directory was getting read instead.&nbsp; I simply removed the file from my php installation directory and all worked well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47493""></a>
  <div class="note">
   <strong class="user">chrisputnam at gmail dot com</strong>
   <a href="#47493" class="date">17-Nov-2004 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having trouble getting PHP to connect to a SQL 2000 Server (the MSDE, specifically), try running the Server Network Client usually located at C:\Program Files\Microsoft SQL Server\80\Tools\Binn\SVRNETCN.exe<br />
<br />
Disable all protocols but Named Pipes. Then Apply your changes, click OK, and restart the SQL service with these commands at a command prompt:<br />
<br />
net stop mssqlserver [if it says the agent will stop too, let it happen]<br />
net start mssqlserver<br />
net start sqlserveragent<br />
<br />
That fixed it all for me.<br />
<br />
Also note that named pipes has a huge performance difference against TCP/IP. Named pipes are a tremendous amount faster.<br />
<br />
I have been working on this for two days now and I hope someone else stumbles across my solution!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46220""></a>
  <div class="note">
   <strong class="user">mworku at securiant dot com</strong>
   <a href="#46220" class="date">02-Oct-2004 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It looks like by default libphp5 ignores freetd's conf file if you 
<br />
specify your SQL server's ip address within the mssql_connect() function.
<br />

<br />
If you need to utilize freetds.conf file for connection parameters use the putenv function as follows
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp; putenv</span><span class="keyword">(</span><span class="string">'FREETDSCONF='</span><span class="default">path to your freetds conf</span><span class="keyword">. </span><span class="default">file</span><span class="string">')
<br />

<br />
&nbsp; /* 
<br />
&nbsp;&nbsp;&nbsp; SQL CODE
<br />
&nbsp;&nbsp;&nbsp; mssql_connect('</span><span class="default">MSSQL_2000</span><span class="keyword">, </span><span class="string">'user' </span><span class="keyword">, </span><span class="string">'pwd'</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; ....
<br />
&nbsp;&nbsp;&nbsp; ....
<br />
&nbsp; */
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
All connection parameters should now be read from the conf file. Also don't enable logging unless you're debugging, performace will suffer.
<br />

<br />
/* freetds.conf
<br />
&nbsp;[MSSQL_2000]
<br />
&nbsp;&nbsp;&nbsp; host = 192.168.10.10
<br />
&nbsp;&nbsp;&nbsp; port = 1433
<br />
&nbsp;&nbsp;&nbsp; tds version = 8.0
<br />
;&nbsp; &nbsp; dump file = /etc/freetds/log/freetds.log
<br />
;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dump file append = yes
<br />
;&nbsp; &nbsp; debug level = 99
<br />
*/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41163""></a>
  <div class="note">
   <strong class="user">bianco at bluetone dot com</strong>
   <a href="#41163" class="date">01-Apr-2004 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Little idea about 255 characters limitation. :)<br />
<br />
In tables I'm using column type "varchar" or "nvarchar" instead "text". And also I use for example varchar(8000). And there is "a bug". :) PHP will read this column only as varchar(255). So how to read more then 255 chars from varchar(8000)? It is very easy, use CAST to convert varchar type to text type.<br />
<br />
select CAST(Comment as TEXT) from Job<br />
<br />
PHP will read it. Check php.ini section [MSSQL] and set maximum text length. Check parameters<br />
<br />
mssql.textlimit = 4096<br />
mssql.textsize = 4096<br />
<br />
Maximum length is 2147483647<br />
<br />
Bye</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40802""></a>
  <div class="note">
   <strong class="user">nuying117 at 163 dot com</strong>
   <a href="#40802" class="date">15-Mar-2004 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I came across the same question as jack,but there was no effect when i use his method.and then ,I created a user named IUSER_YOUR_COMPUTER_NAME which is the same as the user who start the IIS process,it works!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28616""></a>
  <div class="note">
   <strong class="user">Filipus</strong>
   <a href="#28616" class="date">17-Jan-2003 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Linux MDK 9.0, PHP 4.3.0 MSSQL 2000 on remote host
<br />
We used freetds (www.freetds.org) compiled with parameter:
<br />
./configure --prefix=/usr/local/freetds
<br />
PHP was compiled with parameter: 
<br />
./configure --with-mssql=/usr/local/freetds [and some others]
<br />

<br />
We added our section in /usr/local/freetds/freetds.conf
<br />
----------------------------------
<br />
[MyServer70]
<br />
host = 172.16.20.81
<br />
port = 1433
<br />
tds version = 7.0
<br />
----------------------------------
<br />
in mssql_connect() you have to provide as a hostname the name you put between [] brackets in freetds.conf OR specify host:port
<br />

<br />
$connection = mssql_connect("MyServer70", "d", "d");
<br />
or
<br />
$connection = mssql_connect("172.16.20.81:1433", "d", "d");
<br />

<br />
Remember to specify port!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24888""></a>
  <div class="note">
   <strong class="user">s dot westermayer at nospam-netnnet dot de</strong>
   <a href="#24888" class="date">03-Sep-2002 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SQL Server Authentication Mode must be set to "SQL Server and Windows" or your SQL Server will not accept a connection and diplay: <br />
Warning: MS SQL message: Login failed for user 'myuser'. Reason: Not associated with a trusted SQL Server connection. (severity 14) in...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
