<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>SoapClient constructor</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="soapclient.soapcall.html">? SoapClient::__soapCall</a></li>
      <li style="float: right;"><a href="class.soapserver.html">SoapServer ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.soapclient.html">SoapClient</a></li>
    <li>SoapClient constructor</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="soapclient.soapclient" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SoapClient::SoapClient</h1>
  <p class="verinfo">(PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">SoapClient::SoapClient</span> &mdash; <span class="dc-title">SoapClient constructor</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-soapclient.soapclient-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>SoapClient::SoapClient</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$wsdl</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   This constructor creates <a href="class.soapclient.html" class="classname">SoapClient</a> objects 
   in <em>WSDL</em> or <em>non-WSDL</em> mode.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-soapclient.soapclient-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">wsdl</code></dt>

     <dd>

      <p class="para">
       URI of the <em>WSDL</em> file or <strong><code>NULL</code></strong> if working in 
       <em>non-WSDL</em> mode.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <p class="para">
        During development, WSDL caching may be disabled by the
        use of the <em>soap.wsdl_cache_ttl</em> <var class="filename">php.ini</var> setting
        otherwise changes made to the WSDL file will have no effect until
        <em>soap.wsdl_cache_ttl</em> is expired. 
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       An array of options. If working in WSDL mode, this parameter is optional.
       If working in non-WSDL mode, the <em>location</em> and 
       <em>uri</em> options must be set, where <em>location</em>
       is the URL of the SOAP server to send the request to, and <em>uri</em>
       is the target namespace of the SOAP service.
      </p>
      <p class="para">
       The <em>style</em> and <em>use</em> options only work in
       non-WSDL mode. In WSDL mode, they come from the WSDL file.
      </p>
      <p class="para">
       The <em>soap_version</em> option should be one of either
       <strong><code>SOAP_1_1</code></strong> or <strong><code>SOAP_1_2</code></strong> to
       select SOAP 1.1 or 1.2, respectively. If omitted, 1.1 is used.
      </p>
      <p class="para">
       For HTTP authentication, the <em>login</em> and
       <em>password</em> options can be used to supply credentials. 
       For making an HTTP connection through
       a proxy server, the options <em>proxy_host</em>,
       <em>proxy_port</em>, <em>proxy_login</em>
       and <em>proxy_password</em> are also available.
       For HTTPS client certificate authentication use
       <em>local_cert</em> and <em>passphrase</em> options. An 
       authentication may be supplied in the <em>authentication</em> 
       option. The authentication method may be either 
       <strong><code>SOAP_AUTHENTICATION_BASIC</code></strong> (default) or 
       <strong><code>SOAP_AUTHENTICATION_DIGEST</code></strong>.
      </p>
      <p class="para">
       The <em>compression</em> option allows to use compression
       of HTTP SOAP requests and responses.
      </p>
      <p class="para">
       The <em>encoding</em> option defines internal character 
       encoding. This option does not change the encoding of SOAP requests (it is
       always utf-8), but converts strings into it.
      </p>
      <p class="para">
       The <em>trace</em> option enables tracing of request so faults 
       can be backtraced. This defaults to <strong><code>FALSE</code></strong>
      </p>
      <p class="para">
       The <em>classmap</em> option can be used to map some WSDL 
       types to PHP classes. This option must be an array with WSDL types 
       as keys and names of PHP classes as values.
      </p>
      <p class="para">
       Setting the boolean <em>trace</em> option enables use of the
       methods <a href="soapclient.getlastrequest.html" class="link">
       SoapClient-&gt;__getLastRequest</a>, 
      <a href="soapclient.getlastrequestheaders.html" class="link">
       SoapClient-&gt;__getLastRequestHeaders</a>,
       <a href="soapclient.getlastresponse.html" class="link">
       SoapClient-&gt;__getLastResponse</a> and
       <a href="soapclient.getlastresponseheaders.html" class="link">
       SoapClient-&gt;__getLastResponseHeaders</a>.
      </p>
      <p class="para">
       The <em>exceptions</em> option is a boolean value defining whether
       soap errors throw exceptions of type <a href="soapfault.soapfault.html" class="link">
       SoapFault</a>.
      </p>
      <p class="para">
       The <em>connection_timeout</em> option defines a timeout in seconds 
       for the connection to the SOAP service. This option does not define a timeout
       for services with slow responses. To limit the time to wait for calls to finish the 
       <a href="filesystem.configuration.html#ini.default-socket-timeout" class="link">default_socket_timeout</a> setting
       is available.
      </p>
      <p class="para">
       The <em>typemap</em> option is an array of type mappings.
       Type mapping is an array with keys <em>type_name</em>,
       <em>type_ns</em> (namespace URI), <em>from_xml</em>
       (callback accepting one string parameter) and <em>to_xml</em>
       (callback accepting one object parameter).
      </p>
      <p class="para">
       The <em>cache_wsdl</em> option is one of
       <strong><code>WSDL_CACHE_NONE</code></strong>,
       <strong><code>WSDL_CACHE_DISK</code></strong>,
       <strong><code>WSDL_CACHE_MEMORY</code></strong> or
       <strong><code>WSDL_CACHE_BOTH</code></strong>.
      </p>
      <p class="para">
       The <em>user_agent</em> option specifies string to use in
       <em>User-Agent</em> header.
      </p>
      <p class="para">
       The <em>stream_context</em> option is a <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
       for <a href="context.html" class="link">context</a>.
      </p>
      <p class="para">
       The <em>features</em> option is a bitmask of
       <strong><code>SOAP_SINGLE_ELEMENT_ARRAYS</code></strong>,
       <strong><code>SOAP_USE_XSI_ARRAY_TYPE</code></strong>,
       <strong><code>SOAP_WAIT_ONE_WAY_CALLS</code></strong>.
      </p>
      <p class="para">
       The <em>keep_alive</em> option is a boolean value defining whether
       to send the <em>Connection: Keep-Alive</em> header or 
       <em>Connection: close</em>.
      </p>
      <p class="para">
       The <em>ssl_method</em> option is one of
       <strong><code>SOAP_SSL_METHOD_TLS</code></strong>,
       <strong><code>SOAP_SSL_METHOD_SSLv2</code></strong>,
       <strong><code>SOAP_SSL_METHOD_SSLv3</code></strong> or
       <strong><code>SOAP_SSL_METHOD_SSLv23</code></strong>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-soapclient.soapclient-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   <span class="methodname"><strong>SoapClient::SoapClient()</strong></span> will generate an
   <strong><code>E_ERROR</code></strong> error if the <em>location</em> and
   <em>uri</em> options aren&#039;t provided in non-WSDL mode.
  </p>
  <p class="para">
   A <a href="class.soapfault.html" class="classname">SoapFault</a> exception will be thrown if the
   <code class="parameter">wsdl</code> URI cannot be loaded.
  </p>
 </div>


<div class="refsect1 changelog" id="refsect1-soapclient.soapclient-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.5.0</td>
       <td>
        New <em>ssl_method</em> option.
       </td>
      </tr>

      <tr>
       <td>5.4.0</td>
       <td>
        New <em>keep_alive</em> option.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-soapclient.soapclient-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-6463">
    <p><strong>Example #1 <span class="function"><strong>SoapClient::SoapClient()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'soap_version'&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_1_2</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'login'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_name"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'password'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_password"</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'proxy_host'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_port'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">8080</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'proxy_host'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_port'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">8080</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_login'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_name"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_password'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_password"</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'local_cert'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"cert_key.pem"</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'location'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://localhost/soap.php"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'uri'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://test-uri/"</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'location'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://localhost/soap.php"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'uri'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://test-uri/"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'style'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_DOCUMENT</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'use'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_LITERAL</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;array(</span><span style="color: #DD0000">'compression'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_COMPRESSION_ACCEPT&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">SOAP_COMPRESSION_GZIP</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'encoding'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">));<br /><br />class&nbsp;</span><span style="color: #0000BB">MyBook&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$title</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$author</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"books.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'classmap'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'book'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"MyBook"</span><span style="color: #007700">)));<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123604""></a>
  <div class="note">
   <strong class="user">psy at psyberware dot com</strong>
   <a href="#123604" class="date">11-Feb-2019 09:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you try to use a 'stream_context' option to set additional HTTP headers, you should be aware of a couple of things.<br />
<br />
First, even if you are using a https URL, the 'header' will be pulled from the 'http' section:<br />
<br />
$context = stream_context_create([<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'https' =&gt; [<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'header' =&gt; 'Test: this will be ignored'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'http' =&gt; [<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'header' =&gt; 'Test: this will be used'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ]<br />
]);<br />
<br />
Second, there are a number of headers that are ignored, and will never be used. Check the underlying C source file soap/php_http.c and search for "skip some predefined headers" for a list.&nbsp; This is the reason some people report problems trying to set Host, Authorization, and other headers in certain situations.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122881""></a>
  <div class="note">
   <strong class="user">Flaviu</strong>
   <a href="#122881" class="date">26-Jun-2018 06:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using classmap, the class constructors are NOT called. <br />
If you want to do additional "magic", you can use the __set() / __get() combo. <br />
Register a class with a "container" property alone and use the 2 magic methods.<br />
<br />
Have fun</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122372""></a>
  <div class="note">
   <strong class="user">Thomas Van Canegem</strong>
   <a href="#122372" class="date">08-Feb-2018 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further explanation regarding the cache options in WSDL mode:<br />
<br />
WSDL_CACHE_MEMORY: <br />
Will do a request and cache the WSDL's xml when instantiating the SoapClient object for the first time; invoked by EVERY request.<br />
<br />
WSDL_CACHE_DISK: <br />
Will do a request and cache the WSDL's xml the first time the SoapClient object is instantiated by A request.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121932""></a>
  <div class="note">
   <strong class="user">ryan dot jentzsch at gmail dot com</strong>
   <a href="#121932" class="date">28-Nov-2017 10:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation is wrong (version 7.1.12): A SoapFault exception will be thrown if the wsdl URI cannot be loaded.<br />
<br />
What actually occurs -- even if wrapped in a try...catch(\Throwable $t) -- is an UNCATCHABLE fatal error is thrown.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120888""></a>
  <div class="note">
   <strong class="user">mkroese at eljakim dot nl</strong>
   <a href="#120888" class="date">29-Mar-2017 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do note that *contrary* to the ssl context option (<a href="http://php.net/manual/en/context.ssl.php#context.ssl.local-pk" rel="nofollow" target="_blank">http://php.net/manual/en/context.ssl.php#context.ssl.local-pk</a>),&nbsp; `local_pk` is NOT a valid option. For the `local_cert` option, you should combine the private key with the certificate file.<br />
<br />
Alternatively, if you do want to keep the private key and certificate file separate, you can create a stream context and pass that as the `context` option:<br />
<br />
<span class="default">&lt;?php<br />
$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">([<br />
&nbsp; </span><span class="string">'ssl' </span><span class="keyword">=&gt; [<br />
&nbsp;&nbsp; </span><span class="string">'local_cert' </span><span class="keyword">=&gt; </span><span class="string">'/path/to/cert/file'</span><span class="keyword">,<br />
&nbsp;&nbsp; </span><span class="string">'local_pk'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'/path/to/private/key'<br />
&nbsp; </span><span class="keyword">]]);<br />
<br />
</span><span class="default">$client </span><span class="keyword">= new \</span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, [<br />
&nbsp; </span><span class="string">'context' </span><span class="keyword">=&gt; </span><span class="default">$context</span><span class="keyword">,<br />
&nbsp; </span><span class="comment">// other options<br />
</span><span class="keyword">]);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120287""></a>
  <div class="note">
   <strong class="user">fschmidt at informatik dot uni-leipzig</strong>
   <a href="#120287" class="date">07-Dec-2016 12:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In local_cert, the order of the certificates is relevant. After the key, first add the client certificate, then the rest of the chain. Offering the certificate chain before the client cert or only adding it to the system capath will result in an "alert unknown ca".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119085""></a>
  <div class="note">
   <strong class="user">cdesully at webslicer dot com</strong>
   <a href="#119085" class="date">30-Mar-2016 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found a good use for typemap.&nbsp; When using classmap any xml tags that had attributes, attribute values were not captured, so a typemap allows you to override how a class gets implemented and being able to get any attributes not previously captured.<br />
<br />
&lt;ItemList&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;Item productId="1234"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;feature&gt;red&lt;/feature&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/Item&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;Item productId="5678"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;feature&gt;blue&lt;/feature&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/Item&gt;<br />
&lt;/ItemList&gt;<br />
<br />
<span class="default">&lt;?php </span><span class="comment">//semi-pseudo code <br />
</span><span class="keyword">namespace </span><span class="default">ExampleNS</span><span class="keyword">;<br />
<br />
class </span><span class="default">ItemList </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$item </span><span class="keyword">= [];<br />
}<br />
class </span><span class="default">Item </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$productId</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$feature</span><span class="keyword">;<br />
}<br />
<br />
class </span><span class="default">Service </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$options </span><span class="keyword">= [<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'classmap' </span><span class="keyword">=&gt; [<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ItemList' </span><span class="keyword">=&gt; </span><span class="string">'ExampleNS\ItemList'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'Item' </span><span class="keyword">=&gt; </span><span class="string">'ExampleNS\Item'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'typemap'</span><span class="keyword">=&gt;[<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'type_ns' </span><span class="keyword">=&gt; </span><span class="string">'<a href="http://some.wsdl.ns/sdo" rel="nofollow" target="_blank">http://some.wsdl.ns/sdo</a>'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'type_name' </span><span class="keyword">=&gt; </span><span class="string">'Item'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'from_xml' </span><span class="keyword">=&gt; [</span><span class="default">__CLASS__</span><span class="keyword">,</span><span class="string">'newConversion'</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ]<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">newConversion</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//or more appropriately dig into the simplexml object and <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //instantiate the correct classes intended to be defined and <br />
&nbsp;&nbsp; &nbsp; &nbsp; //return those<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118465""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#118465" class="date">10-Dec-2015 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After installing PHP 7 on my test server I was receiving a 500 - Internal Server error when instantiating a new SoapClient. If there's an existing wsdl cache file, it needs to be deleted.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117537""></a>
  <div class="note">
   <strong class="user">omidkosari at yahoo dot com</strong>
   <a href="#117537" class="date">25-Jun-2015 04:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To solve the problem with a lot of FIN_WAIT2 or CLOSE_WAIT , you should use the option keep_alive=false</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117135""></a>
  <div class="note">
   <strong class="user">info at nospam x valiton x com</strong>
   <a href="#117135" class="date">20-Apr-2015 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CAUTION:<br />
I had quite a bit of trouble trying to make a request with fopen through a proxy to a secure url.&nbsp; I kept getting a 400 Bad Request back from the remote host.&nbsp; It was receiving the proxy url as the SNI host.&nbsp; In order to get around this I had to explicity set the SNI host to the domain I was trying to reach.&nbsp; It's apparently the issue outlined in this bug:<br />
<br />
https://bugs.php.net/bug.php?id=63519<br />
<br />
<span class="default">&lt;?php<br />
$domain </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">PHP_URL_HOST</span><span class="keyword">);<br />
</span><span class="default">$proxy_string </span><span class="keyword">= </span><span class="string">"tcp://" </span><span class="keyword">. </span><span class="default">WP_PROXY_HOST&nbsp; </span><span class="keyword">. </span><span class="string">":" </span><span class="keyword">. </span><span class="default">WP_PROXY_PORT</span><span class="keyword">;<br />
</span><span class="default">$opts </span><span class="keyword">= array( <br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array( </span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="default">$proxy_string </span><span class="keyword">),<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'ssl' </span><span class="keyword">=&gt; array( </span><span class="string">'SNI_enabled' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">, </span><span class="string">'SNI_server_name' </span><span class="keyword">=&gt; </span><span class="default">$domain</span><span class="keyword">));<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">( </span><span class="default">$file</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
src:<br />
<a href="http://php.net/manual/en/context.http.php#114314" rel="nofollow" target="_blank">http://php.net/manual/en/context.http.php#114314</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116931""></a>
  <div class="note">
   <strong class="user">champetier dot etienne at gmail dot com</strong>
   <a href="#116931" class="date">23-Mar-2015 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using classmap, never put a fully qualified classname (starting with \)<br />
there is a bug (https://bugs.php.net/bug.php?id=69280)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115985""></a>
  <div class="note">
   <strong class="user">joshua at wiredrive dot com</strong>
   <a href="#115985" class="date">22-Oct-2014 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of 5.5, ssl_method defaults to SOAP_SSL_METHOD_SSLv23. Just wanted to add this because it was not explicitly specified above.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114976""></a>
  <div class="note">
   <strong class="user">Peter</strong>
   <a href="#114976" class="date">08-May-2014 02:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you need to use ws-security with a nonce and a timestamp, you can use this :<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">WsseAuthHeader </span><span class="keyword">extends </span><span class="default">SoapHeader </span><span class="keyword">{<br />
<br />
private </span><span class="default">$wss_ns </span><span class="keyword">= </span><span class="string">'<a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" rel="nofollow" target="_blank">http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd</a>'</span><span class="keyword">;<br />
private </span><span class="default">$wsu_ns </span><span class="keyword">= </span><span class="string">'<a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" rel="nofollow" target="_blank">http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd</a>'</span><span class="keyword">;<br />
<br />
function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$created </span><span class="keyword">= </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'Y-m-d\TH:i:s\Z'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nonce </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$passdigest </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">sha1</span><span class="keyword">( </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">$nonce</span><span class="keyword">) . </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a*'</span><span class="keyword">,</span><span class="default">$created</span><span class="keyword">).&nbsp; </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a*'</span><span class="keyword">,</span><span class="default">$pass</span><span class="keyword">))));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$auth </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Username </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Password </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$pass</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Nonce </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$passdigest</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Created </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$created</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wsu_ns</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$username_token </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$username_token</span><span class="keyword">-&gt;</span><span class="default">UsernameToken </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$auth</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$security_sv </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$username_token</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$security_sv</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
}<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
and with your SoapClient do :<br />
<br />
<span class="default">&lt;?php<br />
$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"<a href="http://host/path" rel="nofollow" target="_blank">http://host/path</a>"</span><span class="keyword">);<br />
</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__setSoapHeaders</span><span class="keyword">(Array(new </span><span class="default">WsseAuthHeader</span><span class="keyword">(</span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"pass"</span><span class="keyword">)));<br />
</span><span class="default">?&gt;<br />
</span><br />
works for me. based on a stackoverlfow post which only did the username and password, not the nonce and the timestamp</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114252""></a>
  <div class="note">
   <strong class="user">michael dot arnauts at gmail dot com</strong>
   <a href="#114252" class="date">29-Jan-2014 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This doesn't seem to be documented, but when you want to use compression for your outgoing requests, you have to OR with the compression level:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"some.wsdl"</span><span class="keyword">, <br />
&nbsp; array(</span><span class="string">'compression' </span><span class="keyword">=&gt; </span><span class="default">SOAP_COMPRESSION_ACCEPT </span><span class="keyword">| </span><span class="default">SOAP_COMPRESSION_GZIP </span><span class="keyword">| </span><span class="default">9</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
This can be really usefull if you want to send large amounts of data.<br />
<br />
Source: https://bugs.php.net/bug.php?id=36283</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112970""></a>
  <div class="note">
   <strong class="user">tolean dot dj at gmail dot com</strong>
   <a href="#112970" class="date">13-Aug-2013 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function for easier debugging:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">soapDebug</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">){<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$requestHeaders </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastRequestHeaders</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$request </span><span class="keyword">= </span><span class="default">prettyXml</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastRequest</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$responseHeaders </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastResponseHeaders</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">prettyXml</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastResponse</span><span class="keyword">());<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;code&gt;' </span><span class="keyword">. </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$requestHeaders</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">)) . </span><span class="string">'&lt;/code&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">highlight_string</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;code&gt;' </span><span class="keyword">. </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$responseHeaders</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">)) . </span><span class="string">'&lt;/code&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">highlight_string</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">, array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'location' </span><span class="keyword">=&gt; </span><span class="string">'<a href="http://sita.local/_mpay/server.php" rel="nofollow" target="_blank">http://sita.local/_mpay/server.php</a>'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'uri' </span><span class="keyword">=&gt; </span><span class="string">'<a href="http://sita.local/_mpay/" rel="nofollow" target="_blank">http://sita.local/_mpay/</a>'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'trace' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />
));<br />
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__soapCall</span><span class="keyword">(</span><span class="string">'getDate'</span><span class="keyword">, array(</span><span class="string">'format' </span><span class="keyword">=&gt; </span><span class="string">'Y-m-d H:i:s'</span><span class="keyword">));<br />
</span><span class="default">soapDebug</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111892""></a>
  <div class="note">
   <strong class="user">pgl at yoyo dot org</strong>
   <a href="#111892" class="date">09-Apr-2013 12:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if libxml_disable_entity_loader() has been called, you cannot specify a WSDL file - you'll get an error that PHP "failed to load external entity".<br />
<br />
To resolve this, add<br />
<br />
<span class="default">&lt;?php<br />
libxml_disable_entity_loader</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Above any calls to instantiate SoapClient.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111682""></a>
  <div class="note">
   <strong class="user">francesco [at] paladinux [dot] net</strong>
   <a href="#111682" class="date">15-Mar-2013 08:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Where you have the problem of <br />
"looks like we got no XML document SoapClient", really the real problem is the xml code from remote server is not clear (after last tag is possible that you have space or other caracter that the your supplier of service have lost :&nbsp; no one is perfect!)<br />
I've read some solution, like here, but you must to know that is possible, that is possible that the remote server don't wrong, and the "surplus" (latin word for added values) is needed.<br />
In particolar with axis Java server, is possible that the configuration of server is needed and the "surplus" is one or more attachments...<br />
The solution is 3:<br />
1) contact your supplier if is possible to remove caracter if is an error (good luck! ;) )<br />
2) use another class like nusoap resolve the problem (but has other problem!)<br />
3) this technical solution:<br />
when call the wsdl be sure that the option trace and exceptions are setted (the first true and the second false)<br />
<br />
<span class="default">&lt;?php<br />
$SoapClient </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">NULL</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
....<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'trace'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'exceptions'&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
</span><span class="default">?&gt;<br />
</span>(if you don't do that you can't use the __getLastResponse)<br />
<br />
Now You can do the request and use __getLastResponse() to obtain all the part..<br />
<span class="default">&lt;?php<br />
$result&nbsp; </span><span class="keyword">= </span><span class="default">$SoapClient </span><span class="keyword">-&gt; </span><span class="default">problematicCall</span><span class="keyword">(</span><span class="default">$par</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
After all&nbsp; you obtain a variable like that:<br />
<br />
-----=_Part_9325_126764118.1363377774664<br />
Content-Type: text/xml; CHARSET=gb2312<br />
Content-Transfer-Encoding: binary<br />
Content-Id: &lt;1C06F7FBA057796C5A6185605F9F93E4&gt;<br />
<br />
&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;...etc &gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br />
<br />
&amp;lt;MESSAGGIO&amp;gt;<br />
&nbsp; &amp;lt;DA&amp;gt;MI&amp;lt;/DA&amp;gt;<br />
&nbsp; &amp;lt;A&amp;gt;PALADINUX&amp;lt;/A&amp;gt;<br />
&nbsp; &amp;lt;ID&amp;gt;12345&amp;lt;/ID&amp;gt;<br />
&nbsp; &amp;lt;TIPODOC&amp;gt;RC&amp;lt;/TIPODOC&amp;gt;<br />
&nbsp; &amp;lt;RISPOSTA&amp;gt;<br />
&amp;lt;/MESSAGGIO&amp;gt;<br />
&lt;/rxproblematicCallReturn&gt;&lt;/ns1:rxCatalogoMaterialiResponse&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br />
------=_Part_9325_126764118.1234567890123<br />
Content-Type: application/zip<br />
Content-Transfer-Encoding: binary<br />
Content-Id: &lt;43E91F7E7PALADINUXE07BF041A7BAC9&gt;<br />
-------------------------<br />
<br />
Is easy understand if the added part is needed or not!<br />
Now you can explode all the part and parse!<br />
<br />
Hope this can help you.See ya in the cyberspace!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106393""></a>
  <div class="note">
   <strong class="user">chris at phblock dot atNoSpam</strong>
   <a href="#106393" class="date">04-Nov-2011 05:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this is the syntax of typemap (found at <a href="http://svn.php.net/viewvc/php/php-src/trunk/ext/soap/tests/typemap012.phpt?view=markup" rel="nofollow" target="_blank">http://svn.php.net/viewvc/php/php-src/trunk/ext/soap/tests/typemap012.phpt?view=markup</a>)<br />
<span class="default">&lt;?php<br />
$options</span><span class="keyword">=Array(<br />
</span><span class="string">'typemap' </span><span class="keyword">=&gt; array(<br />
array(</span><span class="string">"type_ns"&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"<a href="http://schemas.nothing.com" rel="nofollow" target="_blank">http://schemas.nothing.com</a>"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"type_name" </span><span class="keyword">=&gt; </span><span class="string">"soap"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"to_xml"&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"some_funktion_name"</span><span class="keyword">)<br />
));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104177""></a>
  <div class="note">
   <strong class="user">willem dot stuursma at hyves dot nl</strong>
   <a href="#104177" class="date">30-May-2011 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use classes in a different namespace in your classmap, just use the backslash in the the target class name.<br />
<br />
Example:<br />
<span class="default">&lt;?php<br />
$classmap </span><span class="keyword">= array(</span><span class="string">'result' </span><span class="keyword">=&gt; </span><span class="string">'MyNamespace\\Result'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You need to specify the backslash twice because it is the escape character in strings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103305""></a>
  <div class="note">
   <strong class="user">simonlang at gmx dot ch</strong>
   <a href="#103305" class="date">06-Apr-2011 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example for a soap client with HTTP authentication over a proxy:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">new </span><span class="default">SoapClient</span><span class="keyword">(
<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'service.wsdl'</span><span class="keyword">,
<br />
&nbsp;&nbsp;&nbsp; array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Stuff for development.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'trace' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'exceptions' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'cache_wsdl' </span><span class="keyword">=&gt; </span><span class="default">WSDL_CACHE_NONE</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'features' </span><span class="keyword">=&gt; </span><span class="default">SOAP_SINGLE_ELEMENT_ARRAYS</span><span class="keyword">,
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Auth credentials for the SOAP request.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="string">'username'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="string">'password'</span><span class="keyword">,
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Proxy url.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'proxy_host' </span><span class="keyword">=&gt; </span><span class="string">'example.com'</span><span class="keyword">, </span><span class="comment">// Do not add the schema here (http or https). It won't work.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'proxy_port' </span><span class="keyword">=&gt; </span><span class="default">44300</span><span class="keyword">,
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Auth credentials for the proxy.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'proxy_login' </span><span class="keyword">=&gt; </span><span class="default">NULL</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'proxy_password' </span><span class="keyword">=&gt; </span><span class="default">NULL</span><span class="keyword">,
<br />
&nbsp;&nbsp;&nbsp; )
<br />
);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Providing an URL to a WSDL file on the remote server (which as well is protected with HTTP authentication) didn't work. I downloaded the WSDL and stored it on the local server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101835""></a>
  <div class="note">
   <strong class="user">Asaf Meller</strong>
   <a href="#101835" class="date">13-Jan-2011 05:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a full working php .net soap configuration :
<br />
notes
<br />
1. web.config on .net server must work with basichttp binding.
<br />
2. paramaters to soap functions must be passed as :
<br />
array ('parm1_name'=&gt;'parm1_value',
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; 'parm2_name'=&gt;'parm2_value'...)
<br />

<br />
<span class="default">&lt;?php
<br />
header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">);
<br />

<br />
try { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$options </span><span class="keyword">= array( 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'soap_version'</span><span class="keyword">=&gt;</span><span class="default">SOAP_1_1</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'exceptions'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'trace'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'cache_wsdl'</span><span class="keyword">=&gt;</span><span class="default">WSDL_CACHE_NONE 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">'<a href="http://www.example.com/end_point.wsdl" rel="nofollow" target="_blank">http://www.example.com/end_point.wsdl</a>'</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Note where 'Get' and 'request' tags are in the XML 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} catch (</span><span class="default">Exception $e</span><span class="keyword">) { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;h2&gt;Exception Error!&lt;/h2&gt;"</span><span class="keyword">; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } 
<br />

<br />
echo </span><span class="string">'running HelloWorld :'</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;
<br />
&nbsp;try {
<br />
&nbsp;&nbsp; </span><span class="default">$response</span><span class="keyword">=</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">HelloWorld</span><span class="keyword">();
<br />
&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; 
<br />
} 
<br />
catch (</span><span class="default">Exception $e</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Caught exception: '</span><span class="keyword">,&nbsp; </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(), </span><span class="string">"\n"</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
good luck !
<br />
Asaf.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101491""></a>
  <div class="note">
   <strong class="user">tatupheba at gmail dot com</strong>
   <a href="#101491" class="date">20-Dec-2010 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello folks!<br />
<br />
A hint for developers:<br />
<br />
When programming some soap server set the "soap.wsdl_cache_enabled" directive in php.ini file to 0:<br />
<br />
soap.wsdl_cache_enabled=0<br />
<br />
Otherwise it will give a bunch of strange errors saying that your wsdl is incorrect or is missing.<br />
<br />
Doing that will save you from a lot of useless pain.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100292""></a>
  <div class="note">
   <strong class="user">titan at phpdevshell dot org</strong>
   <a href="#100292" class="date">06-Oct-2010 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that if you receive a return error : 'Object reference not set to an instance of an object.'. This could be due to something as simple as passing the incorrect parameters. When you look at this XML:
<br />

<br />
&nbsp;&nbsp;&nbsp; &lt;Get xmlns="<a href="http://example.com" rel="nofollow" target="_blank">http://example.com</a>"&gt;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; &lt;request&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;CustomerId&gt;string&lt;/CustomerId&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;From&gt;dateTime&lt;/From&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;To&gt;dateTime&lt;/To&gt;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; &lt;/request&gt;
<br />
&nbsp;&nbsp;&nbsp; &lt;/Get&gt;
<br />

<br />
Your code should look something like this:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">try {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$options </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'soap_version'</span><span class="keyword">=&gt;</span><span class="default">SOAP_1_2</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'exceptions'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'trace'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'cache_wsdl'</span><span class="keyword">=&gt;</span><span class="default">WSDL_CACHE_NONE
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">'<a href="http://example.com/doc.asmx?WSDL" rel="nofollow" target="_blank">http://example.com/doc.asmx?WSDL</a>'</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);
<br />
</span><span class="comment">// Note where 'Get' and 'request' tags are in the XML
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Get</span><span class="keyword">(array(</span><span class="string">'request'</span><span class="keyword">=&gt;array(</span><span class="string">'CustomerId'</span><span class="keyword">=&gt;</span><span class="string">'1234'</span><span class="keyword">)));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } catch (</span><span class="default">Exception $e</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;h2&gt;Exception Error!&lt;/h2&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
</span><span class="default">$results </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Get</span><span class="keyword">(array(</span><span class="string">'request'</span><span class="keyword">=&gt;array(</span><span class="string">'CustomerId'</span><span class="keyword">=&gt;</span><span class="string">'842115'</span><span class="keyword">)));
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98658""></a>
  <div class="note">
   <strong class="user">marcovtwout at hotmail dot com</strong>
   <a href="#98658" class="date">29-Jun-2010 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your WSDL file containts a parameter with a base64Binary type, you should not use base64_encode() when passing along your soap vars. When doing the request, the SOAP library automatically base64 encodes your data, so otherwise you'll be encoding it twice.<br />
<br />
WSDL snipplet:<br />
&lt;element name="content" type="base64Binary" xmime:expectedContentTypes="*/*"/&gt;<br />
<br />
<span class="default">&lt;?php<br />
$string </span><span class="keyword">= </span><span class="string">'data_you_want_to_send___like_xml_in_soap'</span><span class="keyword">;<br />
</span><span class="default">$soap_data </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">//'content' =&gt; base64_encode($string ) // don't do this<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$string </span><span class="comment">//do this<br />
</span><span class="keyword">);<br />
</span><span class="default">$response </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Send</span><span class="keyword">(</span><span class="default">$soap_data</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98613""></a>
  <div class="note">
   <strong class="user">marcovtwout at hotmail dot com</strong>
   <a href="#98613" class="date">26-Jun-2010 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Being new to SOAP, I was searching for a while to find out why my message was getting a response in soapUI, but not with my php code. The specific service I was addressing gives a HTTP 202 Accepted on success (no response), but returns a SOAP message on errors.<br />
<br />
Situation:<br />
Using an (authenticated) client connection, and a WDSL file, SOAP calls with type "One-Way" don't give a response header, even though a response is expected.<br />
<br />
Solution:<br />
When calling the client constructor, set SOAP_WAIT_ONE_WAY_CALLS in the $options['features'].</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98357""></a>
  <div class="note">
   <strong class="user">tim at tdinternet dot com</strong>
   <a href="#98357" class="date">10-Jun-2010 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.2.11 seems to not be very picky about the correctness of a WSDL.<br />
<br />
Other SOAP clients were complaining about schema and namespace issues, while PHP's SoapClient worked completely fine.&nbsp; Fixing those issues for the other clients however broke PHP's SoapClient to the point where objects being passed to the SOAP method were becoming empty arrays on the server side.<br />
<br />
Lesson learned:&nbsp; some elements were being prefixed with xsd: and others were not -- make absolutely sure your WSDL is correct and consistent (I'm using a tweaked WSDL_Gen.php).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98346""></a>
  <div class="note">
   <strong class="user">james dot ellis at gmail dot com</strong>
   <a href="#98346" class="date">09-Jun-2010 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having troubles getting responses from a Coldfusion SOAP server, with no obvious issues in the SoapClient used.<br />
<br />
Eventually I found that the server was only accepting SOAP 1.1 requests and not 1.2. Not sure if this is&nbsp; a system wide Coldfusion setting but if you hit the same wall, try setting the SoapClient option "soap_version" to the constant SOAP_1_1 (which is the default but mine was defaulting to 1.2 as the client was being reused for another service)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98326""></a>
  <div class="note">
   <strong class="user">ajcartmell at fonant dot com</strong>
   <a href="#98326" class="date">09-Jun-2010 03:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There seems to be a problem with specifying empty strings for proxy_host and proxy_port options in recent versions of PHP (from a version later than 5.2.9, and equal to or earlier than 5.2.11).<br />
<br />
Supplying empty string values for proxy_host and proxy_port causes "host not found" type errors: supplying NULL or FALSE works fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97273""></a>
  <div class="note">
   <strong class="user">bhargav dot khatana at gmail dot com</strong>
   <a href="#97273" class="date">11-Apr-2010 11:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It took me longer than a week to figure out how to implement WSSE (Web Service Security) headers in native PHP SOAP. There are no much resource available on this, so thought to add this here for community benefit.
<br />

<br />
Step1: Create two classes to create a structure for WSSE headers
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">clsWSSEAuth </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$Username</span><span class="keyword">; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$Password</span><span class="keyword">;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Username</span><span class="keyword">=</span><span class="default">$username</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Password</span><span class="keyword">=</span><span class="default">$password</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
}
<br />

<br />
class </span><span class="default">clsWSSEToken </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$UsernameToken</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$innerVal</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">UsernameToken </span><span class="keyword">= </span><span class="default">$innerVal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step2: Create Soap Variables for UserName and Password
<br />

<br />
<span class="default">&lt;?php
<br />
$username </span><span class="keyword">= </span><span class="default">1111</span><span class="keyword">;
<br />
</span><span class="default">$password </span><span class="keyword">= </span><span class="default">1111</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//Check with your provider which security name-space they are using.
<br />
</span><span class="default">$strWSSENS </span><span class="keyword">= </span><span class="string">"<a href="http://schemas.xmlsoap.org/ws/2002/07/secext" rel="nofollow" target="_blank">http://schemas.xmlsoap.org/ws/2002/07/secext</a>"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$objSoapVarUser </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br />
</span><span class="default">$objSoapVarPass </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step3: Create Object for Auth Class and pass in soap var
<br />

<br />
<span class="default">&lt;?php
<br />
$objWSSEAuth </span><span class="keyword">= new </span><span class="default">clsWSSEAuth</span><span class="keyword">(</span><span class="default">$objSoapVarUser</span><span class="keyword">, </span><span class="default">$objSoapVarPass</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step4: Create SoapVar out of object of Auth class
<br />

<br />
<span class="default">&lt;?php
<br />
$objSoapVarWSSEAuth </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objWSSEAuth</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step5: Create object for Token Class
<br />

<br />
<span class="default">&lt;?php
<br />
$objWSSEToken </span><span class="keyword">= new </span><span class="default">clsWSSEToken</span><span class="keyword">(</span><span class="default">$objSoapVarWSSEAuth</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step6: Create SoapVar out of object of Token class
<br />

<br />
<span class="default">&lt;?php
<br />
$objSoapVarWSSEToken </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objWSSEToken</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step7: Create SoapVar for 'Security' node
<br />

<br />
<span class="default">&lt;?php
<br />
$objSoapVarHeaderVal</span><span class="keyword">=new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objSoapVarWSSEToken</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step8: Create header object out of security soapvar
<br />

<br />
<span class="default">&lt;?php
<br />
$objSoapVarWSSEHeader </span><span class="keyword">= new </span><span class="default">SoapHeader</span><span class="keyword">(</span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$objSoapVarHeaderVal</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">, </span><span class="string">'<a href="http://abce.com" rel="nofollow" target="_blank">http://abce.com</a>'</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Third parameter here makes 'mustUnderstand=1
<br />
//Forth parameter generates 'actor="<a href="http://abce.com" rel="nofollow" target="_blank">http://abce.com</a>"'
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step9: Create object of Soap Client
<br />

<br />
<span class="default">&lt;?php
<br />
$objClient </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$WSDL</span><span class="keyword">, </span><span class="default">$arrOptions</span><span class="keyword">); 
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step10: Set headers for soapclient object
<br />

<br />
<span class="default">&lt;?php
<br />
$objClient</span><span class="keyword">-&gt;</span><span class="default">__setSoapHeaders</span><span class="keyword">(array(</span><span class="default">$objSoapVarWSSEHeader</span><span class="keyword">));
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Step 11: Final call to method
<br />

<br />
<span class="default">&lt;?php
<br />
$objResponse </span><span class="keyword">= </span><span class="default">$objClient</span><span class="keyword">-&gt;</span><span class="default">__soapCall</span><span class="keyword">(</span><span class="default">$strMethod</span><span class="keyword">, </span><span class="default">$requestPayloadString</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97029""></a>
  <div class="note">
   <strong class="user">meltir at meltir dot com</strong>
   <a href="#97029" class="date">29-Mar-2010 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To those fighting with NTLM authenticated proxy servers, here's a solution I'm using atm:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* A child of SoapClient with support for ntlm proxy authentication
<br />
&nbsp;* 
<br />
&nbsp;* @author Meltir &lt;meltir@meltir.com&gt;
<br />
&nbsp;*
<br />
&nbsp;*/
<br />
</span><span class="keyword">class </span><span class="default">NTLM_SoapClient </span><span class="keyword">extends </span><span class="default">SoapClient </span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">= array()) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_login'</span><span class="keyword">]) || empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_password'</span><span class="keyword">])) throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Login and password required for NTLM authentication!'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_login </span><span class="keyword">= </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_login'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_password </span><span class="keyword">= </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_password'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_host </span><span class="keyword">= (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_host'</span><span class="keyword">]) ? </span><span class="string">'localhost' </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_host'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_port </span><span class="keyword">= (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_port'</span><span class="keyword">]) ? </span><span class="default">8080 </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_port'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * Call a url using curl with ntlm auth
<br />
&nbsp;&nbsp; &nbsp; * 
<br />
&nbsp;&nbsp; &nbsp; * @param string $url
<br />
&nbsp;&nbsp; &nbsp; * @param string $data
<br />
&nbsp;&nbsp; &nbsp; * @return string
<br />
&nbsp;&nbsp; &nbsp; * @throws SoapFault on curl connection error
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected function </span><span class="default">callCurl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, Array(</span><span class="string">"PHP SOAP-NTLM Client"</span><span class="keyword">) );
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXYUSERPWD</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_login</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_password</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXY</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_host</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_port</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXYAUTH</span><span class="keyword">, </span><span class="default">CURLAUTH_NTLM</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (empty(</span><span class="default">$response</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">SoapFault</span><span class="keyword">(</span><span class="string">'CURL error: '</span><span class="keyword">.</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">),</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$response</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">,</span><span class="default">$location</span><span class="keyword">,</span><span class="default">$action</span><span class="keyword">,</span><span class="default">$version</span><span class="keyword">,</span><span class="default">$one_way </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callCurl</span><span class="keyword">(</span><span class="default">$location</span><span class="keyword">,</span><span class="default">$request</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Requires curl and could be extended, but it works for my simple needs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95963""></a>
  <div class="note">
   <strong class="user">eric dot caron at gmail dot com</strong>
   <a href="#95963" class="date">31-Jan-2010 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Though pointed out by jan at bestbytes, and discussed in bug #27777, one common source of the "Parsing WSDL: Couldn't find &lt;definitions&gt;" error is from trying to access a WSDL that is protected by HTTP authentication. Passing the login/password in the 2nd parameter doesn't always work; so if you encounter this error message and are trying to access a protected WSDL file, try passing the username and password in with the first parameter.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95576""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#95576" class="date">10-Jan-2010 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had to struggle with a rather strange behavior when trying to consume standard Parlay X web services with no success. However, I found a remedy to my problem.<br />
<br />
The problem which I faced was about an erroneous invalid HTTP basic authentication request sent to the web service. Although I was sending the right credentials, I was getting an authentication error. It turns out that PHP was sending HTTP requests to another endpoint which is not exposed directly through the web service and that end point does not require authentication. <br />
<br />
My remedy for that issue was by using this simple lines in the example of using sendSms Paraly-X method.<br />
<br />
First, creating a soap client without any HTTP authentication options: <br />
<br />
<span class="default">&lt;?php<br />
$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
The above request will cache the wsdl in the /tmp directory. Immediately after this construction we create another soap client, this time with HTTP authentication options:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">, array(</span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="string">"griffin"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'password'&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"password"</span><span class="keyword">));<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Error:sendSms: %s\n"</span><span class="keyword">,</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">__toString</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
} <br />
</span><span class="default">?&gt;<br />
</span><br />
Now it should work without any problem. Without the second call, PHP will call sendSms without credentials resulting in a failed attempt due to missing authentication information. I found this procedure to be the simplest.<br />
<br />
This process should be done every time the cached wsdl expires, or simply a one can increase the time-to-live for the cached wsdl from php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95085""></a>
  <div class="note">
   <strong class="user">jon dot gilbert at net-entwicklung dot de</strong>
   <a href="#95085" class="date">12-Dec-2009 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that creating a soap client for an invalid URL (you do test what happens, when a service is not available, right?) usually throws an exception which can be caught with try..catch. However, if xdebug is active you will get a fatal error, which obviously cannot be caught.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94151""></a>
  <div class="note">
   <strong class="user">sloloem at gmail dot com</strong>
   <a href="#94151" class="date">19-Oct-2009 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had an issue figuring out the use of classmap that took me quite a while to figure out.&nbsp; I was assuming the WSDL type the docs were referring to was the name of the element being returned in the SOAP, so like,<br />
&lt;ns1:node id="8675309" /&gt;<br />
<br />
and I was wondering why mapping<br />
'classmap'=&gt;array('node'=&gt;'MyNode')<br />
<br />
did nothing.<br />
That's because in my WSDL I defined node as:<br />
<br />
&lt;xsd:element name="node" type="tns:nodeType" /&gt;<br />
<br />
The classmap I needed was:<br />
'classmap'=&gt;array('nodeType'=&gt;'MyNode')<br />
<br />
I was able to find the type names using SoapClient-&gt;__getTypes()<br />
Later, I realized where I could look inside the WSDL for the typename I needed.<br />
<br />
I dunno if I missed something painfully obvious but maybe this can clear up some of the docs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90725""></a>
  <div class="note">
   <strong class="user">Jon</strong>
   <a href="#90725" class="date">06-May-2009 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We've had some problems using SoapClient connecting to an external server via Microsoft ISA (presently v.2006 but this may apply to other versions too). We supply the proxy_host, proxy_port, proxy_login and proxy_password but the ISA server reports the login in its logs as "anonymous".<br />
<br />
Our sysadmin believes this is because PHP is not supplying NTLN information (Windows security protocol) in the correct format (and whether it should work with proprietary proxies is of course another debate). We'd tried "username", "DOMAIN\username" to no effect. The solution is to add an exception in the ISA server for the target hostname/IP; null can then be supplied for proxy_login and proxy_password and the connection should then work as expected.<br />
<br />
On a slightly related note, if you are having problems make sure the port number is supplied as an integer. Some versions of PHP will not use the proxy with SoapClient if the port number is supplied as a string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88902""></a>
  <div class="note">
   <strong class="user">jan at bestbytes dot de</strong>
   <a href="#88902" class="date">12-Feb-2009 07:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You CAN get a wsdl, if basic authentication is required:<br />
<br />
<span class="default">&lt;?php <br />
<br />
$login </span><span class="keyword">= </span><span class="string">'bert'</span><span class="keyword">;<br />
</span><span class="default">$password </span><span class="keyword">= </span><span class="string">'berts password'</span><span class="keyword">;<br />
<br />
</span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'<a href="http://" rel="nofollow" target="_blank">http://</a>' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$login</span><span class="keyword">) . </span><span class="string">':' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">) . </span><span class="string">'@www.server.com/path/to/wsdl'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="default">$login</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="default">$password<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">)<br />
);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86908""></a>
  <div class="note">
   <strong class="user">info at nicksilvestro dot net</strong>
   <a href="#86908" class="date">09-Nov-2008 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone having trouble with ArrayOf_xsd_string and getting an error similar to 'No deserializer defined for array type {<a href="http://www.w3.org/2001/XMLSchema}string" rel="nofollow" target="_blank">http://www.w3.org/2001/XMLSchema}string</a>'<br />
Try using the 'features' param, set to SOAP_USE_XSI_ARRAY_TYPE - this makes sure the correct deserializer is used.<br />
<br />
eg, <br />
<span class="default">&lt;?php<br />
$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"some.wsdl"</span><span class="keyword">, array(</span><span class="string">'features' </span><span class="keyword">=&gt; </span><span class="default">SOAP_USE_XSI_ARRAY_TYPE</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86004""></a>
  <div class="note">
   <strong class="user">sniper</strong>
   <a href="#86004" class="date">27-Sep-2008 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i was looking for a good example and couldnt find one,<br />
finally found it somewhere(forgot where) i think this is<br />
the best example to make a soap request with multiple params<br />
&nbsp;&nbsp; <br />
$params-&gt;AWSAccessKeyId = AMAZON_API_KEY;<br />
$params-&gt;Request-&gt;SearchIndex = 'Books';<br />
$params-&gt;Request-&gt;Keywords = 'php5 oop';<br />
<br />
$amazon = new SoapClient('<a href="http://webservices.amazon.com" rel="nofollow" target="_blank">http://webservices.amazon.com</a><br />
/AWSECommerceService/AWSECommerceService.wsdl');<br />
$result = $amazon-&gt;itemSearch($params);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85757""></a>
  <div class="note">
   <strong class="user">taras dot dot dot di at gmail dot com</strong>
   <a href="#85757" class="date">16-Sep-2008 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This took me a while to figure out.<br />
<br />
As described at the bottom of here: <a href="http://bugs.php.net/bug.php?id=38703" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=38703</a><br />
<br />
having xdebug may interfere with the constructor throwing exceptions</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85648""></a>
  <div class="note">
   <strong class="user">alex on reutone comma com</strong>
   <a href="#85648" class="date">10-Sep-2008 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To connect PHP SOAP to MS SOAP (CRM/EXCHANGE/...) I have created some classes using the explanation below and in other places.<br />
www.reutone.com/heb/articles.php?instance_id=62&amp;actions=show&amp;id=521</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83718""></a>
  <div class="note">
   <strong class="user">david at globulebleu dot com</strong>
   <a href="#83718" class="date">09-Jun-2008 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using classmap option to map the SOAP results to a class, the constructor<br />
of the object you've mapped to is not called. <br />
<br />
$client = new SoapClient("url_to_wsdl", <br />
&nbsp;&nbsp; array('classmap' =&gt; array('contact' =&gt; "Contact"));<br />
<br />
$params = array("1");<br />
<br />
$contact = $client-&gt;__soapCall("get_contact", $params);<br />
<br />
Expected result:<br />
<br />
A contact object that has properties initialized (i.e. db connections,<br />
....).<br />
<br />
Actual result:<br />
<br />
A contact object without the properties.<br />
<br />
Thanks for your help.<br />
<br />
David Georges.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83474""></a>
  <div class="note">
   <strong class="user">Anno v. Heimburg</strong>
   <a href="#83474" class="date">27-May-2008 10:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&gt; When using HTTP basic authentication, PHP will only send<br />
&gt; the credentials when invoking the service, not when<br />
&gt; fetching the WSDL. <br />
<br />
The same goes for using an SSL client certficate, the SoapClient will only present the certificate on the actual remote call, not when getting the WSDL. The workaround is the same as above. HttpRequest works as expected.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82876""></a>
  <div class="note">
   <strong class="user">cw at netresearch dot de</strong>
   <a href="#82876" class="date">30-Apr-2008 01:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The "cache_wsdl" option takes constants like WSDL_CACHE_NONE or WSDL_CACHE_DISK that are listed on the "SOAP constants" page -&gt; /manual/en/soap.constants.php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76269""></a>
  <div class="note">
   <strong class="user">giosh94mhz</strong>
   <a href="#76269" class="date">08-Jul-2007 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Oops!<br />
<br />
I have written the wrong exception message in my last post.<br />
<br />
The correct exception is:<br />
<br />
SoapFault exception: [Client] looks like we got no XML document in &lt;document&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73082""></a>
  <div class="note">
   <strong class="user">lsmith at php dot net</strong>
   <a href="#73082" class="date">08-Feb-2007 07:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted in the bug report <a href="http://bugs.php.net/bug.php?id=36226, it is considered a feature that sequences with a single element do not come out as arrays. To override this " rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=36226, it is considered a feature that sequences with a single element do not come out as arrays. To override this </a>"feature" you can do the following:<br />
<br />
$x = new SoapClient($wsdl, array('features' =&gt;<br />
SOAP_SINGLE_ELEMENT_ARRAYS));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71477""></a>
  <div class="note">
   <strong class="user">matt_schiros at academicsuperstore dot com</strong>
   <a href="#71477" class="date">30-Nov-2006 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using classmap to map the SOAP results to a class, the constructor of the object you've mapped to is _not_ called.&nbsp; This applies to the PHP5 __construct() and the PHP4 ClassName() constructors.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62471""></a>
  <div class="note">
   <strong class="user">Marius Mathiesen</strong>
   <a href="#62471" class="date">01-Mar-2006 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I kept having a problem using an HTTP proxy with SOAP. The proxy_port parameter has to be an integer, ie. "proxy_port"=&gt;"80" won't work, you'll have to use "proxy_port"=&gt;80.<br />
<br />
HTH,<br />
Marius</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60004""></a>
  <div class="note">
   <strong class="user">php at sowen dot de</strong>
   <a href="#60004" class="date">22-Dec-2005 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're using CLI and there are multiple IP addresses available for outgoing SOAP-requests, try this "secret" to set outgoing IP:<br />
<br />
e.g. for local IP 10.1.4.71:<br />
<br />
$opts = array('socket' =&gt; array('bindto' =&gt; '10.1.4.71:0'));<br />
$context = stream_context_create($opts);<br />
$client&nbsp; = new SoapClient(null, array('location'=&gt;'<a href="http://..." rel="nofollow" target="_blank">http://...</a>','uri' =&gt; '...','stream_context' =&gt; $context));<br />
<br />
You can also set other options for the stream context, please refer to this page:<br />
<br />
Appendix M: <a href="http://www.php.net/manual/en/wrappers.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/wrappers.php</a><br />
<br />
Bye,<br />
&nbsp;&nbsp; Nils Sowen</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56256""></a>
  <div class="note">
   <strong class="user">jared at ws-db dot com</strong>
   <a href="#56256" class="date">28-Aug-2005 02:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you connect to a SoapServer, that has been created with session persistence, you can access the server's session id via SoapClient-&gt;_cookies[&lt;session_id_name&gt;][0]. This property becomes available after your first client method call.<br />
<br />
I have only tested this with session.use_cookies=1.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55744""></a>
  <div class="note">
   <strong class="user">Arjan van Bentem</strong>
   <a href="#55744" class="date">11-Aug-2005 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using HTTP basic authentication, PHP will only send the credentials when invoking the service, not when fetching the WSDL. <br />
<br />
To solve this, one needs to fetch the WSDL manually (or using PHP, of course!) and store it on the file system. Obviously, the first parameter for SoapClient(..) then needs to refer to that local copy.<br />
<br />
Alternatively, the user annotations at <a href="http://nl3.php.net/manual/en/ref.soap.php state that one could encode the login and password into the URL as well." rel="nofollow" target="_blank">http://nl3.php.net/manual/en/ref.soap.php state that one could encode the login and password into the URL as well.</a><br />
<br />
See <a href="http://bugs.php.net/bug.php?id=27777" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=27777</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54657""></a>
  <div class="note">
   <strong class="user">Jim Plush</strong>
   <a href="#54657" class="date">11-Jul-2005 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of version 5.0.4 you can now dynamically change your location even if you're using a wsdl<br />
<br />
<span class="default">&lt;?php<br />
<br />
$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"<a href="http://some.host.net/wsdl/somefile.wsdl" rel="nofollow" target="_blank">http://some.host.net/wsdl/somefile.wsdl</a>"</span><span class="keyword">,array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"location" </span><span class="keyword">=&gt; </span><span class="string">'myurl.com'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
notice you can now use the "location" key. <br />
This means you can have the same wsdl file not define a location until runtime which is great if you have a development test site or if you distribute your files to other companies. <br />
Prior to this change you would have to ship a custom wsdl file to every client you had with their location hardcoded.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50621""></a>
  <div class="note">
   <strong class="user">Brian Grayless</strong>
   <a href="#50621" class="date">04-Mar-2005 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using a WSDL file is the way to go, however, for my particular application, the LOCATION:PORT needed to be dynamic so that my SOAP clients would be able to call a different service based on the client domain.<br />
<br />
If you are using a WSDL, SoapClient() requires a URL direct to an actual URL and does not let you use a PHP file that outputs the dynamic WSDL XML in its stead. So, I ended up making a separate WSDL for each possible service needed and had to maintain them all if the service description changed.<br />
<br />
Finally, after some fiddling, I was able to create a PHP page with the proper Mime type headers so that I could then trick SoapClient() to think that it was being passed a file with a ".wsdl" extension.<br />
<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// filename: wsdl.php<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: application/xml; CHARSET=gb2312'</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename="filename.wsdl"'</span><span class="keyword">);<br />
<br />
</span><span class="default">$wsdl </span><span class="keyword">= </span><span class="string">'path/wsdl_name.wsdl'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// read in file<br />
</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
</span><span class="default">$wsdl_xml </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">));<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
</span><span class="comment">// put code here to replace url and port in xml<br />
<br />
</span><span class="keyword">echo </span><span class="default">$wsdl_xml</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Now, in order to make this work, you can't just call a relative path to the file. I believe it has to go through Apache to properly set the mime type headers, etc... So you would use a full "<a href="http://....." rel="nofollow" target="_blank">http://.....</a>" address as the path to the wsdl.php file.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//... somewhere in your soap client code<br />
<br />
</span><span class="default">$wsdl_loc </span><span class="keyword">= </span><span class="string">"<a href="http://yourdomain.com/wsdl.php" rel="nofollow" target="_blank">http://yourdomain.com/wsdl.php</a>"</span><span class="keyword">;<br />
<br />
</span><span class="default">$soap_client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_loc</span><span class="keyword">, </span><span class="default">$client_param_array</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Another, perhaps not so clean, way of achieving this would be to modify your .htaccess file in the directory where your WSDL file exists to force ".wsdl" files to run through the PHP engine. Add the following to your .htaccess:<br />
<br />
AddType application/x-httpd-php .php .wsdl<br />
<br />
You can then put dynamic PHP code snippets in your *.wsdl files to change whatever values you need to.<br />
<br />
There are pros and cons to each solutions. The Mime solution probably taxes the system more as it has to read the file in every time a soap request is made. The htaccess solution makes it so you have to depend on either a modified .htaccess or Apache conf file.<br />
<br />
Perhaps if you set the "soap.wsdl_cache_enabled", using ini_set(), to 1 (default), the caching will make it so it doesn't read the file every time for the Mime solution.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
