<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>解析一个配置文件</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.move-uploaded-file.html">? move_uploaded_file</a></li>
      <li style="float: right;"><a href="function.parse-ini-string.html">parse_ini_string ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">文件系统函数</a></li>
    <li>解析一个配置文件</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.parse-ini-file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">parse_ini_file</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">parse_ini_file</span> &mdash; <span class="dc-title">解析一个配置文件</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.parse-ini-file-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>parse_ini_file</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$process_sections</code><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$scanner_mode</code><span class="initializer"> = INI_SCANNER_NORMAL</span></span>
  ]] ) : <span class="type">array</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>parse_ini_file()</strong></span> 载入一个由
   <code class="parameter">filename</code> 指定的 ini
   文件，并将其中的设置作为一个联合数组返回。
  </p>
  <p class="para">
   ini 文件的结构和 <var class="filename">php.ini</var> 的相似。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.parse-ini-file-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       要解析的 ini 文件的文件名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">process_sections</code></dt>

     <dd>

      <p class="para">
       如果将最后的
   <code class="parameter">process_sections</code> 参数设为
   <strong><code>TRUE</code></strong>，将得到一个多维数组，包括了配置文件中每一节的名称和设置。<code class="parameter">process_sections</code>
   的默认值是 <strong><code>FALSE</code></strong>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">scanner_mode</code></dt>

     <dd>

      <p class="para">
       Can either be <strong><code>INI_SCANNER_NORMAL</code></strong> (default) or 
       <strong><code>INI_SCANNER_RAW</code></strong>. If <strong><code>INI_SCANNER_RAW</code></strong> 
       is supplied, then option values will not be parsed.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.parse-ini-file-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时以关联数组 <span class="type"><a href="language.types.array.html" class="type array">array</a></span> 返回设置，失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 
 <div class="refsect1 changelog" id="refsect1-function.parse-ini-file-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
         Added optional <code class="parameter">scanner_mode</code> parameter.
         Single quotes may now be used around variable assignments.
         Hash marks (<em>#</em>) may no longer be used as comments
         and will throw a deprecation warning if used.
       </td>
      </tr>

      <tr>
       <td>5.2.7</td>
       <td>
        On syntax error this function will return <strong><code>FALSE</code></strong> rather than an empty
        array.
       </td>
      </tr>

      <tr>
       <td>5.2.4</td>
       <td>
        由数字组成的键名和小节名会被 PHP 当作<a href="language.types.integer.html" class="link">整数</a>来处理，因此以
   0 开头的数字会被当作八进制而以 0x 开头的会被当作十六进制。
       </td>
      </tr>

      <tr>
       <td>5.0.0</td>
       <td>
        该函数也开始处理选项值内的新行。
       </td>
      </tr>

      <tr>
       <td>4.2.1</td>
       <td>
        本函数也开始受到<a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">安全模式</a>和
    <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a> 的影响。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.parse-ini-file-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2860">
    <p><strong>Example #1 <var class="filename">sample.ini</var> 的内容</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
; This is a sample configuration file
; Comments start with &#039;;&#039;, as in php.ini

[first_section]
one = 1
five = 5
animal = BIRD

[second_section]
path = &quot;/usr/local/bin&quot;
URL = &quot;http://www.example.com/~username&quot;

[third_section]
phpversion[] = &quot;5.0&quot;
phpversion[] = &quot;5.1&quot;
phpversion[] = &quot;5.2&quot;
phpversion[] = &quot;5.3&quot;
</pre></div>
    </div>

   </div>
   <div class="example" id="example-2861">
    <p><strong>Example #2 <span class="function"><strong>parse_ini_file()</strong></span> 例子</strong></p>
    <div class="example-contents"><p>
      <a href="language.constants.html" class="link">常量</a>也可以在 ini
   文件中被解析，因此如果在运行 <span class="function"><strong>parse_ini_file()</strong></span>
   之前定义了常量作为 ini 的值，将会被集成到结果中去。只有 ini
   的值会被求值。例如：
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />define</span><span style="color: #007700">(</span><span style="color: #DD0000">'BIRD'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Dodo&nbsp;bird'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;without&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;with&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [one] =&gt; 1
    [five] =&gt; 5
    [animal] =&gt; Dodo bird
    [path] =&gt; /usr/local/bin
    [URL] =&gt; http://www.example.com/~username
    [phpversion] =&gt; Array
        (
            [0] =&gt; 5.0
            [1] =&gt; 5.1
            [2] =&gt; 5.2
            [3] =&gt; 5.3
        )

)
Array
(
    [first_section] =&gt; Array
        (
            [one] =&gt; 1
            [five] =&gt; 5
            [animal] =&gt; Dodo bird
        )

    [second_section] =&gt; Array
        (
            [path] =&gt; /usr/local/bin
            [URL] =&gt; http://www.example.com/~username
        )

    [third_section] =&gt; Array
        (
            [phpversion] =&gt; Array
                (
                    [0] =&gt; 5.0
                    [1] =&gt; 5.1
                    [2] =&gt; 5.2
                    [3] =&gt; 5.3
                )

        )

)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2862">
    <p><strong>Example #3 <span class="function"><strong>parse_ini_file()</strong></span> parsing a php.ini file</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;A&nbsp;simple&nbsp;function&nbsp;used&nbsp;for&nbsp;comparing&nbsp;the&nbsp;results&nbsp;below<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$expression</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">$expression&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">'Yes'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'No'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Get&nbsp;the&nbsp;path&nbsp;to&nbsp;php.ini&nbsp;using&nbsp;the&nbsp;php_ini_loaded_file()&nbsp;<br />//&nbsp;function&nbsp;available&nbsp;as&nbsp;of&nbsp;PHP&nbsp;5.2.4<br /></span><span style="color: #0000BB">$ini_path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">php_ini_loaded_file</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;php.ini<br /></span><span style="color: #0000BB">$ini&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_path</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Print&nbsp;and&nbsp;compare&nbsp;the&nbsp;values,&nbsp;note&nbsp;that&nbsp;using&nbsp;get_cfg_var()<br />//&nbsp;will&nbsp;give&nbsp;the&nbsp;same&nbsp;results&nbsp;for&nbsp;parsed&nbsp;and&nbsp;loaded&nbsp;here<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'(parsed)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini</span><span style="color: #007700">[</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">])&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #DD0000">'(loaded)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">get_cfg_var</span><span style="color: #007700">(</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
(parsed) magic_quotes_gpc = Yes
(loaded) magic_quotes_gpc = Yes
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.parse-ini-file-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    本函数和 <var class="filename">php.ini</var>
    文件没有关系，该文件在运行脚本时就已经处理过了。本函数可以用来读取你自己的应用程序的配置文件。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    如果 ini 文件中的值包含任何非字母数字的字符，需要将其括在双引号中（&quot;）。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    有些保留字不能作为 ini 文件中的键名，包括：null，yes，no，true 和 false。值为
    null，no 和 false 等效于 &quot;&quot;，值为 yes 和 true 等效于 &quot;1&quot;。字符
    <em>{}|&amp;~![()&quot;</em> 也不能用在键名的任何地方，而且这些字符在选项值中有着特殊的意义。
   </span>
  </p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.parse-ini-file-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.parse-ini-string.html" class="function" rel="rdfs-seeAlso">parse_ini_string()</a> - 解析配置字符串</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="122946""></a>
  <div class="note">
   <strong class="user">Rubn Martnez</strong>
   <a href="#122946" class="date">15-Jul-2018 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The parse_ini_file function does have trouble loading valid Windows ini files like, for example, nternet shortcuts (.url files).<br />
<br />
This is due to the function reading the URLs as a value, and failing when it finds that valid URL characters like '=' appear unescaped or the value unquoted as a whole. Since Windows does not escape them anyway, the solution is to scan it in raw mode, where it will read unparsed the value after the first '='. Since = only appears in URLs with parameters, this mistake may is not be obvious at a first glance.<br />
<br />
An example<br />
<br />
<span class="default">&lt;?php<br />
<br />
$links </span><span class="keyword">= array();<br />
<br />
</span><span class="comment">// ...<br />
<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">);<br />
foreach( </span><span class="default">$files </span><span class="keyword">as </span><span class="default">$filename </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strToLower</span><span class="keyword">(</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">)) === </span><span class="string">'url'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortcut </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">( </span><span class="default">$directory</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">,&nbsp; </span><span class="default">INI_SCANNER_RAW</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$shortcut </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) die(</span><span class="string">'Syntax Error'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">$shortcut</span><span class="keyword">[</span><span class="string">'InternetShortcut'</span><span class="keyword">][</span><span class="string">'URL'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$links </span><span class="keyword">[]= </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120348""></a>
  <div class="note">
   <strong class="user">info () gaj ! design</strong>
   <a href="#120348" class="date">17-Dec-2016 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Notes on INI files.<br />
<br />
Unless the source code is freely available - and therefore the locations on INI files - there is no need to obfuscate or place INI files below DocumentRoot, as no one will know where they are. Otherwise, the .htaccess (or equivalent) to deny .ini files (or the config directory) is effective at preventing access.<br />
<br />
And placing sensitive data in an INI file is just not a good idea in the first place. They are better off as defines (where, even if in a known location, can not seen):<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'DB_NAME'</span><span class="keyword">,</span><span class="string">'server_cms'</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'DB_USER'</span><span class="keyword">,</span><span class="string">'server_user'</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'DB_PASS'</span><span class="keyword">,</span><span class="string">'secretword'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Writing an array as an INI file is not so simple, and just wrapping values in double quotes will not always work. Consider:<br />
<br />
key1 = true<br />
key2 = ${PATH}"/foo"<br />
key2a = CONSTANT"/foo"<br />
<br />
Also, "If a value in the ini file contains any non-alphanumeric characters it needs to be enclosed in double-quotes" does not always hold.<br />
<br />
For this works:<br />
<br />
key2b = ${PATH}/foo<br />
<br />
This is valid but fails to convert the constant:<br />
<br />
key2c = CONSTANT/foo<br />
<br />
This does convert the constant, there is just a space after it:<br />
<br />
key2d = CONSTANT /foo<br />
<br />
These characters are OK:<br />
<br />
key3 = ` $ * % # @ { } &lt; &gt; / \ : , . ? + - _<br />
<br />
For example:<br />
<br />
key4 = The # is 100% of &lt;value&gt;.<br />
<br />
And most bitwise operator, negation, logical not and parenthesis characters are used to calculate values:<br />
<br />
key5 = ~1 | (!1 &amp; 3) ^ -1<br />
<br />
Which can be combined with constants and variables:<br />
<br />
key6 = ${SHLVL} | PHP_VERSION &amp; ${display_errors}<br />
<br />
So, only values containing ( ) ! ^ | &amp; ~ - ; = within a string need to be quoted, with either double- or single-quotes. As will strings containing reserved words.<br />
<br />
Also, the concatenation operation is built-in:<br />
<br />
key7 = "foo" 'bar' PHP_VERSION ${OS}<br />
<br />
That result will have spaces before the constant and variable but not between the two quoted words. This eliminates the spaces:<br />
<br />
key7a = "foo" 'bar'PHP_VERSION${OS}<br />
<br />
But, punctuation fools the parsing:<br />
<br />
key7b = "foo" 'bar',PHP_VERSION-${OS}<br />
<br />
That needs to be (with spaces):<br />
<br />
key7c = "foo" 'bar', PHP_VERSION - ${OS}<br />
<br />
Or (without spaces):<br />
<br />
key7d = "foo" 'bar,'PHP_VERSION'-'${OS}<br />
<br />
And, of course, leading and trailing spaces in values are trimmed.<br />
<br />
All of those were tested on PHP 7.0.13 and 5.6.18.<br />
<br />
It would be cool for PHP to support shift and arithmetic operators:<br />
<br />
key8 = (${SHLVL} * 2) &gt;&gt; 1<br />
<br />
And cooler still, all logical operators; perhaps also comparison operators and the execution operator.<br />
<br />
And way cool would be array support:<br />
<br />
key9 = [ 1, 2, 3 ]<br />
<br />
And globals and superglobals:<br />
<br />
key10 = ${_SERVER["PHP_SELF"]}<br />
<br />
Many people make their own INI parsers - I have a few versions - I think I'll try supporting the operators and arrays...<br />
<br />
BUT, a "post parser" can convert such values as key9's and these:<br />
<br />
key8a = '(${SHLVL} * 2) &gt;&gt; 1'<br />
key10a = '${_SERVER["PHP_SELF"]}'<br />
key11 = 'date("Y-m-d")'<br />
<br />
The key9, key10a and key11 values can be converted via eval():<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">eval(</span><span class="string">"\$data['key9'] = </span><span class="keyword">{</span><span class="default">$data</span><span class="keyword">[</span><span class="string">'key9'</span><span class="keyword">]}</span><span class="string">;"</span><span class="keyword">);<br />
eval(</span><span class="string">"\$data['key10a'] = \"</span><span class="keyword">{</span><span class="default">$data</span><span class="keyword">[</span><span class="string">'key10a'</span><span class="keyword">]}</span><span class="string">\";"</span><span class="keyword">);<br />
eval(</span><span class="string">"\$data['key11'] = </span><span class="keyword">{</span><span class="default">$data</span><span class="keyword">[</span><span class="string">'key11'</span><span class="keyword">]}</span><span class="string">;"</span><span class="keyword">);<br />
</span><span class="comment">// example only - the values would have to be "checked" for<br />
// if/how they should be parsed<br />
// only to be used for "admin" only INI files<br />
</span><span class="default">?&gt;<br />
</span><br />
Values like key8's would be slightly trickier but hardly difficult.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120341""></a>
  <div class="note">
   <strong class="user">info () gaj ! design</strong>
   <a href="#120341" class="date">16-Dec-2016 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not mentioned in the documentation, this function acts like include:<br />
<br />
"Files are included based on the file path given or, if none is given, the include_path specified. If the file isn't found in the include_path, include will finally check in the calling script's own directory and the current working directory before failing."<br />
<br />
(At least for PHP 7; have not checked PHP 5.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119543""></a>
  <div class="note">
   <strong class="user">YAPs</strong>
   <a href="#119543" class="date">03-Jul-2016 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function for save ini files<br />
<br />
function array_to_ini($array,$out="")<br />
{<br />
&nbsp;&nbsp;&nbsp; $t="";<br />
&nbsp;&nbsp;&nbsp; $q=false;<br />
&nbsp;&nbsp;&nbsp; foreach($array as $c=&gt;$d)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(is_array($d))$t.=array_to_ini($d,$c);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($c===intval($c))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!empty($out))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $t.="\r\n".$out." = \"".$d."\"";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($q!=2)$q=true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else $t.="\r\n".$d;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $t.="\r\n".$c." = \"".$d."\"";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $q=2;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if($q!=true &amp;&amp; !empty($out)) return "[".$out."]\r\n".$t;<br />
&nbsp;&nbsp;&nbsp; if(!empty($out)) return&nbsp; $t;<br />
&nbsp;&nbsp;&nbsp; return trim($t);<br />
}<br />
<br />
function save_ini_file($array,$file)<br />
{<br />
&nbsp;&nbsp;&nbsp; $a=array_to_ini($array);<br />
&nbsp;&nbsp;&nbsp; $ffl=fopen($file,"w");<br />
&nbsp;&nbsp;&nbsp; fwrite($ffl,$a);<br />
&nbsp;&nbsp;&nbsp; fclose($ffl);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118969""></a>
  <div class="note">
   <strong class="user">dschnepper at box dot com</strong>
   <a href="#118969" class="date">09-Mar-2016 09:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation states:<br />
Characters ?{}|&amp;~!()^" must not be used anywhere in the key and have a special meaning in the value.<br />
<br />
Here's the results of my experiments on what they mean:<br />
<br />
; | is used for bitwise OR<br />
three = 2|3<br />
<br />
; &amp; is used for bitwise AND<br />
four = 6&amp;5<br />
<br />
; ^ is used for bitwise XOR<br />
five = 3^6<br />
<br />
; ~ is used for bitwise negate<br />
negative_two = ~1<br />
<br />
; () is used for grouping<br />
seven = (8|7)&amp;(6|5)<br />
<br />
; ${...} is used for grabbing values from the environment, or previously defined values.<br />
path = ${PATH}<br />
also = ${five}<br />
<br />
; ? I have no guess for<br />
; ! I have no guess for</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118151""></a>
  <div class="note">
   <strong class="user">jbricci at ya-right dot com</strong>
   <a href="#118151" class="date">15-Oct-2015 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This core function won't handle ini key[][] = value(s), (multidimensional arrays), so if you need to support that kind of setup you will need to write your own function. one way to do it is to convert all the key = value(s) to array string [key][][]=value(s), then use parse_str() to convert all those [key][][]=value(s) that way you just read the ini file line by line, instead of doing crazy foreach() loops to handle those (multidimensional arrays) in each section, example...<br />
<br />
ini file...... config.php<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">; </span><span class="default">This is a sample configuration file<br />
</span><span class="keyword">; </span><span class="default">Comments start with </span><span class="string">';'</span><span class="keyword">, as </span><span class="default">in php</span><span class="keyword">.</span><span class="default">ini<br />
<br />
</span><span class="keyword">[</span><span class="default">first_section</span><span class="keyword">]<br />
</span><span class="default">one </span><span class="keyword">= </span><span class="default">1<br />
five </span><span class="keyword">= </span><span class="default">5<br />
animal </span><span class="keyword">= </span><span class="default">BIRD<br />
<br />
</span><span class="keyword">[</span><span class="default">second_section</span><span class="keyword">]<br />
</span><span class="default">path </span><span class="keyword">= </span><span class="string">"/usr/local/bin"<br />
</span><span class="default">URL </span><span class="keyword">= </span><span class="string">"<a href="http://www.example.com/~username" rel="nofollow" target="_blank">http://www.example.com/~username</a>"<br />
<br />
</span><span class="keyword">[</span><span class="default">third_section</span><span class="keyword">]<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.0"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.1"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.2"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.3"<br />
<br />
</span><span class="default">urls</span><span class="keyword">[</span><span class="default">svn</span><span class="keyword">] = </span><span class="string">"<a href="http://svn.php.net" rel="nofollow" target="_blank">http://svn.php.net</a>"<br />
</span><span class="default">urls</span><span class="keyword">[</span><span class="default">git</span><span class="keyword">] = </span><span class="string">"<a href="http://git.php.net" rel="nofollow" target="_blank">http://git.php.net</a>"<br />
<br />
</span><span class="keyword">[</span><span class="default">fourth_section</span><span class="keyword">]<br />
<br />
</span><span class="default">a</span><span class="keyword">[][][] = </span><span class="default">b<br />
a</span><span class="keyword">[][][][] = </span><span class="default">c<br />
a</span><span class="keyword">[</span><span class="default">test_test</span><span class="keyword">][][] = </span><span class="default">d<br />
test</span><span class="keyword">[</span><span class="default">one</span><span class="keyword">][</span><span class="default">two</span><span class="keyword">][</span><span class="default">three</span><span class="keyword">] = </span><span class="default">true<br />
<br />
?&gt;<br />
</span><br />
echo parse_ini_file ( "C:\\services\\www\\docs\\config.php" );<br />
<br />
results in...<br />
<br />
// PHP Warning:&nbsp; syntax error, unexpected TC_SECTION, expecting '=' line 27 -&gt; a[][][] = b<br />
<br />
Here it simple function that handles (multidimensional arrays) without looping each key[][]= value(s)<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">getIni </span><span class="keyword">( </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$sections </span><span class="keyword">= </span><span class="default">FALSE </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array ();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keeper </span><span class="keyword">= array ();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$config </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">( </span><span class="default">$file</span><span class="keyword">, </span><span class="string">'r' </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; while ( ! </span><span class="default">feof </span><span class="keyword">( </span><span class="default">$config </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim </span><span class="keyword">( </span><span class="default">fgets </span><span class="keyword">( </span><span class="default">$config</span><span class="keyword">, </span><span class="default">1024 </span><span class="keyword">) );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= ( </span><span class="default">$line </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">) ? </span><span class="string">' ' </span><span class="keyword">: </span><span class="default">$line</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch ( </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">' '</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'#'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'/'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">';'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'&lt;'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'?'</span><span class="keyword">:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'['</span><span class="keyword">:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$sections </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="string">'config[' </span><span class="keyword">. </span><span class="default">trim </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">) ) . </span><span class="string">']'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="string">'config'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv </span><span class="keyword">= </span><span class="default">array_map </span><span class="keyword">( </span><span class="string">'trim'</span><span class="keyword">, </span><span class="default">explode </span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$line </span><span class="keyword">) );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">str_replace </span><span class="keyword">( </span><span class="string">' '</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">, </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">str_replace </span><span class="keyword">( </span><span class="string">' '</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">, </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ( </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="string">'[' </span><span class="keyword">) ) !== </span><span class="default">FALSE </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">) . </span><span class="string">']' </span><span class="keyword">. </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$pos </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">']'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">strtolower </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">in_array </span><span class="keyword">( </span><span class="default">$bt</span><span class="keyword">, array ( </span><span class="string">'true'</span><span class="keyword">, </span><span class="string">'false'</span><span class="keyword">, </span><span class="string">'on'</span><span class="keyword">, </span><span class="string">'off' </span><span class="keyword">) ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = ( </span><span class="default">$bt </span><span class="keyword">== </span><span class="string">'true' </span><span class="keyword">|| </span><span class="default">$bt </span><span class="keyword">== </span><span class="string">'on' </span><span class="keyword">) ? </span><span class="default">TRUE </span><span class="keyword">: </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keeper</span><span class="keyword">[] = </span><span class="default">$header </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose </span><span class="keyword">( </span><span class="default">$config </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parse_str </span><span class="keyword">( </span><span class="default">implode </span><span class="keyword">( </span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$keeper </span><span class="keyword">), </span><span class="default">$return </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'config'</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// usage...<br />
<br />
</span><span class="default">$sections </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r </span><span class="keyword">( </span><span class="default">$config</span><span class="keyword">-&gt;</span><span class="default">getIni </span><span class="keyword">( </span><span class="string">"C:\\services\\www\\docs\\config.php" </span><span class="keyword">),&nbsp; </span><span class="default">$sections </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114842""></a>
  <div class="note">
   <strong class="user">Rekam</strong>
   <a href="#114842" class="date">13-Apr-2014 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may want, in some very special cases, to parse multi-dimensional array with N levels in your ini file. Something like setting[data][config][debug] = true will result in an error (expected "=").<br />
<br />
Here's a little function to match this, using dots (customizable).<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini_file_multi</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$process_sections </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$scanner_mode </span><span class="keyword">= </span><span class="default">INI_SCANNER_NORMAL</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$explode_str </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$escape_char </span><span class="keyword">= </span><span class="string">"'"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// load ini file the normal way<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$process_sections</span><span class="keyword">, </span><span class="default">$scanner_mode</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$process_sections</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= array(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$section_key </span><span class="keyword">=&gt; </span><span class="default">$section</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// loop inside the section<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$section </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$explode_str</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) !== </span><span class="default">$escape_char</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// key has a dot. Explode on it, then parse each subkeys<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and set value at the right place thanks to references<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sub_keys </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$explode_str</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">=&amp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$sub_keys </span><span class="keyword">as </span><span class="default">$sub_key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">] = [];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">=&amp; </span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// set the value at the right place<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// unset the dotted key, we don't need it anymore<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// we have escaped the key, so we keep dots as they are<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_key </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$escape_char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$new_key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$process_sections</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$data</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The following file:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
[normal]<br />
foo = bar<br />
; use quotes to keep your key as it is<br />
'foo.with.dots' = true<br />
<br />
[array]<br />
foo[] = 1<br />
foo[] = 2<br />
<br />
[dictionary]<br />
foo[debug] = false<br />
foo[path] = /some/path<br />
<br />
[multi]<br />
foo.data.config.debug = true<br />
foo.data.password = 123456<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
will result in:<br />
<span class="default">&lt;?php<br />
parse_ini_file_multi</span><span class="keyword">(</span><span class="string">'file.ini'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">normal</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; </span><span class="default">bar<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">foo</span><span class="keyword">.</span><span class="default">with</span><span class="keyword">.</span><span class="default">dots</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; [array] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">0</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&gt; </span><span class="default">2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">dictionary</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">debug</span><span class="keyword">] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">path</span><span class="keyword">] =&gt; /</span><span class="default">some</span><span class="keyword">/</span><span class="default">path<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">multi</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">data</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">config</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">debug</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">password</span><span class="keyword">] =&gt; </span><span class="default">123456<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114823""></a>
  <div class="note">
   <strong class="user">mgcummings at yahoo dot SPAMNO dot com</strong>
   <a href="#114823" class="date">10-Apr-2014 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not mentioned in docs about constants but 'magic' constants do NOT work. So for example:<br />
<br />
// __DIR__ = /my/web/site/app<br />
log_file = __DIR__"/app.log"<br />
<br />
Gives you just "__DIR__/app.log" with NO replacement.<br />
<br />
Make sense it should NOT work as there would be question if it should be set to path of PHP file making the call or the path of the 'ini' file. Though the last might be useful the first generally would NOT be if you parse the file several different places in your code etc.<br />
<br />
Tested in PHP 5.4.26</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112737""></a>
  <div class="note">
   <strong class="user">yicktan</strong>
   <a href="#112737" class="date">18-Jul-2013 01:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This combo works best for me.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$inifile </span><span class="keyword">= </span><span class="string">"config.php"</span><span class="keyword">;<br />
</span><span class="default">$inivalue </span><span class="keyword">= </span><span class="default">get_parse_ini</span><span class="keyword">(</span><span class="default">$inifile</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$inivalue</span><span class="keyword">);<br />
</span><span class="default">$inivalue</span><span class="keyword">[</span><span class="string">'config'</span><span class="keyword">][</span><span class="string">'length'</span><span class="keyword">]=</span><span class="default">6</span><span class="keyword">;<br />
</span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="string">"config.php"</span><span class="keyword">, </span><span class="default">$inivalue</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">);<br />
<br />
function </span><span class="default">get_parse_ini</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if cannot open file, return false<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// to hold the categories, and within them the entries<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cats </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (@</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\[(.+)\]/'</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif (@</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/(.+)=(.+)/'</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cats</span><span class="keyword">[</span><span class="default">$last</span><span class="keyword">][</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$cats</span><span class="keyword">;<br />
<br />
}<br />
<br />
function </span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br />
&nbsp; </span><span class="default">$str</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"[</span><span class="default">$k</span><span class="string">]\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }else<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"</span><span class="default">$k</span><span class="string"> = </span><span class="default">$v</span><span class="string">\r\n"</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; </span><span class="default">$phpstr </span><span class="keyword">= </span><span class="string">"&lt;?PHP\r\n/*\r\n"</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">"*/\r\n?&gt;"</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp;if(</span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$phpstr</span><span class="keyword">);<br />
&nbsp; else<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
here is the config.php file<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
;Commented line start with ';'<br />
[config]<br />
admin = root<br />
pass = pass<br />
email = social@facebook.com<br />
length = 4<br />
block = 4<br />
seperation = -<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
Test it out yourself</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112510""></a>
  <div class="note">
   <strong class="user">michel</strong>
   <a href="#112510" class="date">24-Jun-2013 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
note configuration files should be stored outside you www-root/htdocs folder</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112453""></a>
  <div class="note">
   <strong class="user">grant at rootcentral dot org</strong>
   <a href="#112453" class="date">18-Jun-2013 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Somewhere between versions 5.2.5 and 5.3.24, the parsing of unquoted multiword values (e.g. values with embedded spaces) changed.<br />
<br />
In 5.3.24, a multiword value where one of the words is a reserved word (null, yes, no, true, false, on, off, none) will cause the function to return an error.<br />
<br />
Adding double quotation marks around the value string will solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111459""></a>
  <div class="note">
   <strong class="user">simon dot riget at gmail dot com</strong>
   <a href="#111459" class="date">21-Feb-2013 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
.ini files or JSON file format as it is also known as, are very useful format to store stuff in. Especially large arrays. <br />
<br />
Strangely enough there is this nice function to read the file, but no function to write it.<br />
<br />
So here is one.<br />
<br />
Use it as:&nbsp; put_ini_file(string $file, array $array)<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">function </span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br />
&nbsp; </span><span class="default">$str</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"[</span><span class="default">$k</span><span class="string">]"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }else<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"</span><span class="default">$k</span><span class="string"> = </span><span class="default">$v</span><span class="string">"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">; <br />
&nbsp; }<br />
&nbsp;if(</span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp; else<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108384""></a>
  <div class="note">
   <strong class="user">Johannes Schmidt</strong>
   <a href="#108384" class="date">21-Apr-2012 07:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
#If you want to replace a Setting in the ini, use this code:<br />
/// bool SetCMSSettings(string $Setting, string $replace, string $INI_PATH)<br />
/// $Setting = The Setting, which you want to replace<br />
/// $replace = the new value<br />
<br />
public function SetCMSSettings($Setting, $replace, $INI_PATH)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ini = fopen($INI_PATH,"w+");&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while($Content = fgets($ini)) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(preg_match("/".$Setting."/", $Content)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; fwrite($ini, $Setting."=".$replace);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i = 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; fwrite($ini, $Content);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // If, the setting wasnt replaced.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($i == 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; fwrite($ini, $Setting."=".$replace);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
fclose($ini);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105426""></a>
  <div class="note">
   <strong class="user">jerikojerk</strong>
   <a href="#105426" class="date">16-Aug-2011 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that despite the changelog telling nothing about it, the parse_ini_file() changed <br />
-&gt; the way it interprets the simple quote (not accepted on my 5.1 php)<br />
-&gt; array index. PHP 5.3 accepts the following but not php 5.1<br />
<br />
[section]<br />
param["index"]='value'<br />
param["other index"]='other value'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102266""></a>
  <div class="note">
   <strong class="user">Alex - webitoria.com</strong>
   <a href="#102266" class="date">04-Feb-2011 03:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Constants in ini files are not expanded if they are concatenated with strings quoted with single quotes, they must be in double quotes only to make constants expanded.<br />
<br />
Example:<br />
<br />
define ('APP_PATH', '/some/path');<br />
<br />
mypath = APP_PATH '/config'<br />
// Constant won't be expanded: [mypath] =&gt; APP_PATH '/config'<br />
<br />
mypath = APP_PATH "/config"<br />
// Constant will be expanded: [mypath] =&gt; /some/path/config<br />
<br />
Note "." between constant and following string is not used.<br />
<br />
Since Zend_Config_Ini is built on parse_ini_file, it inherits this behaviour.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100046""></a>
  <div class="note">
   <strong class="user">Rolf</strong>
   <a href="#100046" class="date">21-Sep-2010 02:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.3, you can escape a double quote like this:<br />
<br />
description = "an \" example"<br />
<br />
But strangely, this fails when you try to escape two consecutive double quotes:<br />
<br />
description = "no \"\" good"<br />
<br />
Unless there is something between them (in this example, there is a space character):<br />
<br />
description = "this is \" \" ok"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99943""></a>
  <div class="note">
   <strong class="user">uramihsayibok, gmail, com</strong>
   <a href="#99943" class="date">16-Sep-2010 01:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Undocumented feature!<br />
<br />
Using ${...} as a value will look to<br />
1) an INI setting, or<br />
2) an environment variable<br />
<br />
For example,<br />
<br />
<span class="default">&lt;?php<br />
<br />
print_r</span><span class="keyword">(</span><span class="default">parse_ini_string</span><span class="keyword">(</span><span class="string">'<br />
php_ext_dir = ${extension_dir}<br />
operating_system = ${OS}<br />
'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [php_ext_dir] =&gt; ./ext/<br />
&nbsp;&nbsp;&nbsp; [operating_system] =&gt; Windows_NT<br />
)<br />
<br />
Present in PHP 5.3.2, likely in 5.x, maybe even earlier too.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99868""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#99868" class="date">11-Sep-2010 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a ini lexer with regexp:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">@</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">);<br />
<br />
</span><span class="default">$myini </span><span class="keyword">= &lt;&lt;&lt;EOT<br />
</span><span class="string">[examples]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a section<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a comment line<br />
1 = intkey&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a int key<br />
nullvalue = null&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is NULL<br />
truebool = true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (TRUE)<br />
falsebool = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (FALSE)<br />
intvalue = -1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a integer (-1)<br />
floatvalue = +1.4E-3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a float (0.0014)<br />
stringvalue = Hello World&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a unquoted string<br />
quoted = "Hello World"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a quoted string<br />
apostrophed = 'Hello World'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a apostrophed string<br />
quoted escaped = "it work's \"fine\"!"&nbsp; &nbsp; &nbsp; ; this is a quoted string with escaped quotes<br />
apostrophed escaped = 'it work\'s "fine"!'&nbsp; ; this is a apostrophed string with escaped apostrophes<br />
<br />
&nbsp;&nbsp;&nbsp; [[valid special cases]]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a section with square brackets and whitespaces at the beginning<br />
quoted multiline = "line1<br />
line2<br />
line3"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a quoted multiline string<br />
apostrophed multiline = "line1<br />
line2<br />
line3"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a apostrophed multiline string<br />
&nbsp;&nbsp; &nbsp; spaces before key = is ok&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this line has whitespaces at the beginning<br />
no val =&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this setting has no key<br />
= no key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this setting has no value<br />
=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this setting has no key and no value<br />
<br />
[bad cases]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; you should never do that but it works<br />
notgood = unquoted"string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this value has a single quote<br />
notgood2 = unapostrophed'string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this value has a single apostrophe<br />
bad = "unclosed quotes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this value has unclosed quotes<br />
bad2 = 'unclosed apostrophes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this value has unclosed apostrophes<br />
<br />
[invalid<br />
section]<br />
invalid setting<br />
</span><span class="keyword">EOT;<br />
<br />
function </span><span class="default">get_tokens_from_ini_lexer</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexp </span><span class="keyword">= </span><span class="string">'/<br />
&nbsp;&nbsp;&nbsp; (?&lt;=^|\r\n|\r|\n)<br />
&nbsp;&nbsp;&nbsp; (?P&lt;line&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?(?![\t\x20]*;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;left_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \[(?P&lt;section&gt;[^;\r\n]+)\]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;setting&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;key&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [^=;\r\n]+?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;left_equal_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;equal_sign&gt;=)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;right_equal_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;val&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \x22(?P&lt;quoted&gt;.*?)(?&lt;!\x5C)\x22<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \x27(?P&lt;apostrophed&gt;.*?)(?&lt;!\x5C)\x27<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;null&gt;null)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;bool&gt;true|false)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;int&gt;[+-]?(?:[1-9]\d{0,18}|0))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;float&gt;(?:[+-]?(?:[1-9]\d*|0))\.\d+(?:E[+-]\d+)?)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;string&gt;[^;\r\n]+?)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;right_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment_seperator&gt;;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment&gt;[^\r\n]+?)?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;error&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [^\r\n]+?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; (?=\r\n|\r|\n|$)(?P&lt;crlf&gt;\r\n|\r|\n)?<br />
&nbsp;&nbsp;&nbsp; |<br />
&nbsp;&nbsp;&nbsp; (?&lt;=\r\n|\r|\n)(?P&lt;emptyline&gt;\r\n|\r|\n)<br />
&nbsp;&nbsp;&nbsp; /xsi'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if(!@</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$regexp</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$tokens</span><span class="keyword">, </span><span class="default">PREG_SET_ORDER</span><span class="keyword">)))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// parse error<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$tokens </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$token</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$verbose</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'crlf'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'setting'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'equal_sign'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'val'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'left_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'left_equal_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'right_equal_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'right_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'comment_seperator'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'comment_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$token </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) || !@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">$tokens</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; };<br />
};<br />
<br />
</span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">get_tokens_from_ini_lexer</span><span class="keyword">(</span><span class="default">$myini</span><span class="keyword">, </span><span class="default">$verbose</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99474""></a>
  <div class="note">
   <strong class="user">pd at frozen-bits dot de</strong>
   <a href="#99474" class="date">19-Aug-2010 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use the following syntax to secure my config.ini.php file:<br />
<br />
;<span class="default">&lt;?php<br />
</span><span class="keyword">;die(); </span><span class="comment">// For further security<br />
</span><span class="keyword">;</span><span class="comment">/*<br />
<br />
[category]<br />
name="value"<br />
<br />
;*/<br />
<br />
</span><span class="keyword">;</span><span class="default">?&gt;<br />
</span><br />
Works like a charm and is both: A valid PHP File and a valid ini-File ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99036""></a>
  <div class="note">
   <strong class="user">geggert at web dot de</strong>
   <a href="#99036" class="date">23-Jul-2010 06:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As quick an dirty way to gain the security of that *.ini.php-files you may alternatively use this as first line:<br />
<br />
; <span class="default">&lt;?php </span><span class="keyword">exit(); __halt_compiler();<br />
</span><span class="comment">// the closing tag is just to end up the syntax highlighting ...<br />
// leave these comments and the closing tag away in your ini.php-file!<br />
</span><span class="default">?&gt;<br />
</span><br />
You can use parse_ini_file() in the normal way and any criminal stranger will only see a ";" then ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98438""></a>
  <div class="note">
   <strong class="user">forcestudios.square7.de</strong>
   <a href="#98438" class="date">15-Jun-2010 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Tip: you cannot parse an ini-file with this safer structure:<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">exit();<br />
</span><span class="default">$data</span><span class="keyword">=</span><span class="string">"<br />
<br />
[section_one]<br />
test = abc<br />
<br />
[section_two]<br />
and_so=on<br />
<br />
"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
(strangers are not able to see this file because php closed the file previously by executing exit();)<br />
<br />
But here is a very simple code to prevent this:<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">iniParser</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$IniFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$SafeFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$ParseClasses</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$KeysWithoutSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$KeysWithSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$FileName</span><span class="keyword">, </span><span class="default">$SafeFile </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile </span><span class="keyword">= </span><span class="default">$FileName</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">= </span><span class="default">$SafeFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">parseIni</span><span class="keyword">(</span><span class="default">$SaveInClass </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$FileHandle </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">-= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$Counter </span><span class="keyword">&lt; </span><span class="default">$CountLines </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLine </span><span class="keyword">= </span><span class="default">$FileHandle</span><span class="keyword">[</span><span class="default">$Counter</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLineSplit </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$CurLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurKey </span><span class="keyword">= </span><span class="default">$CurLineSplit</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurValue </span><span class="keyword">= </span><span class="default">$CurLineSplit</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Keys</span><span class="keyword">[</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurKey</span><span class="keyword">)] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys</span><span class="keyword">[</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurKey</span><span class="keyword">)] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithoutSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$NKeys</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">parseIniWithSections</span><span class="keyword">(</span><span class="default">$SaveInClass </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$FileHandle </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$LastSection </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">-= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$Counter </span><span class="keyword">&lt; </span><span class="default">$CountLines </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLine </span><span class="keyword">= </span><span class="default">$FileHandle</span><span class="keyword">[</span><span class="default">$Counter</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$CurLine</span><span class="keyword">, </span><span class="string">"["</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$LastSection </span><span class="keyword">= </span><span class="default">$CurLine</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Explosion </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$CurLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurKey </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$Explosion</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurValue </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$Explosion</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$SaveInClass </span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithSections</span><span class="keyword">[</span><span class="default">$LastSection</span><span class="keyword">][</span><span class="default">$CurKey</span><span class="keyword">] = </span><span class="default">$CurValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys</span><span class="keyword">[</span><span class="default">$LastSection</span><span class="keyword">][</span><span class="default">$CurKey</span><span class="keyword">] = </span><span class="default">$CurValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$NKeys</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; };<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
To use this class just try this script here:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">include </span><span class="string">"iniparser.php" </span><span class="comment">// class above<br />
<br />
</span><span class="default">$SafeIniParser </span><span class="keyword">= new </span><span class="default">iniParser</span><span class="keyword">(</span><span class="string">"test.php"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment">// file: test.php, safefile.<br />
<br />
</span><span class="default">$Keys </span><span class="keyword">= </span><span class="default">$SafeIniParser</span><span class="keyword">-&gt;</span><span class="default">parseIniWithSections</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$Keys</span><span class="keyword">[</span><span class="string">"section_one"</span><span class="keyword">][</span><span class="string">"test"</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
i used this file:<br />
<span class="default">&lt;?php </span><span class="keyword">exit();<br />
</span><span class="default">$data</span><span class="keyword">=</span><span class="string">"<br />
<br />
[section_one]<br />
test = abc<br />
<br />
[section_two]<br />
and_so=on<br />
<br />
"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95747""></a>
  <div class="note">
   <strong class="user">Mauro Gabriel Titimoli</strong>
   <a href="#95747" class="date">19-Jan-2010 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have recently finished an implementacion of a multiple configuration type class.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Configuration </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">AUTO </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">JSON </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">PHP_INI </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">XML </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; static private </span><span class="default">$CONF_EXT_RELATION </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'json' </span><span class="keyword">=&gt; </span><span class="default">2</span><span class="keyword">, </span><span class="comment">// JSON<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ini' </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">,&nbsp; </span><span class="comment">// PHP_INI<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'xml' </span><span class="keyword">=&gt; </span><span class="default">16&nbsp; </span><span class="comment">// XML<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; static private </span><span class="default">$instances</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$data</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; static public function </span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">))?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = ((</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) || (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)))?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$type </span><span class="keyword">== </span><span class="default">self</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$CONF_EXT_RELATION</span><span class="keyword">[</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">)];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$type</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">JSON</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">), </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">PHP_INI</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">XML</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; static public function &amp; </span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(! isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">] = new </span><span class="default">Configuration</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">)) &amp;&amp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getAvailableSections</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$configuration </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">(</span><span class="comment">/*configuration filename*/</span><span class="keyword">);<br />
foreach(</span><span class="default">$configuration</span><span class="keyword">-&gt;</span><span class="default">getAvailableSections</span><span class="keyword">() as </span><span class="default">$pos </span><span class="keyword">=&gt; </span><span class="default">$sectionName</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$sectionName</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$configuration</span><span class="keyword">-&gt;{</span><span class="default">$sectionName</span><span class="keyword">});<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94414""></a>
  <div class="note">
   <strong class="user">freamer89 at gmail dot com</strong>
   <a href="#94414" class="date">03-Nov-2009 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Didn`t find the one,which suits my needs,so Here`s a small and easy write ini from array function... Maybe you`ll find it handy.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">write_php_ini</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"[</span><span class="default">$key</span><span class="string">]"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$val </span><span class="keyword">as </span><span class="default">$skey </span><span class="keyword">=&gt; </span><span class="default">$sval</span><span class="keyword">) </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"</span><span class="default">$skey</span><span class="string"> = "</span><span class="keyword">.(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$sval</span><span class="keyword">) ? </span><span class="default">$sval </span><span class="keyword">: </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$sval</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"</span><span class="default">$key</span><span class="string"> = "</span><span class="keyword">.(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) ? </span><span class="default">$val </span><span class="keyword">: </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">safefilerewrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"\r\n"</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">));<br />
}<br />
</span><span class="comment">//////<br />
</span><span class="keyword">function </span><span class="default">safefilerewrite</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$dataToSave</span><span class="keyword">)<br />
{&nbsp; &nbsp; if (</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startTime </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$canWrite </span><span class="keyword">= </span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">LOCK_EX</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If lock not obtained sleep for 0 - 100 milliseconds, to avoid collision and CPU load<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(!</span><span class="default">$canWrite</span><span class="keyword">) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">round</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } while ((!</span><span class="default">$canWrite</span><span class="keyword">)and((</span><span class="default">microtime</span><span class="keyword">()-</span><span class="default">$startTime</span><span class="keyword">) &lt; </span><span class="default">1000</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//file was locked so now we can store information<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$canWrite</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$dataToSave</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">LOCK_UN</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93148""></a>
  <div class="note">
   <strong class="user">flacroix897 at hotmail dot com</strong>
   <a href="#93148" class="date">25-Aug-2009 10:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure you use double-quotes when using spaces in a value as of 5.3.<br />
<br />
Consider the following INI file:<br />
<br />
&nbsp;&nbsp; key = tested on php5<br />
<br />
with the following code:<br />
<br />
&nbsp;&nbsp; $res = parse_ini_file('myini.ini');<br />
&nbsp;&nbsp; var_dump($res);<br />
<br />
In 5.2, this will give you:<br />
<br />
&nbsp;&nbsp; array(1) {<br />
&nbsp;&nbsp; &nbsp; ["key"]=&gt;<br />
&nbsp;&nbsp; &nbsp; string(14) "tested on php5"<br />
&nbsp;&nbsp; }<br />
<br />
In 5.3, this will give you:<br />
<br />
&nbsp;&nbsp; Warning: syntax error, unexpected BOOL_TRUE in Unknown on line 1 in test.php on line 3<br />
&nbsp;&nbsp; bool(false)<br />
<br />
This is because the 'on' word is a reserved keyword for boolean TRUE. The documentation now states that a string that contains any non-alphanumeric character should be enclosed in double-quotes (a space is not alphanumeric).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90624""></a>
  <div class="note">
   <strong class="user">jeremygiberson at gmail dot com</strong>
   <a href="#90624" class="date">30-Apr-2009 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a quick parse_ini_file wrapper to add extend support to save typing and redundancy.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Parses INI file adding extends functionality via ":base" postfix on namespace.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $filename<br />
&nbsp;&nbsp; &nbsp; * @return array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">parse_ini_file_extended</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p_ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini </span><span class="keyword">as </span><span class="default">$namespace </span><span class="keyword">=&gt; </span><span class="default">$properties</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$extends</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$namespace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extends </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$extends</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// create namespace if necessary<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!isset(</span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// inherit base namespace<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">] as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// overwrite / set current namespace values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$properties </span><span class="keyword">as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$config</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Treats this ini:<br />
<span class="default">&lt;?php <br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
database=users<br />
<br />
[archive : base]<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;<br />
</span>As if it were like this:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=users<br />
<br />
[archive : base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87605""></a>
  <div class="note">
   <strong class="user">pBakhuis at googles mail dot com (gmail)</strong>
   <a href="#87605" class="date">12-Dec-2008 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To those who were like me looking if this could be used to create an array out of commandline output I offer you the function below (I used it to parse mplayer output).<br />
<br />
If you want it behave exactly the same as parse_ini_file you'll obviously have to add some code to feed the different sections to this one. Hope it's of help to someone!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* The return is very similar to that of parse_ini_file, but this works off files<br />
&nbsp;* <br />
&nbsp;* Below is an example of what it does, where the first<br />
&nbsp;* value is what you'd normally want to do, and the second and third things that might<br />
&nbsp;* happen and in case it does it's good to know what is going on.<br />
&nbsp;* <br />
&nbsp;* $anArray = array( 'default=theValue', 'setting=', 'something=value=value' );<br />
&nbsp;* explodeExplode( '=', $anArray );<br />
&nbsp;* <br />
&nbsp;* the return will be <br />
&nbsp;* array( 'default' =&gt; 'theValue', 'setting' =&gt; '', 'something' =&gt; 'value=value' );<br />
&nbsp;* <br />
&nbsp;* So the oddities here are, text after the second $string occurence dissapearing<br />
&nbsp;* and empty values resulting in an empty string.<br />
&nbsp;* <br />
&nbsp;* @return $returnArray array array( 'setting' =&gt; 'value' )<br />
&nbsp;* @param $string Object<br />
&nbsp;* @param $array Object<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">explodeExplode</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$array </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$returnArray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$arrayValue </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmpArray </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$arrayValue </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) == </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) &gt; </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$implodeBack </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstLoop&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$tmpArray </span><span class="keyword">as </span><span class="default">$tmpValue </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$firstLoop </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstLoop </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$implodeBack</span><span class="keyword">[] = </span><span class="default">$tmpValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$implodeBack </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">implode</span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$implodeBack </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$returnArray</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86410""></a>
  <div class="note">
   <strong class="user">Bill Brown - macnimble.com</strong>
   <a href="#86410" class="date">16-Oct-2008 07:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working on a project for a client recently, I needed a way to set a default configuration INI file, but also wanted to allow the client to override the settings through the use of a custom INI file.<br />
<br />
I thought array_merge or array_merge_recursive would do the trick for me, but it fails to override settings in the way that I wanted. I wrote my own function to do what I wanted. It's nothing spectacular, but thought I'd post it here in case it saved someone else some time.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ini_merge </span><span class="keyword">(</span><span class="default">$config_ini</span><span class="keyword">, </span><span class="default">$custom_ini</span><span class="keyword">) {<br />
&nbsp; foreach (</span><span class="default">$custom_ini </span><span class="keyword">AS </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">):<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)):<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">ini_merge</span><span class="keyword">(</span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$custom_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; else:<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; endif;<br />
&nbsp; endforeach;<br />
&nbsp; return </span><span class="default">$config_ini</span><span class="keyword">;<br />
};<br />
</span><span class="default">$CONFIG_INI </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'../config.ini'</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$CUSTOM_INI </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'ini/custom.ini'</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$INI </span><span class="keyword">= </span><span class="default">ini_merge</span><span class="keyword">(</span><span class="default">$CONFIG_INI</span><span class="keyword">, </span><span class="default">$CUSTOM_INI</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This allowed me to put the default INI file above the web root with information that requires extra security (database connection info, etc.) and a writable INI file within the structure of the site without affecting the default settings of the default config.ini file.<br />
<br />
Anyway, hope it helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84348""></a>
  <div class="note">
   <strong class="user">juampii_4 at hotmail dot com</strong>
   <a href="#84348" class="date">09-Jul-2008 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
class.parseini.php<br />
<span class="default">&lt;?php<br />
</span><span class="comment">##By juan pablo tosso<br />
</span><span class="keyword">class </span><span class="default">Parser<br />
</span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">printini</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$sector</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">=</span><span class="default">$file</span><span class="keyword">.</span><span class="string">".ini"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is</span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">) &amp;&amp; </span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$is</span><span class="keyword">[</span><span class="default">$sector</span><span class="keyword">][</span><span class="default">$var</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">"error"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Ini.ini:<br />
[test]<br />
foo=bar<br />
<br />
[test2]<br />
foo1=bar1<br />
foo2=bar2<br />
foo bar=something else<br />
<br />
just in another file write:<br />
<br />
include("class.parseini.php");<br />
$new= new Parser();<br />
echo $new-&gt;printini("ini", "test2", "foo1");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78815""></a>
  <div class="note">
   <strong class="user">goulven.ch AT gmail DOT com</strong>
   <a href="#78815" class="date">29-Oct-2007 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: parse_ini_files cannot cope with values containing the equal sign (=).<br />
<br />
The following function supports sections, comments, arrays, and key-value pairs outside of any section.<br />
Beware that similar keys will overwrite one another (unless in different sections).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini </span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$ini </span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">) { return array(); }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sections </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$globals </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$line </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$line </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Comments<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">|| </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">';' </span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Sections<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'[' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sections</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Key-value pair<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">list( </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value </span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$i </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for( </span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$i</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[ </span><span class="default">$sections</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">] ] = </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result </span><span class="keyword">+ </span><span class="default">$globals</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example usage:<br />
<span class="default">&lt;?php<br />
$stores </span><span class="keyword">= </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="string">'stores.ini'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$stores </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
An example ini file:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
;Commented line start with ';'<br />
global_value1 = a string value<br />
global_value1 = another string value<br />
<br />
; empty lines are discarded<br />
[Section1]<br />
key = value<br />
; whitespace around keys and values is discarded too<br />
otherkey=other value<br />
otherkey=yet another value<br />
; this key-value pair will overwrite the former.<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78723""></a>
  <div class="note">
   <strong class="user">www.onphp5.com</strong>
   <a href="#78723" class="date">24-Oct-2007 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looks like in PHP 5.3.0 special characters like \n are extrapolated into real newlines. Gotta use \\n.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78221""></a>
  <div class="note">
   <strong class="user">arnapou</strong>
   <a href="#78221" class="date">03-Oct-2007 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't find a simple ini class so I wrote that class to read and write ini files.<br />
I hope it could help you.<br />
<br />
Read file : $ini = INI::read('myfile.ini');<br />
Write file : INI::write('myfile.ini', $ini);<br />
<br />
Features : <br />
- support [] syntax for arrays<br />
- support . in keys like bar.foo.something = value<br />
- true and false string are automatically converted in booleans<br />
- integers strings are automatically converted in integers<br />
- keys are sorted when writing<br />
- constants are replaced but they should be written in the ini file between braces : {MYCONSTANT}<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">INI </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; WRITE<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">write</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$ini</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">) as </span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="string">'['</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">"]\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">INI</span><span class="keyword">::</span><span class="default">write_get_string</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="string">''</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; write get string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">write_get_string</span><span class="keyword">(&amp; </span><span class="default">$ini</span><span class="keyword">, </span><span class="default">$prefix</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ksort</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">INI</span><span class="keyword">::</span><span class="default">write_get_string</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$prefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">$prefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">' = '</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">"\\\n"</span><span class="keyword">, </span><span class="default">INI</span><span class="keyword">::</span><span class="default">set_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">set_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) { return </span><span class="string">'true'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) { return </span><span class="string">'false'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; READ<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">read</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">= </span><span class="string">'default'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) !== </span><span class="string">';'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\r"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^\[(.*)\]/'</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$multi </span><span class="keyword">=== </span><span class="string">'' </span><span class="keyword">&amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_.\[\]-]+)\s*=\s*(.*)$/i'</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) !== </span><span class="string">"\\"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">], </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$multi </span><span class="keyword">!== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) === </span><span class="string">"\\"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">], </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$multi</span><span class="keyword">.</span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">get_defined_constants</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$consts </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$buf</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$consts</span><span class="keyword">[</span><span class="string">'{'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'}'</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">, array(</span><span class="string">'INI'</span><span class="keyword">, </span><span class="string">'replace_consts'</span><span class="keyword">), </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ini</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^-?[0-9]$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">)) { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">); } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) === </span><span class="string">'true'</span><span class="keyword">) { return </span><span class="default">true</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) === </span><span class="string">'false'</span><span class="keyword">) { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^"(.*)"$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) { return </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^\'(.*)\'$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) { return </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[0-9]$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">)) { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">manage_keys</span><span class="keyword">(&amp; </span><span class="default">$ini</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_-]+)\.(.*)$/i'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]], </span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_-]+)\[(.*)\]$/i'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] !== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]][</span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]][] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; replace utility<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">replace_consts</span><span class="keyword">(&amp; </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76082""></a>
  <div class="note">
   <strong class="user">yarco dot w at gmail dot com</strong>
   <a href="#76082" class="date">29-Jun-2007 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
parse_ini_file can't deal with const which cancate a string. For example, if test.ini file is<br />
<br />
classPath = ROOT/lib<br />
<br />
If you:<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">));<br />
<br />
</span><span class="default">$buf </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
const ROOT would't be parsed.<br />
<br />
But my version could work find.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// array parse_ini_file ( string $filename [, bool $process_sections] )<br />
</span><span class="keyword">function </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp; function </span><span class="default">replace_process</span><span class="keyword">(&amp; </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">get_defined_constants</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">); </span><span class="comment">// PHP version &gt; 5.0<br />
&nbsp; </span><span class="default">$consts </span><span class="keyword">= </span><span class="default">$buf</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">];<br />
&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">, </span><span class="string">'replace_process'</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$ini</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="string">'/test'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/test.ini'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75983""></a>
  <div class="note">
   <strong class="user">Adam</strong>
   <a href="#75983" class="date">25-Jun-2007 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Arrays can be defined in the ini file by adding '[]' at the end of a key name. For example:<br />
<br />
value1 = 17<br />
value2 = 13<br />
<br />
value3[] = a<br />
value3[] = b<br />
value3[] = c<br />
<br />
Will return:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [value1] =&gt; 17<br />
&nbsp;&nbsp;&nbsp; [value2] =&gt; 13<br />
&nbsp;&nbsp;&nbsp; [value3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; a<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; b<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2] =&gt; c<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74152""></a>
  <div class="note">
   <strong class="user">mark at hostcobalt dot com</strong>
   <a href="#74152" class="date">27-Mar-2007 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
or to prevent the file being viewed you can just use a .htaccess file and add this line<br />
<br />
&lt;files *.ini&gt;<br />
order deny,allow<br />
deny from all<br />
&lt;/files&gt;<br />
<br />
i use a similar thing to prevent my config files being accessed</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70847""></a>
  <div class="note">
   <strong class="user">Justin Hall</strong>
   <a href="#70847" class="date">31-Oct-2006 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple (but slightly hackish) way of avoiding the character limitations (in values):<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'QUOTE'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">);<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
contents of test.ini:<br />
<br />
park yesterday = "I (walked) | {to} " QUOTE"the"QUOTE " park yesterday &amp; saw ~three~ dogs!"<br />
<br />
output:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">park yesterday</span><span class="keyword">] =&gt; </span><span class="default">I </span><span class="keyword">(</span><span class="default">walked</span><span class="keyword">) | {</span><span class="default">to</span><span class="keyword">} </span><span class="string">"the" </span><span class="default">park yesterday </span><span class="keyword">&amp; </span><span class="default">saw </span><span class="keyword">~</span><span class="default">three</span><span class="keyword">~ </span><span class="default">dogs</span><span class="keyword">!<br />
)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61960""></a>
  <div class="note">
   <strong class="user">nbraczek at bsds dot de</strong>
   <a href="#61960" class="date">15-Feb-2006 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beside the mentioned reserved words 'null', 'yes', 'no', 'true', and 'false', also 'none' seems to be a reserved word. Parsing an ini file stops at a key named 'none'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61875""></a>
  <div class="note">
   <strong class="user">mauder[remove] at [remove]gmail[remove] dot com</strong>
   <a href="#61875" class="date">14-Feb-2006 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful if you put any .ini file in your readable directories, if somebody would know the name (e.g. if your application is widely used), the webserver might return it as plain text.<br />
<br />
For example : your database username and password could be exposed, if it is stored in that file !<br />
<br />
To prevent this from happening :<br />
- give the file .php extension :&nbsp; "my.ini.php"<br />
- put ';&lt;?php' (without quotes and without X between X and php) on first line <br />
- put ';?&gt;' on last line<br />
<br />
The server would run the ini file as being PHP-code, but will do nothing due to bad syntax, preventing the content from being exosed.<br />
On the other hand, it is still a valid .ini file...<br />
<br />
HTH !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54737""></a>
  <div class="note">
   <strong class="user">dimk at pisem dot net</strong>
   <a href="#54737" class="date">13-Jul-2005 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Class to access ini values at format "section_name.property", for example $myconf-&gt;get("system.name") returns a property "name" in section "system":
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">Settings </span><span class="keyword">{
<br />

<br />
var </span><span class="default">$properties </span><span class="keyword">= array();
<br />

<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">Settings</span><span class="keyword">() {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">_SETTINGS_FILE</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">get</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$section_name</span><span class="keyword">, </span><span class="default">$property</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties</span><span class="keyword">[</span><span class="default">$section_name</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$property</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$properties</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37293""></a>
  <div class="note">
   <strong class="user">waikeatNOSPAM at archerlogic dot com</strong>
   <a href="#37293" class="date">09-Nov-2003 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that this function will not work on remote files.
<br />
I tried 
<br />

<br />
$someArray = parse_ini_file("<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>");
<br />

<br />
and it reports
<br />

<br />
Cannot Open '<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>' for reading ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36476""></a>
  <div class="note">
   <strong class="user">rus dot grafx at usa dot net</strong>
   <a href="#36476" class="date">10-Oct-2003 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instead of using parse_ini_file() function I would recommend to use PEAR's Config package which is MUCH more flexible (assuming that you don't mind using PEAR and OOP). Have a closer look at <a href="http://pear.php.net/package/Config" rel="nofollow" target="_blank">http://pear.php.net/package/Config</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33249""></a>
  <div class="note">
   <strong class="user">dshearin at excite dot com</strong>
   <a href="#33249" class="date">19-Jun-2003 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found another pitfall to watch out for. The key (to the left of the equal sign) can't be the same as one of the predefined values, like yes, no, on, off, etc. I was working on a script that read in an ini file that matched the country codes of top level domains to the full name of the country. I kept getting a parse error everytime it got to the entry for Norway ("no"). I fixed the problem by sticking a dot in front of each of the country codes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31958""></a>
  <div class="note">
   
   <a href="#31958" class="date">10-May-2003 04:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your configuration file holds any sensitive information (such as database login details), remember NOT to place it within your document root folder! A common mistake is to replace config.inc.php files, which are formatted in PHP:<br />
<span class="default">&lt;?php<br />
$database</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] = </span><span class="string">'localhost'</span><span class="keyword">;<br />
</span><span class="comment">// etc...<br />
</span><span class="default">?&gt;<br />
</span><br />
With config.ini files which are written in plain text:<br />
[database]<br />
host = localhost<br />
<br />
The file config.ini can be read by anyone who knows where it's located, if it's under your document root folder. Remember to place it above!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28261""></a>
  <div class="note">
   <strong class="user">kieran dot huggins at rogers dot com</strong>
   <a href="#28261" class="date">07-Jan-2003 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note for all those running into trouble escaping double quotes:<br />
<br />
I got around this by "base64_encode()"-ing my content on the way in to the ini file, and "base64_decode()"-ing on the way out.<br />
<br />
Because base64 uses the "=" sign, you will have to encapsulate the entire value in double quotes so the line looks like this:<br />
<br />
&nbsp;&nbsp;&nbsp; varname = "TmlhZ2FyYSBGYWxscywgT04="<br />
<br />
When base64'd, your strings will retain all \n, \t...etc...&nbsp; URL's retain everything perfectly :-)<br />
<br />
I hope some of you find this useful!<br />
<br />
Cheers, Kieran</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27264""></a>
  <div class="note">
   <strong class="user">fbeyer at clickhand dot de</strong>
   <a href="#27264" class="date">29-Nov-2002 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Besides the features mentioned above (eg. core constants, booleans), you can also access user-defined constants in ini files! This is handy if you want to create a bit-field, for example:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Define pizza toppings
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_HAM'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">1</span><span class="keyword">);
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_PINEAPPLE'</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="default">2</span><span class="keyword">);
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_ONION'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">4</span><span class="keyword">);
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_MOZARELLA'</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="default">8</span><span class="keyword">);
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_GARLIC'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">16</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// Read predefined pizzas
<br />
</span><span class="default">$pizzas </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'pizzas.ini'</span><span class="keyword">);
<br />

<br />
if (</span><span class="default">$pizzas</span><span class="keyword">[</span><span class="default">$user_pizza</span><span class="keyword">] &amp; </span><span class="default">PIZZA_ONION</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Add onions to the pizza
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
[pizzas]
<br />

<br />
; Define pizzas
<br />
hawaii = PIZZA_HAM | PIZZA_PINEAPPLE
<br />
stinky = PIZZA_ONION | PIZZA_GARLIC</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20204""></a>
  <div class="note">
   <strong class="user">bob at kludgebox dot com</strong>
   <a href="#20204" class="date">26-Mar-2002 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
And for the extra-paranoid like myself, add a rule into your httpd.conf file so that *.ini (or *.inc) in my case can't be sent to a browser:<br />
<br />
&lt;Files *.inc&gt;&nbsp; <br />
&nbsp;&nbsp;&nbsp; Order deny,allow<br />
&nbsp;&nbsp;&nbsp; Deny from all<br />
&lt;/Files&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
