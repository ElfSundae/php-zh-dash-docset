<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>返回 web 服务器和 PHP 之间的接口类型</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.php-ini-scanned-files.html">? php_ini_scanned_files</a></li>
      <li style="float: right;"><a href="function.php-uname.html">php_uname ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.info.html">PHP 选项/信息 函数</a></li>
    <li>返回 web 服务器和 PHP 之间的接口类型</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.php-sapi-name" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">php_sapi_name</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">php_sapi_name</span> &mdash; <span class="dc-title">返回 web 服务器和 PHP 之间的接口类型</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.php-sapi-name-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>php_sapi_name</strong></span>
    (
   ) : <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="simpara">
   返回描述 PHP 所使用的接口类型（the Server API, SAPI）的小写字符串。
   例如，CLI 的 PHP 下这个字符串会是 &quot;cli&quot;，Apache 下可能会有几个不同的值，取决于具体使用的 SAPI。
   以下列出了可能的值。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.php-sapi-name-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回接口类型的小写字符串，  或者在失败时返回 <strong><code>false</code></strong>。
  </p>
  <p class="para">
   尽管不够全面，可能返回的值包括了
   <code class="literal">apache</code>、
   <code class="literal">apache2handler</code>、
   <code class="literal">cgi</code> （直到 PHP 5.3）, 
   <code class="literal">cgi-fcgi</code>、<code class="literal">cli</code>、 <code class="literal">cli-server</code>、
   <code class="literal">embed</code>、<code class="literal">fpm-fcgi</code>、
   <code class="literal">litespeed</code>、
   <code class="literal">nsapi</code>、<code class="literal">phpdbg</code>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.php-sapi-name-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-540">
    <p><strong>Example #1 <span class="function"><strong>php_sapi_name()</strong></span> 例子</strong></p>
    <div class="example-contents"><p>
     以下例子检测了子字符串 <code class="literal">cgi</code>，因为它也有可能会是 <code class="literal">cgi-fcgi</code>。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sapi_type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">php_sapi_name</span><span style="color: #007700">();<br />if&nbsp;(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$sapi_type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'cgi'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"You&nbsp;are&nbsp;using&nbsp;CGI&nbsp;PHP\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"You&nbsp;are&nbsp;not&nbsp;using&nbsp;CGI&nbsp;PHP\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.php-sapi-name-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>另一种方法</strong><br />
   <p class="para">
    PHP 常量 <strong><code>PHP_SAPI</code></strong> 具有和 <span class="function"><strong>php_sapi_name()</strong></span> 相同的值。
   </p>
  </p></blockquote>
  <div class="tip"><strong class="tip">Tip</strong>
   <h1 class="title">一个潜在的疑难问题</h1>
   <p class="para">
    定义的 <acronym title="Server Application Programming Interface">SAPI</acronym> 可能不够明显，比如它可能定义为 <code class="literal">apache2handler</code>，而不是 <code class="literal">apache</code>。
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.php-sapi-name-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="reserved.constants.html#reserved.constants.core" class="link">PHP_SAPI</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125658""></a>
  <div class="note">
   <strong class="user">michael at butlerpc dot net</strong>
   <a href="#125658" class="date">05-Jan-2021 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using nginx-unit with PHP, the sapi name seems to be "cli-server"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117997""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#117997" class="date">16-Sep-2015 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php_sapi_name (which is equal to PHP_SAPI) can either be cgi or any other cgi mod (dependent on which mod you are using)-<br />
<br />
Examples: <br />
'fpm-fcgi'<br />
'cgi-fcgi'<br />
[...]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114295""></a>
  <div class="note">
   <strong class="user">hajo-p</strong>
   <a href="#114295" class="date">03-Feb-2014 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
some not yet mentioned sapi names:<br />
<br />
cli-server -&gt; php built-in webserver<br />
srv -&gt; hhvm</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89858""></a>
  <div class="note">
   <strong class="user">michal at roszka dot pl</strong>
   <a href="#89858" class="date">26-Mar-2009 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The php_sapi_name() function is extremely useful when you want to determine the type of interface. There is, however, one more gotcha you need to be aware of while designing your application or deploying it to an unknown server.<br />
<br />
Whenever something depends on the type of interface, make sure your check is conclusive. Especially when you want to distinguish the command line interface (CLI) from the common gateway interface (CGI).<br />
<br />
Note, that the php-cgi binary can be called from the command line, from a shell script or as a cron job as well! If so, the php_sapi_name() will always return the same value (i.e. "cgi-fcgi") instead of "cli" which you could expect.<br />
<br />
Bad things happen to good people. Do not always expect /usr/bin/php to be a link to php-cli binary.<br />
<br />
Luckily the contents of the $_SERVER and the $_ENV superglobal arrays depends on whether the php-cgi binary is called from the command line interface (by a shell script, by the cron, etc.) or by some HTTP server (i.e. lighttpd).<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Try to call php-cgi binary from the command line interface and then via HTTP request and compare the output of the script above. There will be plenty options to satisfy almost everyone.<br />
<br />
For the sake of security remember, that contents of the $_SERVER and the $_ENV superglobal arrays (as well as $_GET, $_POST, $_COOKIE, $_FILES and $_REQUEST) should be considered tainted.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
