<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Traversable （遍历）接口</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="reserved.interfaces.html">? 预定义接口和类</a></li>
      <li style="float: right;"><a href="class.iterator.html">Iterator ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="reserved.interfaces.html">预定义接口和类</a></li>
    <li>Traversable （遍历）接口</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.traversable" class="reference">

 <h1 class="title"> <span class="interfacename"><a href="class.traversable.html" class="interfacename">Traversable</a></span> （遍历）接口</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5, PHP 7, PHP 8)</p>


  <div class="section" id="traversable.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    检测一个类是否可以使用 <a href="control-structures.foreach.html" class="link">foreach</a> 进行遍历的接口。
   </p>
   <p class="para">
    无法被单独实现的基本抽象接口。相反它必须由 <span class="interfacename"><a href="class.iteratoraggregate.html" class="interfacename">IteratorAggregate</a></span> 
    或 <span class="interfacename"><a href="class.iterator.html" class="interfacename">Iterator</a></span> 接口实现。
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     实现此接口的内建类可以使用 <a href="control-structures.foreach.html" class="link">foreach</a> 进行遍历而无需实现 <span class="interfacename"><a href="class.iteratoraggregate.html" class="interfacename">IteratorAggregate</a></span>
     或 <span class="interfacename"><a href="class.iterator.html" class="interfacename">Iterator</a></span> 接口。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     这是一个无法在 PHP 脚本中实现的内部引擎接口。
     <span class="interfacename"><a href="class.iteratoraggregate.html" class="interfacename">IteratorAggregate</a></span> 或 
     <span class="interfacename"><a href="class.iterator.html" class="interfacename">Iterator</a></span> 接口可以用来代替它。
     当实现扩展的 Traversable 接口时，
     确保在 implement 子句中，在名字之前列出了 <span class="interfacename"><a href="class.iteratoraggregate.html" class="interfacename">IteratorAggregate</a></span>
     或者 <span class="interfacename"><a href="class.iterator.html" class="interfacename">Iterator</a></span>。
    </p>
   </p></blockquote>
  </div>


  <div class="section" id="traversable.synopsis">
   <h2 class="title">接口摘要</h2>


   <div class="classsynopsis">
    <div class="ooclass">
     
    </div>

    <div class="classsynopsisinfo">
     <span class="oointerface">
      <span class="modifier">interface</span> <strong class="interfacename">Traversable</strong></span> {</div>
   }</div>


   <p class="para">
    这个接口没有任何方法，它的作用仅仅是作为所有可遍历类的基本接口。
   </p>

  </div>

 </div>

</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123146""></a>
  <div class="note">
   <strong class="user">alan dot bem at gmail dot com</strong>
   <a href="#123146" class="date">21-Sep-2018 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Actually you can use `Traversable` within your php scripts - you can use it to enforce iterability on user-land objects.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">interface </span><span class="default">Stream </span><span class="keyword">implements </span><span class="default">\Traversable </span><span class="keyword">{}<br />
<br />
class </span><span class="default">InMemoryStream </span><span class="keyword">implements </span><span class="default">IteratorAggregate</span><span class="keyword">, </span><span class="default">Stream<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getIterator</span><span class="keyword">() {}<br />
}<br />
<br />
</span><span class="default">$stream </span><span class="keyword">= new </span><span class="default">InMemoryStream</span><span class="keyword">(); <br />
</span><span class="default">?&gt;<br />
</span><br />
In case you'd forgot about implementing `IteratorAggregate` or `Iterator` interfaces, fatal error will be raised when instantiating objects in question.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">interface </span><span class="default">Stream </span><span class="keyword">implements </span><span class="default">\Traversable </span><span class="keyword">{}<br />
<br />
class </span><span class="default">InMemoryStream </span><span class="keyword">implements </span><span class="default">Stream </span><span class="keyword">{}<br />
<br />
</span><span class="default">$stream </span><span class="keyword">= new </span><span class="default">InMemoryStream</span><span class="keyword">(); </span><span class="comment">// Fatal error: Class InMemoryStream must implement interface Traversable as part of either Iterator or IteratorAggregate in Unknown on line 0<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121273""></a>
  <div class="note">
   <strong class="user">douglas at reith dot com dot au</strong>
   <a href="#121273" class="date">26-Jun-2017 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The PHP7 iterable pseudo type will match both Traversable and array. Great for return type-hinting so that you do not have to expose your Domain to Infrastructure code, e.g. instead of a Repository returning a Cursor, it can return hint 'iterable':<br />
<span class="default">&lt;?php<br />
UserRepository</span><span class="keyword">::</span><span class="default">findUsers</span><span class="keyword">(): </span><span class="default">iterable<br />
?&gt;<br />
</span><br />
Link: <a href="http://php.net/manual/en/migration71.new-features.php#migration71.new-features.iterable-pseudo-type" rel="nofollow" target="_blank">http://php.net/manual/en/migration71.new-features.php#migration71.new-features.iterable-pseudo-type</a><br />
<br />
Also, instead of:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$items </span><span class="keyword">) &amp;&amp; !</span><span class="default">$items </span><span class="keyword">instanceof </span><span class="default">Traversable </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Throw exception here<br />
</span><span class="default">?&gt;<br />
</span><br />
You can now do with the is_iterable() method:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ( !</span><span class="default">is_iterable</span><span class="keyword">( </span><span class="default">$items </span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Throw exception here<br />
</span><span class="default">?&gt;<br />
</span><br />
Link:&nbsp; <a href="http://php.net/manual/en/function.is-iterable.php" rel="nofollow" target="_blank">http://php.net/manual/en/function.is-iterable.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118575""></a>
  <div class="note">
   <strong class="user">cobaltbluedw</strong>
   <a href="#118575" class="date">30-Dec-2015 09:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
NOTE:&nbsp; While objects and arrays can be traversed by foreach, they do NOT implement "Traversable", so you CANNOT check for foreach compatibility using an instanceof check.<br />
<br />
Example:<br />
<br />
$myarray = array('one', 'two', 'three');<br />
$myobj = (object)$myarray;<br />
<br />
if ( !($myarray instanceof \Traversable) ) {<br />
&nbsp;&nbsp;&nbsp; print "myarray is NOT Traversable";<br />
}<br />
if ( !($myobj instanceof \Traversable) ) {<br />
&nbsp;&nbsp;&nbsp; print "myobj is NOT Traversable";<br />
}<br />
<br />
foreach ($myarray as $value) {<br />
&nbsp;&nbsp;&nbsp; print $value;<br />
}<br />
foreach ($myobj as $value) {<br />
&nbsp;&nbsp;&nbsp; print $value;<br />
}<br />
<br />
Output:<br />
myarray is NOT Traversable<br />
myobj is NOT Traversable<br />
one<br />
two<br />
three<br />
one<br />
two<br />
three</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116377""></a>
  <div class="note">
   <strong class="user">ajf at ajf dot me</strong>
   <a href="#116377" class="date">23-Dec-2014 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that all objects can be iterated over with foreach anyway and it'll go over each property. This just describes whether or not the class implements an iterator, i.e. has custom behaviour.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99195""></a>
  <div class="note">
   <strong class="user">kevinpeno at gmail dot com</strong>
   <a href="#99195" class="date">02-Aug-2010 10:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While you cannot implement this interface, you can use it in your checks to determine if something is usable in for each. Here is what I use if I'm expecting something that must be iterable via foreach.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$items </span><span class="keyword">) &amp;&amp; !</span><span class="default">$items </span><span class="keyword">instanceof </span><span class="default">Traversable </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Throw exception here<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
