<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>绑定一个 PHP 变量到一个 Oracle 位置标志符</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/46435ff017f60abb4908b0ce55102d08-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.oci-bind-array-by-name.html">? oci_bind_array_by_name</a></li>
      <li style="float: right;"><a href="function.oci-cancel.html">oci_cancel ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.oci8.html">OCI8 函数</a></li>
    <li>绑定一个 PHP 变量到一个 Oracle 位置标志符</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.oci-bind-by-name" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">oci_bind_by_name</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8, PECL OCI8 &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">oci_bind_by_name</span> &mdash; <span class="dc-title">绑定一个 PHP 变量到一个 Oracle 位置标志符</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.oci-bind-by-name-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>oci_bind_by_name</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">resource</span> <code class="parameter">$statement</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$bv_name</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span> <code class="parameter reference">&$variable</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$maxlength</code><span class="initializer"> = -1</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$type</code><span class="initializer"> = SQLT_CHR</span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
    将 PHP 变量 <code class="parameter">variable</code> 绑定到
   Oracle 位置标志符 <code class="parameter">bv_name</code>。绑定操作对 Oracle 数据库性能很重要，同时也是避免 SQL 注入安全问题的一种方式。
  </p>

  <p class="para">
   <span class="function"><strong>oci_bind_by_name()</strong></span> 将 PHP 变量
   <code class="parameter">variable</code> 绑定到  Oracle 的位置标志符
   <code class="parameter">ph_name</code>。该变量是否会被用作输入输出是在运行时决定的，并且函数给该变量分配必要的存储空间。<code class="parameter">length</code>
   参数确定该绑定的最大长度，如果将 <code class="parameter">length</code>
   设为 -1，<span class="function"><strong>oci_bind_by_name()</strong></span> 会用
   <code class="parameter">variable</code> 变量的当前长度确定绑定的最大长度。
  </p>
  <p class="para">
   如果要绑定一个抽象数据类型（LOB/ROWID/BFILE），需要先用
   <span class="function"><a href="function.oci-new-descriptor.html" class="function">oci_new_descriptor()</a></span> 函数分配空间。<code class="parameter">length</code>
   没有用于抽象数据类型，应被设为 -1。<code class="parameter">type</code>
   参数告诉 Oracle 要使用什么样的描述符。可能的值为：
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_FILE</code></strong> - 对应于 BFILE；
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_CFILE</code></strong> - 对应于 CFILE；
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_CLOB</code></strong> - 对应于 CLOB；
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_BLOB</code></strong> - 对应于 BLOB；
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_ROWID</code></strong> - 对应于 ROWID；
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <strong><code>SQLT_NTY</code></strong> - 对应于有名字的数据类型；
     </p>
    </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_INT</code></strong> - 对应于 integers；
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_CHR</code></strong> - 对应于 VARCHARs；
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_BIN</code></strong> - 对应于 RAW 列；
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_LNG</code></strong> - 对应于 LONG 列；
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_LBI</code></strong> - 对应于 LONG RAW 列；
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <strong><code>SQLT_RSET</code></strong> - 对应于游标，是之前由
      <span class="function"><a href="function.oci-new-cursor.html" class="function">oci_new_cursor()</a></span> 创建的。
       </p>
      </li>
   </ul>
  </p>
  <p class="para">
   <div class="example" id="example-3588">
    <p><strong>Example #1 <span class="function"><strong>oci_bind_by_name()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/* oci_bind_by_name example thies at thieso dot net (980221)<br />  inserts 3 records into emp, and uses the ROWID for updating the<br />  records just after the insert.<br />*/<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"scott"</span><span style="color: #007700">, </span><span style="color: #DD0000">"tiger"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"<br />                          INSERT INTO<br />                                     emp (empno, ename)<br />                                              VALUES<br />                                     (:empno,:ename)<br />                            RETURNING<br />                                     ROWID<br />                                 INTO<br />                                     :rid<br />                                         "</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$data </span><span style="color: #007700">= array(<br />              </span><span style="color: #0000BB">1111 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Larry"</span><span style="color: #007700">,<br />              </span><span style="color: #0000BB">2222 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Bill"</span><span style="color: #007700">,<br />              </span><span style="color: #0000BB">3333 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Jim"<br />             </span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$rowid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_new_descriptor</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_D_ROWID</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #DD0000">":empno"</span><span style="color: #007700">, </span><span style="color: #0000BB">$empno</span><span style="color: #007700">, </span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #DD0000">":ename"</span><span style="color: #007700">, </span><span style="color: #0000BB">$ename</span><span style="color: #007700">, </span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">,   </span><span style="color: #0000BB">$rowid</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_ROWID</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$update </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"<br />                            UPDATE<br />                                  emp<br />                               SET<br />                                  sal = :sal<br />                             WHERE<br />                                  ROWID = :rid<br />                             "</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$update</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">, </span><span style="color: #0000BB">$rowid</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$update</span><span style="color: #007700">, </span><span style="color: #DD0000">":sal"</span><span style="color: #007700">, </span><span style="color: #0000BB">$sal</span><span style="color: #007700">,   </span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$sal </span><span style="color: #007700">= </span><span style="color: #0000BB">10000</span><span style="color: #007700">;<br /><br />foreach (</span><span style="color: #0000BB">$data </span><span style="color: #007700">as </span><span style="color: #0000BB">$empno </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$ename</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br />    </span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$update</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$rowid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">free</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$update</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"<br />                          SELECT<br />                                *<br />                            FROM<br />                                emp<br />                           WHERE<br />                                empno<br />                              IN<br />                                (1111,2222,3333)<br />                              "</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br />while (</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">)) {<br />    </span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* delete our "junk" from the emp table.... */<br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"<br />                          DELETE FROM<br />                                     emp<br />                                WHERE<br />                                     empno<br />                                   IN<br />                                     (1111,2222,3333)<br />                                   "</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   记住，本函数删除了行尾的空白字符。见以下例子：
  </p>
  <p class="para">
   <div class="example" id="example-3590">
    <p><strong>Example #2 <span class="function"><strong>oci_bind_by_name()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$connection </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'apelsin'</span><span style="color: #007700">,</span><span style="color: #DD0000">'kanistra'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$query </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO test_table VALUES(:id, :text)"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$statement </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">, </span><span style="color: #DD0000">":id"</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">, </span><span style="color: #DD0000">":text"</span><span style="color: #007700">, </span><span style="color: #DD0000">"trailing spaces follow     "</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/*<br /> This code will insert into DB string 'trailing spaces follow', without<br /> trailing spaces<br />*/<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3592">
    <p><strong>Example #3 <span class="function"><strong>oci_bind_by_name()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$connection </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'apelsin'</span><span style="color: #007700">,</span><span style="color: #DD0000">'kanistra'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$query </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO test_table VALUES(:id, 'trailing spaces follow      ')"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$statement </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">, </span><span style="color: #DD0000">":id"</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/*<br /> And this code will add 'trailing spaces follow      ', preserving<br /> trailing whitespaces<br />*/<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    不要将
    <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a> 或
    <span class="function"><a href="function.addslashes.html" class="function">addslashes()</a></span> 与 <span class="function"><strong>oci_bind_by_name()</strong></span>
    同时使用，因为不需要转义，任何自动加上的引号都会被写入数据库中，因为
    <span class="function"><strong>oci_bind_by_name()</strong></span>
    不能分辨有意加上的引号和魔术引号。
   </p>
  </div>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    在 PHP 5.0.0 之前的版本必须使用 <span class="function"><a href="function.ocibindbyname.html" class="function">ocibindbyname()</a></span>
    替代本函数。该函数名仍然可用，为向下兼容作为
    <span class="function"><strong>oci_bind_by_name()</strong></span> 的别名。不过其已被废弃，不推荐使用。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.oci-bind-by-name-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">statement</code></dt>

     <dd>

      <p class="para">
       A valid OCI8 statement identifer.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">bv_name</code></dt>

     <dd>

      <p class="para">
       The colon-prefixed bind variable placeholder used in the
       statement.  The colon is optional
       in <code class="parameter">bv_name</code>. Oracle does not use question
       marks for placeholders.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">variable</code></dt>
 
     <dd>

      <p class="para">
       The PHP variable to be associated with <code class="parameter">bv_name</code>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">maxlength</code></dt>

     <dd>

      <p class="para">
       Sets the maximum length for the data. If you set it to -1, this
       function will use the current length
       of <code class="parameter">variable</code> to set the maximum
       length. In this case the <code class="parameter">variable</code> must
       exist and contain data
       when <span class="function"><strong>oci_bind_by_name()</strong></span> is called.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">type</code></dt>

     <dd>

      <p class="para">
       The datatype that Oracle will treat the data as.  The
       default <code class="parameter">type</code> used
       is <strong><code>SQLT_CHR</code></strong>. Oracle will convert the data
       between this type and the database column (or PL/SQL variable
       type), when possible.
      </p>
      <p class="para">
       If you need to bind an abstract datatype (LOB/ROWID/BFILE) you
       need to allocate it first using the
       <span class="function"><a href="function.oci-new-descriptor.html" class="function">oci_new_descriptor()</a></span> function. The
       <code class="parameter">length</code> is not used for abstract datatypes
       and should be set to -1.
      </p>
      <p class="para">
       Possible values for <code class="parameter">type</code> are:
       <ul class="itemizedlist">
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_BFILEE</code></strong> or <strong><code>OCI_B_BFILE</code></strong>
           - for BFILEs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_CFILEE</code></strong> or <strong><code>OCI_B_CFILEE</code></strong>
          - for CFILEs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_CLOB</code></strong> or <strong><code>OCI_B_CLOB</code></strong>
          - for CLOBs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_BLOB</code></strong> or <strong><code>OCI_B_BLOB</code></strong>
          - for BLOBs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_RDD</code></strong> or <strong><code>OCI_B_ROWID</code></strong>
          - for ROWIDs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_NTY</code></strong> or <strong><code>OCI_B_NTY</code></strong>
          - for named datatypes;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_INT</code></strong> or <strong><code>OCI_B_INT</code></strong> - for integers;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_CHR</code></strong> - for VARCHARs;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_BIN</code></strong> or <strong><code>OCI_B_BIN</code></strong>
          - for RAW columns;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_LNG</code></strong> - for LONG columns;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_LBI</code></strong> - for LONG RAW columns;
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_RSET</code></strong> - for cursors created
          with <span class="function"><a href="function.oci-new-cursor.html" class="function">oci_new_cursor()</a></span>.
         </p>
        </li>
        <li class="listitem">
         <p class="para">
          <strong><code>SQLT_BOL</code></strong> or <strong><code>OCI_B_BOL</code></strong>
          - for PL/SQL BOOLEANs (Requires OCI8 2.0.7 and Oracle Database 12c)
         </p>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.oci-bind-by-name-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.oci-bind-by-name-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="appenditerator.append.examples.basic">
    <p><strong>Example #4 Inserting data with <span class="function"><strong>oci_bind_by_name()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, text VARCHAR2(40));<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,</span><span style="color: #DD0000">"INSERT INTO mytab (id, text) VALUES(:id_bv, :text_bv)"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$id </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$text </span><span style="color: #007700">= </span><span style="color: #DD0000">"Data to insert     "</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":id_bv"</span><span style="color: #007700">, </span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":text_bv"</span><span style="color: #007700">, </span><span style="color: #0000BB">$text</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Table now contains: 1, 'Data to insert     '<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="appenditerator.examples.api">
    <p><strong>Example #5 Binding once for multiple executions</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER);<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$a </span><span style="color: #007700">= array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">,</span><span style="color: #0000BB">5</span><span style="color: #007700">,</span><span style="color: #0000BB">7</span><span style="color: #007700">,</span><span style="color: #0000BB">11</span><span style="color: #007700">);  </span><span style="color: #FF8000">// data to insert<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'INSERT INTO mytab (id) VALUES (:bv)'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':bv'</span><span style="color: #007700">, </span><span style="color: #0000BB">$v</span><span style="color: #007700">, </span><span style="color: #0000BB">20</span><span style="color: #007700">);<br />foreach (</span><span style="color: #0000BB">$a </span><span style="color: #007700">as </span><span style="color: #0000BB">$v</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$r </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_DEFAULT</span><span style="color: #007700">);  </span><span style="color: #FF8000">// don't auto commit<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">oci_commit</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">); </span><span style="color: #FF8000">// commit everything at once<br /><br />// Table contains five rows: 1, 3, 5, 7, 11<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="appenditerator.key.examples.basic">
    <p><strong>Example #6 Binding with a <span class="function"><strong>foreach()</strong></span> loop</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT * FROM departments WHERE department_name = :dname AND location_id = :loc'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$ba </span><span style="color: #007700">= array(</span><span style="color: #DD0000">':dname' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'IT Support'</span><span style="color: #007700">, </span><span style="color: #DD0000">':loc' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">1700</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #0000BB">$ba </span><span style="color: #007700">as </span><span style="color: #0000BB">$key </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$val</span><span style="color: #007700">) {<br /><br />    </span><span style="color: #FF8000">// oci_bind_by_name($stid, $key, $val) does not work<br />    // because it binds each placeholder to the same location: $val<br />    // instead use the actual location of the data: $ba[$key]<br />    </span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">, </span><span style="color: #0000BB">$ba</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]);<br />}<br /><br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #0000BB">OCI_RETURN_NULLS</span><span style="color: #007700">);<br />foreach (</span><span style="color: #0000BB">$row </span><span style="color: #007700">as </span><span style="color: #0000BB">$item</span><span style="color: #007700">) {<br />    print </span><span style="color: #0000BB">$item</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3600">
    <p><strong>Example #7 Binding in a WHERE clause</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"hr"</span><span style="color: #007700">, </span><span style="color: #DD0000">"hrpwd"</span><span style="color: #007700">, </span><span style="color: #DD0000">"localhost/XE"</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT last_name FROM employees WHERE department_id = :didbv ORDER BY last_name'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$didbv </span><span style="color: #007700">= </span><span style="color: #0000BB">60</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':didbv'</span><span style="color: #007700">, </span><span style="color: #0000BB">$didbv</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br />while ((</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">)) != </span><span style="color: #0000BB">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'LAST_NAME'</span><span style="color: #007700">] .</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Output is<br />//    Austin<br />//    Ernst<br />//    Hunold<br />//    Lorentz<br />//    Pataballa<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3602">
    <p><strong>Example #8 Binding with a LIKE clause</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Find all cities that begin with 'South'<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT city FROM locations WHERE city LIKE :bv"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">'South%'</span><span style="color: #007700">;  </span><span style="color: #FF8000">// '%' is a wildcard in SQL<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":bv"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #0000BB">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] as </span><span style="color: #0000BB">$c</span><span style="color: #007700">) {<br />    print </span><span style="color: #0000BB">$c </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">// Output is<br />//   South Brunswick<br />//   South San Francisco<br />//   Southlake<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3604">
    <p><strong>Example #9 Binding with REGEXP_LIKE</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Find all cities that contain 'ing'<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT city FROM locations WHERE REGEXP_LIKE(city, :bv)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">'.*ing.*'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":bv"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #0000BB">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] as </span><span style="color: #0000BB">$c</span><span style="color: #007700">) {<br />    print </span><span style="color: #0000BB">$c </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">// Output is<br />//   Beijing<br />//   Singapore<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
    For a small, fixed number of IN clause conditions, use individual
    bind variables. Values unknown at run time can be set to NULL.
    This allows a single statement to be used by all application
    users, maximizing Oracle DB cache efficiency.
  </p>

  <p class="para">
   <div class="example" id="callbackfilteriterator.examples.basic">
    <p><strong>Example #10 Binding Multiple Values in an IN Clause</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT last_name FROM employees WHERE employee_id in (:e1, :e2, :e3)'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mye1 </span><span style="color: #007700">= </span><span style="color: #0000BB">103</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$mye2 </span><span style="color: #007700">= </span><span style="color: #0000BB">104</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$mye3 </span><span style="color: #007700">= </span><span style="color: #0000BB">NULL</span><span style="color: #007700">; </span><span style="color: #FF8000">// pretend we were not given this value<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e1'</span><span style="color: #007700">, </span><span style="color: #0000BB">$mye1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e2'</span><span style="color: #007700">, </span><span style="color: #0000BB">$mye2</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e3'</span><span style="color: #007700">, </span><span style="color: #0000BB">$mye3</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br />foreach (</span><span style="color: #0000BB">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'LAST_NAME'</span><span style="color: #007700">] as </span><span style="color: #0000BB">$name</span><span style="color: #007700">) {<br />    print </span><span style="color: #0000BB">$name </span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Output is<br />//   Ernst<br />//   Hunold<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3608">
    <p><strong>Example #11 Binding a ROWID returned by a query</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, salary NUMBER, name VARCHAR2(40));<br />//   INSERT INTO mytab (id, salary, name) VALUES (1, 100, 'Chris');<br />//   COMMIT;<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT ROWID, name FROM mytab WHERE id = :id_bv FOR UPDATE'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$id </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':id_bv'</span><span style="color: #007700">, </span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #0000BB">OCI_RETURN_NULLS</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$rid </span><span style="color: #007700">= </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'ROWID'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'NAME'</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">// Change name to upper case &amp; save the changes<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'UPDATE mytab SET name = :n_bv WHERE ROWID = :r_bv'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':n_bv'</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':r_bv'</span><span style="color: #007700">, </span><span style="color: #0000BB">$rid</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The table now contains 1, 100, CHRIS<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3610">
    <p><strong>Example #12 Binding a ROWID on INSERT</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// This example inserts an id &amp; name, and then updates the salary<br />// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, salary NUMBER, name VARCHAR2(40));<br />//<br />// Based on original ROWID example by thies at thieso dot net (980221)<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$m </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO mytab (id, name) VALUES(:id_bv, :name_bv)<br />        RETURNING ROWID INTO :rid"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$ins_stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$rowid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_new_descriptor</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_D_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":id_bv"</span><span style="color: #007700">,   </span><span style="color: #0000BB">$id</span><span style="color: #007700">,    </span><span style="color: #0000BB">10</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":name_bv"</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">,  </span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">,     </span><span style="color: #0000BB">$rowid</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_ROWID</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"UPDATE mytab SET salary = :salary WHERE ROWID = :rid"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$upd_stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$upd_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">, </span><span style="color: #0000BB">$rowid</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$upd_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":salary"</span><span style="color: #007700">, </span><span style="color: #0000BB">$salary</span><span style="color: #007700">,   </span><span style="color: #0000BB">32</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// ids and names to insert<br /></span><span style="color: #0000BB">$data </span><span style="color: #007700">= array(</span><span style="color: #0000BB">1111 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Larry"</span><span style="color: #007700">,<br />              </span><span style="color: #0000BB">2222 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Bill"</span><span style="color: #007700">,<br />              </span><span style="color: #0000BB">3333 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Jim"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Salary of each person<br /></span><span style="color: #0000BB">$salary </span><span style="color: #007700">= </span><span style="color: #0000BB">10000</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Insert and immediately update each row<br /></span><span style="color: #007700">foreach (</span><span style="color: #0000BB">$data </span><span style="color: #007700">as </span><span style="color: #0000BB">$id </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$name</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$ins_stid</span><span style="color: #007700">);<br />    </span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$upd_stid</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$rowid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">free</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$upd_stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$ins_stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Show the new rows<br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT * FROM mytab"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br />while (</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #0000BB">OCI_RETURN_NULLS</span><span style="color: #007700">)) {<br />    </span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-3612">
    <p><strong>Example #13 Binding for a PL/SQL stored function</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//  Before running the PHP program, create a stored function in<br />//  SQL*Plus or SQL Developer:<br />//<br />//  CREATE OR REPLACE FUNCTION myfunc(p IN NUMBER) RETURN NUMBER AS<br />//  BEGIN<br />//      RETURN p * 3;<br />//  END;<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$e </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$p </span><span style="color: #007700">= </span><span style="color: #0000BB">8</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'begin :r := myfunc(:p); end;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p'</span><span style="color: #007700">, </span><span style="color: #0000BB">$p</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The return value is an OUT bind. The default type will be a string<br />// type so binding a length 40 means that at most 40 digits will be<br />// returned.<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':r'</span><span style="color: #007700">, </span><span style="color: #0000BB">$r</span><span style="color: #007700">, </span><span style="color: #0000BB">40</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">"</span><span style="color: #0000BB">$r</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">// prints 24<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
  <div class="example" id="example-3614">
   <p><strong>Example #14 Binding parameters for a PL/SQL stored procedure</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//  Before running the PHP program, create a stored procedure in<br />//  SQL*Plus or SQL Developer:<br />//<br />//  CREATE OR REPLACE PROCEDURE myproc(p1 IN NUMBER, p2 OUT NUMBER) AS<br />//  BEGIN<br />//      p2 := p1 * 2;<br />//  END;<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$e </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$p1 </span><span style="color: #007700">= </span><span style="color: #0000BB">8</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'begin myproc(:p1, :p2); end;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p1'</span><span style="color: #007700">, </span><span style="color: #0000BB">$p1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The second procedure parameter is an OUT bind. The default type<br />// will be a string type so binding a length 40 means that at most 40<br />// digits will be returned.<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p2'</span><span style="color: #007700">, </span><span style="color: #0000BB">$p2</span><span style="color: #007700">, </span><span style="color: #0000BB">40</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">"</span><span style="color: #0000BB">$p2</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">// prints 16<br /><br /></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
  <div class="example" id="example-3616">
   <p><strong>Example #15 Binding a CLOB column</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// Before running, create the table:<br />//     CREATE TABLE mytab (mykey NUMBER, myclob CLOB);<br /><br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$e </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$mykey </span><span style="color: #007700">= </span><span style="color: #0000BB">12343</span><span style="color: #007700">;  </span><span style="color: #FF8000">// arbitrary key for this example;<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO mytab (mykey, myclob)<br />        VALUES (:mykey, EMPTY_CLOB())<br />        RETURNING myclob INTO :myclob"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$clob </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_new_descriptor</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_D_LOB</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":mykey"</span><span style="color: #007700">, </span><span style="color: #0000BB">$mykey</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":myclob"</span><span style="color: #007700">, </span><span style="color: #0000BB">$clob</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_CLOB</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_DEFAULT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$clob</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">(</span><span style="color: #DD0000">"A very long string"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_commit</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Fetching CLOB data<br /><br /></span><span style="color: #0000BB">$query </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT myclob FROM mytab WHERE mykey = :mykey'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$stid </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse </span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":mykey"</span><span style="color: #007700">, </span><span style="color: #0000BB">$mykey</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">'&lt;table border="1"&gt;'</span><span style="color: #007700">;<br />while (</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #0000BB">OCI_RETURN_LOBS</span><span style="color: #007700">)) {<br />    print </span><span style="color: #DD0000">'&lt;tr&gt;&lt;td&gt;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'MYCLOB'</span><span style="color: #007700">].</span><span style="color: #DD0000">'&lt;/td&gt;&lt;/tr&gt;'</span><span style="color: #007700">;<br />    </span><span style="color: #FF8000">// In a loop, freeing the large variable before the 2nd fetch reduces PHP's peak memory usage<br />    </span><span style="color: #007700">unset(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);  <br />}<br />print </span><span style="color: #DD0000">'&lt;/table&gt;'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  </p>

<p class="para">
  <div class="example" id="example-3618">
   <p><strong>Example #16 Binding a PL/SQL BOOLEAN</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$e </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$plsql </span><span style="color: #007700">= <br />  </span><span style="color: #DD0000">"begin<br />    :output1 := true;<br />    :output2 := false;<br />   end;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$s </span><span style="color: #007700">= </span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">$plsql</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$s</span><span style="color: #007700">, </span><span style="color: #DD0000">':output1'</span><span style="color: #007700">, </span><span style="color: #0000BB">$output1</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_BOL</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$s</span><span style="color: #007700">, </span><span style="color: #DD0000">':output2'</span><span style="color: #007700">, </span><span style="color: #0000BB">$output2</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">OCI_B_BOL</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$s</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$output1</span><span style="color: #007700">);  </span><span style="color: #FF8000">// true<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$output2</span><span style="color: #007700">);  </span><span style="color: #FF8000">// false<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  </p>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.oci-bind-by-name-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.oci-bind-by-name-notes">
  <h3 class="title">注释</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    Do not use <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a> or
    <span class="function"><a href="function.addslashes.html" class="function">addslashes()</a></span>
    and <span class="function"><strong>oci_bind_by_name()</strong></span> simultaneously as no
    quoting is needed. Any magically applied quotes will be written
    into your database because <span class="function"><strong>oci_bind_by_name()</strong></span>
    inserts data verbatim and does not remove quotes or escape
    characters.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    If you bind a string to a <code class="literal">CHAR</code> column in
    a <code class="literal">WHERE</code> clause, remember that Oracle uses
    blank-padded comparison semantics for <code class="literal">CHAR</code>
    columns.  Your PHP variable should be blank padded to the same
    width as the column for the <code class="literal">WHERE</code> clause to
    succeed.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
     The PHP <code class="parameter">variable</code> argument is a reference.  Some
     forms of loops do not work as expected:
   </p>
   <div class="informalexample">
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">foreach (</span><span style="color: #0000BB">$myarray </span><span style="color: #007700">as </span><span style="color: #0000BB">$key </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$value</span><span style="color: #007700">)  {<br />    </span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

   </div>
   <p class="para">
     This binds each key to the location of $value, so all bound
     variables end up pointing to the last loop iteration&#039;s
     value. Instead use the following:
   </p>
   <div class="informalexample">
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">foreach (</span><span style="color: #0000BB">$myarray </span><span style="color: #007700">as </span><span style="color: #0000BB">$key </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$value</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">, </span><span style="color: #0000BB">$myarray</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

   </div>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.oci-bind-by-name-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.oci-bind-array-by-name.html" class="function" rel="rdfs-seeAlso">oci_bind_array_by_name()</a> - Binds a PHP array to an Oracle PL/SQL array parameter</span></li>
    <li class="member"><span class="function"><a href="function.oci-parse.html" class="function" rel="rdfs-seeAlso">oci_parse()</a> - 配置 Oracle 语句预备执行</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="126261""></a>
  <div class="note">
   <strong class="user">charles dot fisher at arconic dot com</strong>
   <a href="#126261" class="date">21-Jul-2021 06:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am trying to rework ADOdb library calls to OCI, and I wrote this function today which is helping.<br />
<br />
function OraQry(&amp;$Results, $Query, $Binds = false) {<br />
&nbsp; global $xdb;<br />
<br />
&nbsp; $Results = oci_parse($xdb, $Query);<br />
<br />
&nbsp; if($Binds) foreach($Binds as $BindNm =&gt; $BindValJunk)<br />
&nbsp;&nbsp;&nbsp; oci_bind_by_name($Results, $BindNm, $Binds[$BindNm], -1);<br />
<br />
&nbsp; oci_execute($Results, OCI_NO_AUTO_COMMIT);<br />
<br />
&nbsp; return null;<br />
}<br />
<br />
This also has similarity to PDO in passing an array of bind variables, with the added benefit that if they are named numerically (starting at zero), then the call to the array() function can be omitted:<br />
<br />
OraQry($rs,<br />
&nbsp; 'select status from all_tables where owner=:0 and table_name=:1',<br />
&nbsp;&nbsp;&nbsp; [$owner, $table_name]);<br />
<br />
while($arr = oci_fetch_assoc($rs)) echo $arr['STATUS'] . "\n";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124325""></a>
  <div class="note">
   <strong class="user">asui dot dev dot null at gmail dot com</strong>
   <a href="#124325" class="date">22-Oct-2019 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are getting "ORA-01722: invalid number error" while inserting/updating a FLOAT value into a NUMBER column, please check the correctness of a binded value format according to the current locale settings. <br />
<br />
Default "american" locale assumes that value send to oracle will be a dot decimal separator (just like 4127.5). But with setlocale('pl_PL.UTF-8') your float number would be represented as 4127,5 and that form will be used while sending data do oracle causing a problem...<br />
That was my case (8 hours of debugging).<br />
<br />
You can check your current locale with setlocale(LC_ALL, 0).<br />
<br />
What I can recommend as a solutions:<br />
a) do not set locale, or set it to 'C' for a time of sending data;<br />
b) convert float to a string format compatible with current oracle session NLS_NUMERIC_CHARACTERS parameter value. <br />
For example: when NLS_NUMERIC_CHARACTERS = '.,' float value 4127.5 should be converted to '4127.5'.&nbsp; Then oracle will catch it correctly even if current locale are set differently.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121776""></a>
  <div class="note">
   <strong class="user">splintyg at gmail dot com</strong>
   <a href="#121776" class="date">19-Oct-2017 10:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Guys, i've been looking for long time, how to pass clob to and get from procedure<br />
CREATE OR REPLACE PROCEDURE myproc(p1 IN clob, p2 OUT clob);<br />
<br />
Here You are an answer:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $conn </span><span class="keyword">= </span><span class="default">oci_connect</span><span class="keyword">(</span><span class="string">"TEST"</span><span class="keyword">, </span><span class="string">"html"</span><span class="keyword">, </span><span class="string">"//hostname"</span><span class="keyword">, </span><span class="string">"UTF8"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="string">"./clob.txt"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stid </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">"begin myproc(:p1, :p2); end;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1 </span><span class="keyword">= </span><span class="default">oci_new_descriptor</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">OCI_D_LOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p2 </span><span class="keyword">= </span><span class="default">oci_new_descriptor</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">OCI_D_LOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="string">":p1"</span><span class="keyword">, </span><span class="default">$p1</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_CLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="string">":p2"</span><span class="keyword">, </span><span class="default">$p2</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_CLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1</span><span class="keyword">-&gt;</span><span class="default">writeTemporary</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">OCI_TEMP_BLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">); -- </span><span class="default">Figure out OCI_NO_AUTO_COMMIT<br />
&nbsp;&nbsp;&nbsp; oci_commit</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$p2</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">(); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1&nbsp; &nbsp; </span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p2&nbsp; &nbsp; </span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_free_statement</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
And perfect book about "PHP and Oracle" <br />
<a href="http://www.oracle.com/technetwork/topics/php/underground-php-oracle-manual-098250.html" rel="nofollow" target="_blank">http://www.oracle.com/technetwork/topics/php/underground-php-oracle-manual-098250.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121775""></a>
  <div class="note">
   <strong class="user">splintyg at gmail dot com</strong>
   <a href="#121775" class="date">19-Oct-2017 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Guys, i've been looking for long time, how to pass clob to and get from procedure<br />
CREATE OR REPLACE PROCEDURE myproc(p1 IN clob, p2 OUT clob);<br />
<br />
Here You are an answer:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $conn </span><span class="keyword">= </span><span class="default">oci_connect</span><span class="keyword">(</span><span class="string">"TEST"</span><span class="keyword">, </span><span class="string">"html"</span><span class="keyword">, </span><span class="string">"//hostname"</span><span class="keyword">, </span><span class="string">"UTF8"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="string">"./clob.txt"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stid </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">"begin myproc(:p1, :p2); end;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1 </span><span class="keyword">= </span><span class="default">oci_new_descriptor</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">OCI_D_LOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p2 </span><span class="keyword">= </span><span class="default">oci_new_descriptor</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">OCI_D_LOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="string">":p1"</span><span class="keyword">, </span><span class="default">$p1</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_CLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="string">":p2"</span><span class="keyword">, </span><span class="default">$p2</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_CLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1</span><span class="keyword">-&gt;</span><span class="default">writeTemporary</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">OCI_TEMP_BLOB</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">); -- </span><span class="default">Figure out OCI_NO_AUTO_COMMIT<br />
&nbsp;&nbsp;&nbsp; oci_commit</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$p2</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">(); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p1&nbsp; &nbsp; </span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p2&nbsp; &nbsp; </span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_free_statement</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">oci_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
And perfect book about "PHP and Oracle" <br />
<a href="http://www.oracle.com/technetwork/topics/php/underground-php-oracle-manual-098250.html" rel="nofollow" target="_blank">http://www.oracle.com/technetwork/topics/php/underground-php-oracle-manual-098250.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121422""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#121422" class="date">24-Jul-2017 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Bear in mind that you cannot use reserved words for bind variables. Otherwise you'll get ORA-01745: Invalid host/bind variable name error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119783""></a>
  <div class="note">
   <strong class="user">martin dot abbrent at ufz dot de</strong>
   <a href="#119783" class="date">24-Aug-2016 11:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example #7 only shows the binding of a small fixed number of values in an IN clause. There is also a way to bind multiple conditions with a variable number of values.<br />
<br />
<span class="default">&lt;?php<br />
$ids </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">103</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">104<br />
</span><span class="keyword">);<br />
<br />
</span><span class="default">$conn&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">oci_pconnect</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">, </span><span class="default">$tns</span><span class="keyword">);<br />
</span><span class="comment">// Using ORACLE table() function to get the ids from the subquery<br />
</span><span class="default">$sql&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">'SELECT * FROM employees WHERE employee_id IN (SELECT column_value FROM table(:ids))'</span><span class="keyword">;<br />
</span><span class="default">$stmt&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">);<br />
</span><span class="comment">// Create collection of numbers. Build in type for strings is ODCIVARCHAR2LIST, but you can also create own types.<br />
</span><span class="default">$idCollection </span><span class="keyword">= </span><span class="default">oci_new_collection</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">'ODCINUMBERLIST'</span><span class="keyword">, </span><span class="string">'SYS'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Maximum length of collections of type ODCINUMBERLIST is 32767, maybe you should check that!<br />
</span><span class="keyword">foreach (</span><span class="default">$ids </span><span class="keyword">as </span><span class="default">$id</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$idCollection</span><span class="keyword">-&gt;</span><span class="default">append</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':ids'</span><span class="keyword">, </span><span class="default">$idCollection</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_NTY</span><span class="keyword">);<br />
</span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="default">OCI_DEFAULT</span><span class="keyword">);<br />
</span><span class="default">oci_fetch_all</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="default">$return</span><span class="keyword">);<br />
</span><span class="default">oci_free_statement</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">);<br />
<br />
</span><span class="default">oci_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119073""></a>
  <div class="note">
   <strong class="user">marki at trash-mail dot com</strong>
   <a href="#119073" class="date">28-Mar-2016 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that in my earlier note about having oci_bind_by_name() in a function, this becomes a little more complicated when returning values like "UPDATE table SET bla='blubb' RETURNING id INTO :id". <br />
<br />
You can do it as follows:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">sql</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">, &amp;</span><span class="default">$vars_in</span><span class="keyword">=array(), &amp;</span><span class="default">$vars_out</span><span class="keyword">=array()) {<br />
&nbsp; ...<br />
&nbsp; </span><span class="default">$stid </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$q</span><span class="keyword">);<br />
&nbsp; ...<br />
&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$vars_in</span><span class="keyword">);<br />
&nbsp; do {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">current</span><span class="keyword">(</span><span class="default">$vars_in</span><span class="keyword">)===</span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="default">key</span><span class="keyword">(</span><span class="default">$vars_in</span><span class="keyword">), </span><span class="default">current</span><span class="keyword">(</span><span class="default">$vars_in</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// insert exception handling here<br />
&nbsp; </span><span class="keyword">} while (</span><span class="default">each</span><span class="keyword">(</span><span class="default">$vars_in</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// VARS TO RETURN<br />
&nbsp; // we'll fix this to integer type because for now we need this for index IDs<br />
&nbsp; </span><span class="keyword">foreach (</span><span class="default">$vars_out </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stid</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">, </span><span class="default">$vars_out</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_INT</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// insert exception handling here<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; ...<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Use like this:<br />
<br />
<span class="default">&lt;?php<br />
$blubb </span><span class="keyword">= </span><span class="string">'blubb'</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= array(</span><span class="string">':bla' </span><span class="keyword">=&gt; </span><span class="default">$blubb</span><span class="keyword">);<br />
</span><span class="default">$b_out </span><span class="keyword">= array(</span><span class="string">':id' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">); </span><span class="comment">// leave value empty<br />
</span><span class="default">$x </span><span class="keyword">= </span><span class="default">sql</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$b_out</span><span class="keyword">);<br />
</span><span class="default">$id </span><span class="keyword">= </span><span class="default">$b_out</span><span class="keyword">[</span><span class="string">':id'</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span><br />
(The point is: you would not be able to return anything into $b[':bla'] because $b[':bla'] becomes current($vars_in) inside sql() and cannot be written to.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119063""></a>
  <div class="note">
   <strong class="user">marki at trash-mail dot com</strong>
   <a href="#119063" class="date">26-Mar-2016 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a query that was working properly at first sight, no errors on execute, nothing, but there were simply no results returned at runtime.<br />
<br />
Be careful when putting the database commands into a function and binding your variables there while using oci_fetch_xxx() outside the function.<br />
<br />
function sql($conn, $stmt, $var) {<br />
&nbsp; $stid = oci_parse($conn, $stmt);<br />
&nbsp; ...<br />
&nbsp; oci_bind_by_name($stid, ':val', $var);<br />
&nbsp; ...<br />
}<br />
sql($conn, $q, $var);<br />
$row = oci_fetch_array($stid, OCI_ASSOC+OCI_RETURN_NULLS);<br />
<br />
As you see from the definition of oci_bind_by_name(), $var needs to be passed as reference, so your function has to have this reference ready like this:<br />
<br />
function sql($conn, $stmt, &amp;$var) {<br />
&nbsp; $stid = oci_parse($conn, $stmt);<br />
&nbsp; ...<br />
&nbsp; oci_bind_by_name($stid, ':val', $var);<br />
&nbsp; ...<br />
}<br />
<br />
The background is that if you don't pass by reference (in which case $var inside the function is a copy of $var outside the function), then oci_bind_by_name() will work just fine at first glance.<br />
However, since the oci_fetch statements that you use to actually get the data will reference the $var that has ceased to exist when the function finished. In fact, since the varbind seems to be a pointer, that pointer will point to an invalid location at that point and your variables won't be substitued in the SQL.<br />
<br />
All this also means that:<br />
<br />
1) You have to pass a variable, and not just a value<br />
<br />
This doesn't work:<br />
<br />
$stid = sql($conn, $q, array('bla'=&gt;'blubb'));<br />
<br />
This is better:<br />
<br />
$vars = array('bla'=&gt;'blubb');<br />
$stid = sql($conn, $q, $vars);<br />
<br />
2) Even when passing as reference to your helper function you cannot use e.g. foreach:<br />
<br />
This doesn't work:<br />
<br />
function sql($conn, $q, $vars) {<br />
&nbsp; ...<br />
&nbsp; foreach ($vars as $k =&gt; $v) {<br />
&nbsp;&nbsp;&nbsp; oci_bind_by_name($stid, $k, $v);<br />
&nbsp; }<br />
&nbsp; ...<br />
}<br />
<br />
Again, because $k and $v are local variables that will have disappeared once you perform an oci_fetch outside the function.<br />
<br />
Instead you have to work the array in a more low-level way like this:<br />
<br />
function sql($conn, $q, &amp;$vars) {<br />
&nbsp; ...<br />
&nbsp; $stid = oci_parse($conn, $q);<br />
&nbsp; ...<br />
&nbsp; reset($vars);<br />
&nbsp; do {<br />
&nbsp;&nbsp;&nbsp; if (current($vars)===FALSE) { // end of array<br />
&nbsp;&nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $b = oci_bind_by_name($stid, key($vars), current($vars));<br />
&nbsp;&nbsp;&nbsp; if ($b === FALSE) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; DIE('Could not bind var');<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; } while (each($vars) !== FALSE);<br />
}<br />
$binds = array(':bla1' =&gt; 'blubb1',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ':bla2' =&gt; 'blubb2');<br />
$stid = sql($conn, $q, $binds);<br />
$row = oci_fetch_array($stid, OCI_ASSOC+OCI_RETURN_NULLS);<br />
<br />
Wherever you oci_bind_by_name(), the pointer to the initial data has to exist from beginning to end.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115784""></a>
  <div class="note">
   <strong class="user">xorinox at gmx dot ch</strong>
   <a href="#115784" class="date">23-Sep-2014 02:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working with Oracle and raw types in and out worked like the following for me.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">/*oracle procedure<br />
&nbsp; procedure open_session(<br />
&nbsp;&nbsp;&nbsp; i_instance_id in raw,<br />
&nbsp;&nbsp;&nbsp; o_session_id out raw,<br />
&nbsp;&nbsp;&nbsp; o_errcode out number,<br />
&nbsp;&nbsp;&nbsp; o_errmsg out varchar2<br />
&nbsp; );&nbsp; <br />
&nbsp; */<br />
<br />
&nbsp; //open database<br />
&nbsp; </span><span class="default">$conn </span><span class="keyword">= </span><span class="default">DBOpen</span><span class="keyword">( </span><span class="default">DB_DEV_USER </span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">//get session id<br />
&nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"begin p_loader.open_session( hextoraw( :instance_id ), :session_id, :errcode, :errmsg ); end;"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">( </span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$sql </span><span class="keyword">);<br />
&nbsp; </span><span class="default">$instanceId </span><span class="keyword">= </span><span class="default">DB_INSTANCE_ID</span><span class="keyword">;<br />
&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">( </span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":instance_id"</span><span class="keyword">, </span><span class="default">$instanceId</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_CHR </span><span class="keyword">);<br />
&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">( </span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":session_id"</span><span class="keyword">, </span><span class="default">$sessionId</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">, </span><span class="default">SQLT_BIN </span><span class="keyword">);<br />
&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">( </span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":errcode"</span><span class="keyword">, </span><span class="default">$errcode</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">, </span><span class="default">SQLT_INT </span><span class="keyword">);<br />
&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">( </span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":errmsg"</span><span class="keyword">, </span><span class="default">$errmsg</span><span class="keyword">, </span><span class="default">4000</span><span class="keyword">, </span><span class="default">SQLT_CHR </span><span class="keyword">);<br />
&nbsp; <br />
&nbsp; </span><span class="default">oci_execute</span><span class="keyword">( </span><span class="default">$stmt </span><span class="keyword">);<br />
&nbsp; </span><span class="default">$sessionId </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">( </span><span class="default">$sessionId </span><span class="keyword">); </span><span class="comment">//now this is a hex string<br />
&nbsp; <br />
&nbsp; //close database<br />
&nbsp; </span><span class="default">DBClose</span><span class="keyword">( </span><span class="default">$conn </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114869""></a>
  <div class="note">
   <strong class="user">jjeffman at cpovo.net</strong>
   <a href="#114869" class="date">17-Apr-2014 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is very important to set up the maxlength of the returning parameter (:r), even when it is returning a number, otherwise the ORA-01460 exception (unimplemented or unreasonable conversion requested) may be raised.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105911""></a>
  <div class="note">
   <strong class="user">abiyi2000 at yahoo dot com</strong>
   <a href="#105911" class="date">24-Sep-2011 08:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I unfortunately spent the whole day trying to make this work as part of OCI bind_by_name insert:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$v2</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmth</span><span class="keyword">, </span><span class="default">$bvar</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">,&nbsp; -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_INT</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v2 </span><span class="keyword">= (string) </span><span class="default">$v2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmth</span><span class="keyword">, </span><span class="default">$bvar</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_CHR</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The string field is always inserting correctly w/o any truncation. The string field is a&nbsp; varchar2(160) CHAR, but the data used to populate it is 40 chars in length.
<br />

<br />
The numeric part is of Type Number in the database which is being used to store unix time (10 digit seconds since 1970/01/01.
<br />

<br />
The problem, the insert was truncating to 9 digits with some bogus value not even related to the input i.e., it's not just a matter of dropping the leftmost or rightmost digit, it'll just insert a 9 digit bogus number.
<br />

<br />
The only way I was able to resolve this for the numeric field was to set the maxlength to 8 (not 10 which is the number of digits in the input): 
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$v2</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmth</span><span class="keyword">, </span><span class="default">$bvar</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">,&nbsp; </span><span class="default">8</span><span class="keyword">, </span><span class="default">OCI_B_INT</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v2 </span><span class="keyword">= (string) </span><span class="default">$v2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmth</span><span class="keyword">, </span><span class="default">$bvar</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_CHR</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Hopefully you'll see this soon before you expend a lot of time repeating the same problem I had.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92334""></a>
  <div class="note">
   <strong class="user">adrian dot crossley at hesa dot ac dot uk</strong>
   <a href="#92334" class="date">20-Jul-2009 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes you get the error "ORA-01461: can bind a LONG value only for insert into a LONG column".&nbsp; This error is highly misleading especially when you have no LONG columns or LONG values.<br />
<br />
From my testing it seems this error can be caused when the value of a bound variable exceeds the length allocated.<br />
<br />
To avoid this error make sure you specify lengths when binding varchars e.g. <br />
<span class="default">&lt;?php<br />
oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">,</span><span class="string">':string'</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">, </span><span class="default">256</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
And for numerics use the default length (-1) but tell oracle its an integer e.g. <br />
<span class="default">&lt;?php<br />
oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">,</span><span class="string">':num'</span><span class="keyword">,</span><span class="default">$num</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_INT</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89074""></a>
  <div class="note">
   <strong class="user">avenger at php dot net</strong>
   <a href="#89074" class="date">20-Feb-2009 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Dont forget the 5th parameter: $type. It's will slowly your code some times. Eg:<br />
<br />
<span class="default">&lt;?php<br />
$sql </span><span class="keyword">= </span><span class="string">"select * from (select * from b xxx) where rownum &lt; :rnum"</span><span class="keyword">;<br />
</span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">OCIParse</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">,</span><span class="default">$sql</span><span class="keyword">);<br />
</span><span class="default">OCIBindByName</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":rnum"</span><span class="keyword">, </span><span class="default">$NUM</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">OCIExecute</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Below code was slow 5~6 time than not use bind value.Change the 3rd line to:<br />
<br />
<span class="default">&lt;?php<br />
OCIBindByName</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">":rnum"</span><span class="keyword">, </span><span class="default">$NUM</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">SQLT_INT</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
will resloved this problem.<br />
<br />
This issue is also in the ADODB DB class(adodb.sf.net), you will be careful for use the SelectLimit method.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83094""></a>
  <div class="note">
   <strong class="user">ajitsingh4u at gmail dot com</strong>
   <a href="#83094" class="date">09-May-2008 09:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
//Calling Oracle Stored Procedure<br />
//I assume that you have a users table and three columns in users table i.e. id, user, email in oracle<br />
// For example I made connection in constructor, you can modify as per your requirement.<br />
//<a href="http://www.devshed.com/c/a/PHP/Understanding-Destructors-in-PHP-5/1/" rel="nofollow" target="_blank">http://www.devshed.com/c/a/PHP/Understanding-Destructors-in-PHP-5/1/</a><br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Users</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$connection</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection </span><span class="keyword">= </span><span class="default">oci_connect</span><span class="keyword">(</span><span class="string">"scott"</span><span class="keyword">, </span><span class="string">"tiger"</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">); </span><span class="comment">// Establishes a connection to the Oracle server; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">selectUsers</span><span class="keyword">(</span><span class="default">$start_index</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">, </span><span class="default">$numbers_of_rows</span><span class="keyword">=</span><span class="default">20</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">=</span><span class="string">"BEGIN sp_users_select(:p_start_index, :p_numbers_of_rows, :p_cursor, :p_result); END;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Bind in parameter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_start_index'</span><span class="keyword">, </span><span class="default">$start_index</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_numbers_of_rows'</span><span class="keyword">, </span><span class="default">$numbers_of_rows</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Bind out parameter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_result'</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">); </span><span class="comment">// returns 0 if stored procedure succeessfully executed.<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //Bind Cursor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p_cursor </span><span class="keyword">= </span><span class="default">oci_new_cursor</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_cursor'</span><span class="keyword">, </span><span class="default">$p_cursor</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_B_CURSOR</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Execute Statement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$p_cursor</span><span class="keyword">, </span><span class="default">OCI_DEFAULT</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_fetch_all</span><span class="keyword">(</span><span class="default">$p_cursor</span><span class="keyword">, </span><span class="default">$cursor</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">OCI_FETCHSTATEMENT_BY_ROW</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">); </span><span class="comment">// $cursor is an associative array so we can use print_r() to print this data.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // you can return data from this function to use it at your user interface.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">deleteUser</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sql </span><span class="keyword">=</span><span class="string">"BEGIN sp_user_delete(:p_id, :p_result); END;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// bind in and out variables<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_id'</span><span class="keyword">, </span><span class="default">$id</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">oci_bind_by_name</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="string">':p_result'</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Execute the statement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$check </span><span class="keyword">= </span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$check </span><span class="keyword">== </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$commit </span><span class="keyword">= </span><span class="default">oci_commit</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$commit </span><span class="keyword">= </span><span class="default">oci_rollback</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// You can make function for insert ,update using above two functions<br />
<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75018""></a>
  <div class="note">
   
   <a href="#75018" class="date">08-May-2007 01:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is what the old OCI_B_* constants are now called:<br />
(PHP 5.1.6 win32)<br />
<br />
OCI_B_NTY - SQLT_NTY<br />
OCI_B_BFILE - SQLT_BFILEE<br />
OCI_B_CFILEE - SQLT_CFILEE<br />
OCI_B_CLOB - SQLT_CLOB<br />
OCI_B_BLOB - SQLT_BLOB<br />
OCI_B_ROWID - SQLT_RDD<br />
OCI_B_CURSOR - SQLT_RSET<br />
OCI_B_BIN - SQLT_BIN<br />
OCI_B_INT - SQLT_INT<br />
OCI_B_NUM - SQLT_NUM</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72290""></a>
  <div class="note">
   <strong class="user">Chris Delcamp</strong>
   <a href="#72290" class="date">11-Jan-2007 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of returning the primary key from an insert so that you can do inserts on other tables with foreign keys based on that value.&nbsp; The date is just used to provied semi-unique data to be inserted.<br />
<br />
$conn = oci_connect("username", "password")<br />
$stmt = oci_parse($conn, "INSERT INTO test (test_msg) values (:data) RETURN test_id INTO :RV");<br />
$data = date("d-M-Y H:i:s");<br />
oci_bind_by_name($stmt, ":RV", $rv, -1, SQLT_INT);<br />
oci_bind_by_name($stmt, ":data", $data, 24);<br />
oci_execute($stmt);<br />
print $rv;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55895""></a>
  <div class="note">
   <strong class="user">hfuecks at nospam dot org</strong>
   <a href="#55895" class="date">16-Aug-2005 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that there have been some changes on the constant identifiers and the documentation is currently not entirely accurate.<br />
<br />
Running the following script;<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach (</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">get_defined_constants</span><span class="keyword">()) as </span><span class="default">$const</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^OCI_B_/'</span><span class="keyword">, </span><span class="default">$const</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"</span><span class="default">$const</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Under PHP 4.4.0 I get;<br />
<br />
OCI_B_SQLT_NTY &lt; renamed to OCI_B_NTY with PHP5<br />
OCI_B_BFILE<br />
OCI_B_CFILEE<br />
OCI_B_CLOB<br />
OCI_B_BLOB<br />
OCI_B_ROWID<br />
OCI_B_CURSOR<br />
OCI_B_BIN<br />
<br />
Under PHP 5.0.4 I get;<br />
<br />
OCI_B_NTY<br />
OCI_B_BFILE &lt; docs are wrong right now<br />
OCI_B_CFILEE &lt; docs are wrong right now<br />
OCI_B_CLOB<br />
OCI_B_BLOB<br />
OCI_B_ROWID<br />
OCI_B_CURSOR<br />
OCI_B_BIN &lt; it's a mystery</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
