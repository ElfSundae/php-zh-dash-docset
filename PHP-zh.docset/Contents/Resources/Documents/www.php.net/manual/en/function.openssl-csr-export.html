<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>将 CSR 作为字符串导出</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.openssl-cms-verify.html">? openssl_cms_verify</a></li>
      <li style="float: right;"><a href="function.openssl-csr-export-to-file.html">openssl_csr_export_to_file ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.openssl.html">OpenSSL 函数</a></li>
    <li>将 CSR 作为字符串导出</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.openssl-csr-export" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">openssl_csr_export</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">openssl_csr_export</span> &mdash; <span class="dc-title">将 <abbr title="Certificate Signing Request">CSR</abbr> 作为字符串导出</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.openssl-csr-export-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>openssl_csr_export</strong></span>(<span class="methodparam"><span class="type"><span class="type"><a href="class.opensslcertificatesigningrequest.html" class="type OpenSSLCertificateSigningRequest">OpenSSLCertificateSigningRequest</a></span>|<span class="type"><a href="language.types.string.html" class="type string">string</a></span></span> <code class="parameter">$csr</code></span>, <span class="methodparam"><span class="type"><a href="language.types.string.html" class="type string">string</a></span> <code class="parameter reference">&$output</code></span>, <span class="methodparam"><span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span> <code class="parameter">$no_text</code><span class="initializer"> = <strong><code><a href="reserved.constants.html#constant.true">true</a></code></strong></span></span>): <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>openssl_csr_export()</strong></span> 获取证书签名请求（<code class="parameter">csr</code>）并通过引用保存其 <abbr title="Privacy-Enhanced Mail">PEM</abbr> 格式的字符串（<code class="parameter">output</code>）。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-csr-export-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
     
 <dt><code class="parameter">csr</code></dt>
 <dd>
  <p class="para">
   See <a href="openssl.certparams.html" class="link">CSR parameters</a> for a list of valid values.
  </p>
 </dd>

    
     <dt><code class="parameter">output</code></dt>
     <dd>
      <p class="para">
      在成功时，该字符串将包含 <abbr title="Privacy-Enhanced Mail">PEM</abbr> 编码的 <abbr title="Certificate Signing Request">CSR</abbr>。
      </p>
     </dd>
    
    
     <dt><code class="parameter">no_text</code></dt>
     <dd>
      <p class="para">
可选参数 <code class="parameter">notext</code> 影响输出的冗余度。如果设为
<strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong>，输出内容将包含附加的人类可读信息。<code class="parameter">notext</code> 的缺省值为 <strong><code><a href="reserved.constants.html#constant.true">true</a></code></strong>。
</p>
     </dd>
    
   </dl>
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-csr-export-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code><a href="reserved.constants.html#constant.true">true</a></code></strong>， 或者在失败时返回 <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.openssl-csr-export-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">csr</code> 现在接受 <span class="classname"><a href="class.opensslcertificatesigningrequest.html" class="classname">OpenSSLCertificateSigningRequest</a></span>
       实例；之前接受类型 <code class="literal">OpenSSL X.509 CSR</code> 的 <a href="language.types.resource.html" class="link">resource</a>。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.openssl-csr-export-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-917">
    <p><strong>Example #1 openssl_csr_export() 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$subject </span><span style="color: #007700">= array(<br />    </span><span style="color: #DD0000">"commonName" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,<br />);<br /></span><span style="color: #0000BB">$private_key </span><span style="color: #007700">= </span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">(array(<br />    </span><span style="color: #DD0000">"private_key_bits" </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">2048</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">"private_key_type" </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">OPENSSL_KEYTYPE_RSA</span><span style="color: #007700">,<br />));<br /></span><span style="color: #0000BB">$configargs </span><span style="color: #007700">= array(<br />    </span><span style="color: #DD0000">'digest_alg' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'sha256WithRSAEncryption'<br /></span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$csr </span><span style="color: #007700">= </span><span style="color: #0000BB">openssl_csr_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$subject</span><span style="color: #007700">, </span><span style="color: #0000BB">$private_key</span><span style="color: #007700">, </span><span style="color: #0000BB">$configargs</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">openssl_csr_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$csr</span><span style="color: #007700">, </span><span style="color: #0000BB">$csr_string</span><span style="color: #007700">);<br />echo </span><span style="color: #0000BB">$csr_string</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.openssl-csr-export-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.openssl-csr-export-to-file.html" class="function" rel="rdfs-seeAlso">openssl_csr_export_to_file()</a> - 将 CSR 导出到文件</span></li>
    <li><span class="function"><a href="function.openssl-csr-new.html" class="function" rel="rdfs-seeAlso">openssl_csr_new()</a> - 生成一个 CSR</span></li>
    <li><span class="function"><a href="function.openssl-csr-sign.html" class="function" rel="rdfs-seeAlso">openssl_csr_sign()</a> - 用另一个证书签署 CSR（或者本身）并且生成一个证书</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="22696""></a>
  <div class="note">
   <strong class="user">carlos AT wfmh DOT org DOT pl</strong>
   <a href="#22696" class="date">26-Jun-2002 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here you come with the example of how to use this function. <br />
<br />
if( $csr = openssl_csr_new( array( <br />
&nbsp;&nbsp; &nbsp; "countryName"=&gt;"PL",<br />
&nbsp;&nbsp; &nbsp; "stateOrProvinceName" =&gt; "blah",<br />
&nbsp;&nbsp; &nbsp; "organizationName" =&gt; "company ltd",<br />
&nbsp;&nbsp; &nbsp; "commonName"=&gt;"foo.bar.com",<br />
&nbsp;&nbsp; &nbsp; "Email"=&gt;"blah@foo.bar.com"), $privkey )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; openssl_csr_export_to_file( $csr, "out.csr");<br />
&nbsp;&nbsp; }<br />
else<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; printf("failed\n");<br />
&nbsp;&nbsp; }<br />
<br />
Keep in mind that keys are case sensitive (i.e. give "email" instead of "Email" and you get warning). Also remember it's important to keep the order of the arguments in array. Move the "Email" above commonName and check what you get (in case you don't know how: "openssl req -noout -text -in out.csr"). <br />
<br />
It also happened to me me I got segfault when order was rubbish (afair Email after countryName, or plenty Email's here and there), so be awared.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
