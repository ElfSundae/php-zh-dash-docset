<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>返回用于临时文件的目录</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.set-time-limit.html">? set_time_limit</a></li>
      <li style="float: right;"><a href="function.version-compare.html">version_compare ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.info.html">PHP 选项/信息 函数</a></li>
    <li>返回用于临时文件的目录</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.sys-get-temp-dir" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">sys_get_temp_dir</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.2.1, PHP 7)</p><p class="refpurpose"><span class="refname">sys_get_temp_dir</span> &mdash; <span class="dc-title">返回用于临时文件的目录</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.sys-get-temp-dir-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>sys_get_temp_dir</strong></span>
    ( <span class="methodparam">void</span>
   ) : <span class="type">string</span></div>

  <p class="para rdfs-comment">
   返回 PHP 储存临时文件的默认目录的路径。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.sys-get-temp-dir-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回临时目录的路径。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.sys-get-temp-dir-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-544">
    <p><strong>Example #1 <span class="function"><strong>sys_get_temp_dir()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;使用&nbsp;sys_get_temp_dir()&nbsp;在目录里创建临时文件<br /></span><span style="color: #0000BB">$temp_file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">tempnam</span><span style="color: #007700">(</span><span style="color: #0000BB">sys_get_temp_dir</span><span style="color: #007700">(),&nbsp;</span><span style="color: #DD0000">'Tux'</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$temp_file</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
C:\Windows\Temp\TuxA318.tmp
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.sys-get-temp-dir-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.tmpfile.html" class="function" rel="rdfs-seeAlso">tmpfile()</a> - 建立一个临时文件</span></li>
    <li class="member"><span class="function"><a href="function.tempnam.html" class="function" rel="rdfs-seeAlso">tempnam()</a> - 建立一个具有唯一文件名的文件</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124779""></a>
  <div class="note">
   <strong class="user">Arthur Clifford</strong>
   <a href="#124779" class="date">02-Mar-2020 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
That is important for the purposes of building paths through concatenation to know that sys_get_temp_dir does not include a path separator at the end.<br />
<br />
So, sys_get_temp_dir() will return whatever your temp dir is set to, by default:<br />
<br />
/tmp<br />
<br />
If you attempted to concatenate another dir name&nbsp; temp and use the following:<br />
<br />
mkdir(sys_get_temp_dir() . 'some_dir');<br />
<br />
That would actually attempt to generate:<br />
/tmpsome_dir<br />
<br />
It would likely result in a permission error unless you are running a php script as a super user.<br />
<br />
Instead you would want to do:<br />
mkdir( sys_get_temp_dir() . DIRECTORY_SEPARATOR. 'some_dir' );<br />
<br />
which would create:<br />
/tmp/some_dir<br />
<br />
I don't know if Windows or other platforms include a directory separator at the end. So if you are writing something a bit more general you may want to check for the path separator at the end and if it is not there append it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124140""></a>
  <div class="note">
   <strong class="user">besabellacyrus at gmail dot com</strong>
   <a href="#124140" class="date">26-Aug-2019 01:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
using in windows this trim spaces and add ~1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121073""></a>
  <div class="note">
   <strong class="user">OsakaWebbie</strong>
   <a href="#121073" class="date">11-May-2017 03:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If running on a Linux system where systemd has PrivateTmp=true (which is the default on CentOS 7 and perhaps other newer distros), this function will simply return "/tmp", not the true, much longer, somewhat dynamic path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119617""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#119617" class="date">18-Jul-2016 05:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when the sys_temp_dir directive is left unset, sys_get_temp_dir() returns C:\Windows on my Windows.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118001""></a>
  <div class="note">
   <strong class="user">Nimja</strong>
   <a href="#118001" class="date">17-Sep-2015 11:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A very helpful thing to note when on Linux:<br />
<br />
If you are running PHP from the commandline you can use the environment variable: TMPDIR - to change the location without touching php.ini. - This should work on most versions of PHP.<br />
<br />
Example file: test.php<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">sys_get_temp_dir</span><span class="keyword">() . </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
And then running:<br />
<br />
php test.php<br />
&nbsp;&nbsp; &nbsp; /tmp<br />
&nbsp;&nbsp;&nbsp; <br />
TMPDIR=/custom/location php test.php<br />
&nbsp;&nbsp;&nbsp; /custom/location</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117168""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#117168" class="date">24-Apr-2015 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
it should be mentioned that the return value of sys_get_temp_dir() can be set using the ini-directive 'sys_temp_dir' globally as well as per directory by using<br />
php_admin_value sys_temp_dir /path/to/tmp</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115199""></a>
  <div class="note">
   <strong class="user">royanee at yahoo dot com</strong>
   <a href="#115199" class="date">11-Jun-2014 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.5.0, you can set the sys_temp_dir INI setting so that this function will return a useful value when the default temporary directory is not an option.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114268""></a>
  <div class="note">
   <strong class="user">Ismail Asci</strong>
   <a href="#114268" class="date">31-Jan-2014 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's not documented but this function does not&nbsp; send the path with trailing spaces, actually it drops the slash if it exists.<br />
<br />
https://github.com/php/php-src/blob/af6c11c5f060870d052a2b765dc634d9e47d0f18/main/php_open_temporary_file.c#L238</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97044""></a>
  <div class="note">
   <strong class="user">bert-jan at bugbyte dot nl</strong>
   <a href="#97044" class="date">29-Mar-2010 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function does not account for virtualhost-specific modifications to the temp path and/or open_basedir:<br />
<br />
&lt;Virtualhost&gt;<br />
php_admin_value open_basedir /home/user<br />
php_admin_value upload_tmp_dir /home/user/tmp<br />
php_admin_value session.save_path /home/user/tmp<br />
&lt;/Virtualhost&gt;<br />
<br />
Within this config it still returns /tmp</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93390""></a>
  <div class="note">
   <strong class="user">dannel at aaronexodus dot com</strong>
   <a href="#93390" class="date">07-Sep-2009 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's no need to use a random name for the directory for tempnam.
<br />

<br />
Since a file and a directory can't share the same name on the filesystem, we can exploit this and simply use the name of the current file. It is guaranteed that the directory won't exist (because it's a file, of course).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">if ( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'sys_get_temp_dir'</span><span class="keyword">)) {
<br />
&nbsp; function </span><span class="default">sys_get_temp_dir</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TMP'</span><span class="keyword">])) { return </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TMP'</span><span class="keyword">]); }
<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TMPDIR'</span><span class="keyword">])) { return </span><span class="default">realpath</span><span class="keyword">( </span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TMPDIR'</span><span class="keyword">]); }
<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TEMP'</span><span class="keyword">])) { return </span><span class="default">realpath</span><span class="keyword">( </span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">'TEMP'</span><span class="keyword">]); }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tempfile</span><span class="keyword">=</span><span class="default">tempnam</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$tempfile</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$tempfile</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$tempfile</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">null</span><span class="keyword">;
<br />
&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80690""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#80690" class="date">29-Jan-2008 04:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function does not always add trailing slash. This behaviour is inconsistent across systems, so you have keep an eye on it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
